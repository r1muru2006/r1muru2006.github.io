<!doctype html>
<html
  lang="en-us" 
  data-theme-mode="auto"
  >
  <head><meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no"
/><title>
  HOLACTF 2025 | D-Sketon
</title>
<meta name="description" content="Sau ƒë√¢y l√† nh·ªØng b√†i m√¨nh l√†m ƒë∆∞·ª£c trong th·ªùi gian c·ªßa gi·∫£i v·ªõi t·ªïng l√† 6 b√†i v·ªõi 3 b√†i crypto, 2 b√†i misc v√† 1 b√†i osint."/><script>
  window.siteConfig = JSON.parse("{\"anchor_icon\":null,\"base\":\"https://r1muru2006.github.io/\",\"clipboard\":{\"copyright\":{\"count\":50,\"enable\":false,\"license_type\":\"by-nc-sa\"},\"fail\":{\"en\":\"Copy failed (Ôæü‚äøÔæü)ÔæÇ\",\"ja\":\"„Ç≥„Éî„ÉºÂ§±Êïó (Ôæü‚äøÔæü)ÔæÇ\",\"pt-br\":\"Falha ao copiar (Ôæü‚äøÔæü)ÔæÇ\",\"zh-cn\":\"Â§çÂà∂Â§±Ë¥• (Ôæü‚äøÔæü)ÔæÇ\",\"zh-tw\":\"Ë§áË£ΩÂ§±Êïó (Ôæü‚äøÔæü)ÔæÇ\"},\"success\":{\"en\":\"Copy successfully (*^‚ñΩ^*)\",\"ja\":\"„Ç≥„Éî„ÉºÊàêÂäü (*^‚ñΩ^*)\",\"pt-br\":\"Copiado com sucesso (*^‚ñΩ^*)\",\"zh-cn\":\"Â§çÂà∂ÊàêÂäü (*^‚ñΩ^*)\",\"zh-tw\":\"Ë§áË£ΩÊàêÂäü (*^‚ñΩ^*)\"}},\"code_block\":{\"expand\":true},\"icon_font\":\"4552607_4k4bc36ef96\",\"outdate\":{\"daysago\":180,\"enable\":false,\"message\":{\"en\":\"This article was last updated on {time}. Please note that the content may no longer be applicable.\",\"ja\":\"„Åì„ÅÆË®ò‰∫ã„ÅØÊúÄÁµÇÊõ¥Êñ∞Êó•Ôºö{time}„ÄÇË®òËºâÂÜÖÂÆπ„ÅåÁèæÂú®ÊúâÂäπ„Åß„Å™„ÅÑÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÅÆ„Åß„ÅîÊ≥®ÊÑè„Åè„Å†„Åï„ÅÑ„ÄÇ\",\"pt-br\":\"Este artigo foi atualizado pela √∫ltima vez em {time}. Observe que o conte√∫do pode n√£o ser mais aplic√°vel.\",\"zh-cn\":\"Êú¨ÊñáÊúÄÂêéÊõ¥Êñ∞‰∫é {time}ÔºåËØ∑Ê≥®ÊÑèÊñá‰∏≠ÂÜÖÂÆπÂèØËÉΩÂ∑≤‰∏çÈÄÇÁî®„ÄÇ\",\"zh-tw\":\"Êú¨ÊñáÊúÄÂæåÊõ¥Êñ∞Êñº {time}ÔºåË´ãÊ≥®ÊÑèÊñá‰∏≠ÂÖßÂÆπÂèØËÉΩÂ∑≤‰∏çÈÅ©Áî®„ÄÇ\"}}}");
  
</script>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  rel="preload"
  as="style"
  href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap"
/>
<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap"
  media="print"
  onload="this.media='all'"
/>
<link
    rel="preload"
    href="//at.alicdn.com/t/c/font_4552607_4k4bc36ef96.woff2"
    as="font"
    type="font/woff2"
    crossorigin="anonymous"
  /><link rel="stylesheet" href="/css/loader.min.ac746e154f756f8220326eeb52a719f142ab038be5a8ddf30ea5ef15ef2356ea.css" />
<meta property="og:type" content="website" />
  <meta property="og:title" content="HOLACTF 2025 | D-Sketon" />
  <meta
    property="og:description"
    content="Sau ƒë√¢y l√† nh·ªØng b√†i m√¨nh l√†m ƒë∆∞·ª£c trong th·ªùi gian c·ªßa gi·∫£i v·ªõi t·ªïng l√† 6 b√†i v·ªõi 3 b√†i crypto, 2 b√†i misc v√† 1 b√†i osint."
  />
  <meta property="og:url" content="https://r1muru2006.github.io/post/holactf2025/" />
  <meta
    property="og:site_name"
    content="My New Hugo Site"
  />
  <meta
    property="og:image"
    content="/images/holactf.jpg"
  />
  <meta property="article:author" content="D-Sketon" />
  <meta property="article:published_time" content="2025-09-09T08:42:30&#43;07:00" />
  <meta property="article:modified_time" content="2025-09-09T08:42:30&#43;07:00" /><meta property="article:tag" content="CTFCryptographyMiscellaneousOsint" /><meta name="twitter:card" content="summary" />
  <meta name="twitter:image" content="/images/holactf.jpg" />
<link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/main.min.3f4fd122cf0f99ff7801eb4c3d87d2c30d757b99c89ded49cd78a6de22bd22ba.css" />
<link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css"
    integrity="sha384-IfxC36XL/toUyJ939C73PcgMuRzAZuIzZxE38drsmO5p6jD7ei&#43;Zx/1oA/0l8ysE" crossorigin="anonymous"onload="this.onload=null;this.rel='stylesheet'"
  /><link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/katex@0.16.24/dist/katex.min.css"
    integrity="sha384-tTgKLjMYmJr94v8qu2PE5MUGSMbyN2xiH266JUB3gpm8vnnJywd1dWSOEfrFz&#43;YI" crossorigin="anonymous"onload="this.onload=null;this.rel='stylesheet'"
  /><script
    src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"
    integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"></script><link
    rel="stylesheet"
    href="https://npm.webcache.cn/@reimujs/aos@0.1.2/dist/aos.css"
    integrity="sha384-GMRP93c6Hkz9JVKGAuRR3nTS7M07RwPgTFenXiosjq2VbVgvdDNcz1g6Mkj8AONa" crossorigin="anonymous"/></head>
  <body><div id='loader'>
    <div class="loading-left-bg loading-bg"></div>
    <div class="loading-right-bg loading-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi rotate"><svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="https://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
            <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="var(--red-1, #ff5252)" />
            <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z 
          M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95z" fill="var(--red-1, #ff5252)" />
          </svg></div><div class="loading-word">Loading...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    var loaderEl = document.getElementById('loader');
    var startLoading = () => {
      time = Date.now();
      loaderEl.classList.remove("loading");
    }
    var hideLoader = () => {
      document.body.style.overflow = 'auto';
      loader.classList.add('loading');
    };

    var endLoading = () => {
      if (!time) {
        hideLoader();
      } else {
        if (Date.now() - time > 500) {
          time = null;
          hideLoader();
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    loaderEl.addEventListener('click', endLoading);
  </script><div id="copy-tooltip"></div>
<div id="lang-tooltip">
This article does not have a corresponding language version
</div>
<div id="heatmap-tooltip"></div><div id="container">
      <div id="wrap"><div id="header-nav">
  <nav id="main-nav" aria-label="Primary navigation"><a class="main-nav-link-wrap" href="/">
        <div class='main-nav-icon icon rotate'>&#xe62b;</div>
        <span class="main-nav-link">Home</span>
      </a><a class="main-nav-link-wrap" href="/archives">
        <div class='main-nav-icon icon rotate'>&#xe62b;</div>
        <span class="main-nav-link">Archives</span>
      </a><a class="main-nav-link-wrap" href="/about">
        <div class='main-nav-icon icon rotate'>&#xe62b;</div>
        <span class="main-nav-link">About</span>
      </a><a class="main-nav-link-wrap" href="/friend">
        <div class='main-nav-icon icon rotate'>&#xe62b;</div>
        <span class="main-nav-link">Friend</span>
      </a><a id="main-nav-toggle" class="nav-icon" aria-label="Toggle navigation" role="button"></a>
  </nav>
  <nav id="sub-nav" aria-label="Secondary navigation"></nav></div>
<header id="header" aria-label="Site header"><picture></picture>
    <img  fetchpriority="high" src="/images/holactf.jpg" alt="HOLACTF 2025"><div id="header-outer">
    <div id="header-title"><span id="logo">
            <h1 data-aos="slide-up">HOLACTF 2025</h1>
          </span><h2 id="subtitle-wrap" data-aos="slide-down"></h2></div>
  </div>
</header><div id="content"
          aria-label="Page content"
          
          class="sidebar-right"  ><aside id="sidebar" aria-label="Sidebar"><div class="sidebar-wrapper-container sticky"><div class="sidebar-wrapper">
    <div
      class="sidebar-wrap"
      data-aos="fade-up"
    ><div class="sidebar-toc-sidebar"><h3 class="toc-title">Contents</h3>
<div class="sidebar-toc-wrapper toc-div-class">
  <nav id="TableOfContents">
  <ul>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#1-cs2rtrash">1. Cs2RTrash</a></li>
        <li><a href="#2-enigmahardcode">2. EnigmaHardCode</a></li>
        <li><a href="#3-imlosingyou">3. ImLosingYou</a></li>
      </ul>
    </li>
    <li><a href="#misc">Misc</a>
      <ul>
        <li><a href="#1-lunadb">1. LunaDB</a></li>
        <li><a href="#2-weird-png">2. Weird PNG</a></li>
      </ul>
    </li>
    <li><a href="#osint">Osint</a>
      <ul>
        <li><a href="#1-ehc-is-my-family">1. EHC is my family</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div></div>
          <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img
    data-src="/avatar/avatar.webp"
    data-sizes="auto"
    alt="D-Sketon"
    class="lazyload"
  />
  <div class="sidebar-author-name">D-Sketon</div>
  <div class="sidebar-description">Â∞ëÂ•≥Á•àÁ•∑‰∏≠...</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div><div class="sidebar-state-number">9</div>
  </div>
  <a class="sidebar-state-category" href="/categories/" aria-label="sidebar-state-category-link">
    <div>Categories</div>
    <div class="sidebar-state-number">
      3
    </div>
  </a>
  <a class="sidebar-state-tag" href="/tags/" aria-label="sidebar-state-tag-link">
    <div>Tags</div>
    <div class="sidebar-state-number">7</div>
  </a>
</div>
<div class="sidebar-social"></div>
<div class="sidebar-menu"><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Home</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Archives</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">About</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/friend"
        aria-label="Friend"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Friend</div>
    </div></div>
</div><div class="sidebar-btn-wrapper" style="position:static">
            <div class="sidebar-toc-btn current"></div>
            <div class="sidebar-common-btn"></div>
          </div></div>
  </div><div class="sidebar-widget"></div></div></aside>
<section id="main" aria-label="Main content"><article
  class="h-entry article"
  itemscope
  itemtype="https://schema.org/BlogPosting"
>
  <div
    class="article-inner"
    data-aos="fade-up"
  >
    <div class="article-meta"><div class="article-date">
  <span
    class="article-date-link icon-calendar"
    data-aos="zoom-in"
  >
    <time datetime="2025-09-09 08:42:30 &#43;0700 &#43;07" itemprop="datePublished"
      >2025-09-09</time
    >
    <time style="display: none;" id="post-update-time"
      >2025-09-09</time
    >
  </span></div>
<div class="article-category"><a
      class="article-category-link"
      href="/categories/ctf-write-up"
      data-aos="zoom-in"
      >CTF WRITE-UP</a
    ></div>
</div><div class="hr-line"></div><div class="e-content article-entry" itemprop="articleBody"><h2 id="crypto">
<a class="header-anchor" href="#crypto"></a>
Crypto
</h2><h3 id="1-cs2rtrash">
<a class="header-anchor" href="#1-cs2rtrash"></a>
1. Cs2RTrash
</h3><p><img src="https://hackmd.io/_uploads/B16EYV-qgl.png" alt="image"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># chall.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> bytes_to_long, long_to_bytes
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>n1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">106274132069853085771962684070654057294853035674691451636354054913790308627721</span>
</span></span><span style="display:flex;"><span>n2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">73202720518342632558813895439681594395095017145510800999002057461861058762579</span>
</span></span><span style="display:flex;"><span>n3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">58129476807669651703262865829974447479957080526429581698674448004236654958847</span>
</span></span><span style="display:flex;"><span>message <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;HOLACTF{...}&#39;</span>
</span></span><span style="display:flex;"><span>m <span style="color:#f92672">=</span> bytes_to_long(message)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c1 <span style="color:#f92672">=</span> pow(m, e, n1)
</span></span><span style="display:flex;"><span>c2 <span style="color:#f92672">=</span> pow(m, e, n2)
</span></span><span style="display:flex;"><span>c3 <span style="color:#f92672">=</span> pow(m, e, n3)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;c1: </span><span style="color:#e6db74">{</span>c1<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;c2: </span><span style="color:#e6db74">{</span>c2<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;c3: </span><span style="color:#e6db74">{</span>c3<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// output.txt</span>
</span></span><span style="display:flex;"><span>c1: 40409669713698525444927116587938485167766997176959778633087672968720888190012
</span></span><span style="display:flex;"><span>c2: 50418608792183022472533104230595523000246213655735834753443442906871618770832
</span></span><span style="display:flex;"><span>c3: 7151799367443802424297049002310776844321501905398348074481144597918413565153
</span></span></code></pre></div><p>ƒê√¢y ch·ªâ l√† 1 b√†i RSA ƒë∆°n gi·∫£n v√† m√¨nh ƒë·ªÉ √Ω r·∫±ng n1 l√† s·ªë nguy√™n t·ªë n√™n b√†i n√†y c√≥ th·ªÉ ƒë∆∞·ª£c gi·∫£i nh∆∞ sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># solution.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> inverse, long_to_bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">106274132069853085771962684070654057294853035674691451636354054913790308627721</span>
</span></span><span style="display:flex;"><span>n2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">73202720518342632558813895439681594395095017145510800999002057461861058762579</span>
</span></span><span style="display:flex;"><span>n3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">58129476807669651703262865829974447479957080526429581698674448004236654958847</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">40409669713698525444927116587938485167766997176959778633087672968720888190012</span>
</span></span><span style="display:flex;"><span>c2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">50418608792183022472533104230595523000246213655735834753443442906871618770832</span>
</span></span><span style="display:flex;"><span>c3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">7151799367443802424297049002310776844321501905398348074481144597918413565153</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d1 <span style="color:#f92672">=</span> inverse(e, n1 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> pow(c1, d1, n1)
</span></span><span style="display:flex;"><span>print(long_to_bytes(x))
</span></span></code></pre></div><pre><code>Flag: HOLACTF{ju5t_a_b4s1c_CRT}
</code></pre>
<h3 id="2-enigmahardcode">
<a class="header-anchor" href="#2-enigmahardcode"></a>
2. EnigmaHardCode
</h3><p><img src="https://hackmd.io/_uploads/rJ_aqNWcee.png" alt="image">
<img src="https://hackmd.io/_uploads/SkGCc4-cge.png" alt="image">
<img src="https://hackmd.io/_uploads/r1OJoEW9lx.png" alt="image"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// attachment</span>
</span></span><span style="display:flex;"><span>SWWSAOL{CRK_NTX_AGBXRRLNYQC_ANGQBQHR_TY_QNZ_PPLNFBFXX}
</span></span></code></pre></div><p>Ban ƒë·∫ßu m√¨nh kh√¥ng bi·∫øt cu·ªôn tr√≤n xu·ªëng l√† c√≥ reflector v·ªõi plugboard n√™n ƒë√£ b·ªè qua :333
Khi ph√°t hi·ªán ra th√¨ m√¨nh li√™n k·∫øt l·∫°i c√°c d·ªØ li·ªáu ƒë√£ c√≥ v√† t√¨m ƒë∆∞·ª£c trang <a href="https://en.wikipedia.org/wiki/Enigma_rotor_details">wiki</a> c√≥ ƒë·ªÉ thi·∫øt l·∫≠p enigma machine
<img src="https://hackmd.io/_uploads/ry14aV-cee.png" alt="Screenshot 2025-08-31 101011"></p>
<p>V√¨ ƒë√£ bi·∫øt rotor order, reflector, ring settings v√† ch·ªâ c√≤n thi·∫øu 1 c·∫∑p plugboard n√™n m√¨nh ƒë√£ brute-force c√°c c·∫∑p c√≤n l·∫°i ƒë·∫øn khi t√¨m ra flag format ph√π h·ª£p nh∆∞ sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># solution.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> string<span style="color:#f92672">,</span> re<span style="color:#f92672">,</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> itertools <span style="color:#f92672">import</span> combinations
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> multiprocessing <span style="color:#f92672">import</span> Pool, cpu_count
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ALPHA <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_uppercase
</span></span><span style="display:flex;"><span>pattern <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;HOLACTF\{.*\}&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Machine parameters (use your exact ones)</span>
</span></span><span style="display:flex;"><span>ROTOR <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;I&#34;</span>: (<span style="color:#e6db74">&#34;EKMFLGDQVZNTOWYHXUSPAIBRCJ&#34;</span>, <span style="color:#e6db74">&#34;Q&#34;</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;II&#34;</span>: (<span style="color:#e6db74">&#34;AJDKSIRUXBLHWTMCQGZNPYFVOE&#34;</span>, <span style="color:#e6db74">&#34;E&#34;</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;III&#34;</span>: (<span style="color:#e6db74">&#34;BDFHJLCPRTXVZNYEIWGAKMUSQO&#34;</span>, <span style="color:#e6db74">&#34;V&#34;</span>),
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>REFLECTOR_C <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;FVPJIAOYEDRZXWGCTKUQSBNMHL&#34;</span>
</span></span><span style="display:flex;"><span>ORDER <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#34;II&#34;</span>, <span style="color:#e6db74">&#34;III&#34;</span>, <span style="color:#e6db74">&#34;I&#34;</span>)
</span></span><span style="display:flex;"><span>RING <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;II&#34;</span>: <span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#34;III&#34;</span>: <span style="color:#ae81ff">7</span>, <span style="color:#e6db74">&#34;I&#34;</span>: <span style="color:#ae81ff">2</span>}  <span style="color:#75715e"># use exactly what you intend</span>
</span></span><span style="display:flex;"><span>PLUG_KNOWN <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;AO&#34;</span>, <span style="color:#e6db74">&#34;DP&#34;</span>, <span style="color:#e6db74">&#34;ER&#34;</span>, <span style="color:#e6db74">&#34;FT&#34;</span>, <span style="color:#e6db74">&#34;IU&#34;</span>, <span style="color:#e6db74">&#34;JW&#34;</span>, <span style="color:#e6db74">&#34;KZ&#34;</span>, <span style="color:#e6db74">&#34;MX&#34;</span>]
</span></span><span style="display:flex;"><span>MISSING_POOL <span style="color:#f92672">=</span> list(<span style="color:#e6db74">&#34;BCGHLNQSVY&#34;</span>)
</span></span><span style="display:flex;"><span>CIPH <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SWWSAOL</span><span style="color:#e6db74">{CRK_NTX_AGBXRRLNYQC_ANGQBQHR_TY_QNZ_PPLNFBFXX}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Precompute rotor inverse maps</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">inv_map</span>(w):
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;?&#34;</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i, c <span style="color:#f92672">in</span> enumerate(w):
</span></span><span style="display:flex;"><span>        r[ord(c) <span style="color:#f92672">-</span> <span style="color:#ae81ff">65</span>] <span style="color:#f92672">=</span> ALPHA[i]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(r)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>L, M, R <span style="color:#f92672">=</span> ORDER
</span></span><span style="display:flex;"><span>LW, Lnot <span style="color:#f92672">=</span> ROTOR[L]
</span></span><span style="display:flex;"><span>MW, Mnot <span style="color:#f92672">=</span> ROTOR[M]
</span></span><span style="display:flex;"><span>RW, Rnot <span style="color:#f92672">=</span> ROTOR[R]
</span></span><span style="display:flex;"><span>LI <span style="color:#f92672">=</span> inv_map(LW)
</span></span><span style="display:flex;"><span>MI <span style="color:#f92672">=</span> inv_map(MW)
</span></span><span style="display:flex;"><span>RI <span style="color:#f92672">=</span> inv_map(RW)
</span></span><span style="display:flex;"><span>rL, rM, rR <span style="color:#f92672">=</span> RING[L] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, RING[M] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, RING[R] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># fast decrypt function for one pos/pair</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt_with</span>(pos, extra_pair):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Build plug mapping as a list for fast int ops</span>
</span></span><span style="display:flex;"><span>    pmap <span style="color:#f92672">=</span> list(range(<span style="color:#ae81ff">26</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> pair <span style="color:#f92672">in</span> PLUG_KNOWN <span style="color:#f92672">+</span> ([extra_pair] <span style="color:#66d9ef">if</span> extra_pair <span style="color:#66d9ef">else</span> []):
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> pair[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> pair[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        ai <span style="color:#f92672">=</span> ord(a) <span style="color:#f92672">-</span> <span style="color:#ae81ff">65</span>
</span></span><span style="display:flex;"><span>        bi <span style="color:#f92672">=</span> ord(b) <span style="color:#f92672">-</span> <span style="color:#ae81ff">65</span>
</span></span><span style="display:flex;"><span>        pmap[ai] <span style="color:#f92672">=</span> bi
</span></span><span style="display:flex;"><span>        pmap[bi] <span style="color:#f92672">=</span> ai
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pL, pM, pR <span style="color:#f92672">=</span> [ord(c) <span style="color:#f92672">-</span> <span style="color:#ae81ff">65</span> <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> pos]
</span></span><span style="display:flex;"><span>    out_chars <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> ch <span style="color:#f92672">in</span> CIPH:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ch <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> ALPHA:
</span></span><span style="display:flex;"><span>            out_chars<span style="color:#f92672">.</span>append(ch)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># stepping (double-step behavior)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ALPHA[pM] <span style="color:#f92672">==</span> Mnot:
</span></span><span style="display:flex;"><span>            pM <span style="color:#f92672">=</span> (pM <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>            pL <span style="color:#f92672">=</span> (pL <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ALPHA[pR] <span style="color:#f92672">==</span> Rnot:
</span></span><span style="display:flex;"><span>            pM <span style="color:#f92672">=</span> (pM <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>        pR <span style="color:#f92672">=</span> (pR <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># plugboard in</span>
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> pmap[ord(ch) <span style="color:#f92672">-</span> <span style="color:#ae81ff">65</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># forward through right, mid, left (account ringoffsets)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward</span>(w, x, p, r):
</span></span><span style="display:flex;"><span>            idx <span style="color:#f92672">=</span> (x <span style="color:#f92672">+</span> p <span style="color:#f92672">-</span> r) <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> (ord(w[idx]) <span style="color:#f92672">-</span> <span style="color:#ae81ff">65</span> <span style="color:#f92672">-</span> p <span style="color:#f92672">+</span> r) <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> forward(RW, x, pR, rR)
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> forward(MW, x, pM, rM)
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> forward(LW, x, pL, rL)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># reflector</span>
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> ord(REFLECTOR_C[x]) <span style="color:#f92672">-</span> <span style="color:#ae81ff">65</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># back through left,middle,right (inverse maps)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">back</span>(iw, x, p, r):
</span></span><span style="display:flex;"><span>            idx <span style="color:#f92672">=</span> (x <span style="color:#f92672">+</span> p <span style="color:#f92672">-</span> r) <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> (ord(iw[idx]) <span style="color:#f92672">-</span> <span style="color:#ae81ff">65</span> <span style="color:#f92672">-</span> p <span style="color:#f92672">+</span> r) <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> back(LI, x, pL, rL)
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> back(MI, x, pM, rM)
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> back(RI, x, pR, rR)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># plugboard out</span>
</span></span><span style="display:flex;"><span>        out_chars<span style="color:#f92672">.</span>append(chr(pmap[x] <span style="color:#f92672">+</span> <span style="color:#ae81ff">65</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(out_chars)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Worker: given a pair (like &#34;BC&#34;), test all positions and return any matches</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">worker_for_pair</span>(pair):
</span></span><span style="display:flex;"><span>    found <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    pair <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(pair)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> ALPHA:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> b <span style="color:#f92672">in</span> ALPHA:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> ALPHA:
</span></span><span style="display:flex;"><span>                pos <span style="color:#f92672">=</span> a <span style="color:#f92672">+</span> b <span style="color:#f92672">+</span> c
</span></span><span style="display:flex;"><span>                pt <span style="color:#f92672">=</span> decrypt_with(pos, pair)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> pattern<span style="color:#f92672">.</span>search(pt):
</span></span><span style="display:flex;"><span>                    found<span style="color:#f92672">.</span>append((pair, pos, pt))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> found
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    pairs <span style="color:#f92672">=</span> list(combinations(MISSING_POOL, <span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Total pairs:&#34;</span>, len(pairs))
</span></span><span style="display:flex;"><span>    nproc <span style="color:#f92672">=</span> max(<span style="color:#ae81ff">1</span>, cpu_count() <span style="color:#f92672">-</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Using processes:&#34;</span>, nproc)
</span></span><span style="display:flex;"><span>    start <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> Pool(nproc) <span style="color:#66d9ef">as</span> pool:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># map worker across pairs; each worker tests all 26^3 positions for that pair</span>
</span></span><span style="display:flex;"><span>        results <span style="color:#f92672">=</span> pool<span style="color:#f92672">.</span>map(worker_for_pair, pairs)
</span></span><span style="display:flex;"><span>    elapsed <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time() <span style="color:#f92672">-</span> start
</span></span><span style="display:flex;"><span>    matches <span style="color:#f92672">=</span> [m <span style="color:#66d9ef">for</span> sub <span style="color:#f92672">in</span> results <span style="color:#66d9ef">for</span> m <span style="color:#f92672">in</span> sub]
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Elapsed:&#34;</span>, elapsed, <span style="color:#e6db74">&#34;seconds&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Matches found:&#34;</span>, len(matches))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> pair, pos, pt <span style="color:#f92672">in</span> matches:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;pair&#34;</span>, pair, <span style="color:#e6db74">&#34;pos&#34;</span>, pos, <span style="color:#e6db74">&#34;-&gt;&#34;</span>, pt)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div><p>K·∫øt qu·∫£ tr·∫£ v·ªÅ:</p>
<pre tabindex="0"><code>Total pairs: 45
Using processes: 12
Elapsed: 7.59969425201416 seconds
Matches found: 1
pair CV pos ULW -&gt; HOLACTF{WAR_DIE_GEHEIMHISSE_WIRKLICH_SO_GUT_VERSTECKP}
</code></pre><p>Tuy nhi√™n, flag n√†y v·∫´n ch∆∞a ch√≠nh x√°c n√™n m√¨nh ƒë√£ h·ªèi chatGPT th·ª≠ th√¨ nh·∫≠n ƒë∆∞·ª£c prompt:</p>
<pre tabindex="0"><code>...
Check adjacent starting positions:
Often the crib falls into place if the initial rotor position is shifted by 1‚Äì2 steps. Try decrypting again with positions just before and after ULW (e.g., ULV, ULX, UKW, etc.).

Double-check ring settings vs. rotor positions:
Sometimes code mixes up Ringstellung (internal offset) with Grundstellung (daily key start). If those were off, letters will be slightly wrong throughout.

Test all 45 possible plugboard completions again but only around ULW neighborhood (like ¬±5 positions). That should be much faster.

Language filter: Since the plaintext is clearly German, you can filter candidates through a simple dictionary check (look for &#34;GEHEIMNISSE&#34; and &#34;VERSTECKT&#34;).

üëâ I think the true flag should be:
HOLACTF{WAR_DIE_GEHEIMNISSE_WIRKLICH_SO_GUT_VERSTECKT}
</code></pre><p>Submit th·ª≠ th√¨ nh·∫≠n ƒë∆∞·ª£c k·∫øt qu·∫£ tr·∫£ v·ªÅ ƒë√∫ng.</p>
<pre><code>Flag: HOLACTF{WAR_DIE_GEHEIMNISSE_WIRKLICH_SO_GUT_VERSTECKT}
</code></pre>
<h3 id="3-imlosingyou">
<a class="header-anchor" href="#3-imlosingyou"></a>
3. ImLosingYou
</h3><p><img src="https://hackmd.io/_uploads/HydG1B-5gl.png" alt="image"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># encrypt.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> random <span style="color:#f92672">import</span> getrandbits, FLAG
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">256</span>) <span style="color:#f92672">*</span> getPrime(<span style="color:#ae81ff">256</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>m <span style="color:#f92672">=</span> bytes_to_long(FLAG)
</span></span><span style="display:flex;"><span>mod_m <span style="color:#f92672">=</span> m <span style="color:#f92672">-</span> getrandbits(<span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> pow(m, <span style="color:#ae81ff">2</span>, n)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;n = </span><span style="color:#e6db74">{</span>n<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;c = </span><span style="color:#e6db74">{</span>c<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;mod_m = </span><span style="color:#e6db74">{</span>mod_m<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>n <span style="color:#f92672">=</span> 5655306554322573090396099186606396534230961323765470852969315242956396512318053585607579359989407371627321079880719083136343885009234351073645372666488587
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> 249064480176144876250402041707185886135379496538171928784862949393878232927200977890895568473400681389529997203697206006850790029940405682934025
</span></span><span style="display:flex;"><span>mod_m <span style="color:#f92672">=</span> 499063603337435213780295973826237775412685978121823376141602090122856806
</span></span></code></pre></div><p>M√¨nh gi·∫£ s·ª≠ <code>FLAG</code> c√≥ ƒë·ªô d√†i ng·∫Øn v√† th·ª≠ l·∫•y cƒÉn c·ªßa <code>c</code> th√¨ ƒë√∫ng l√† nh∆∞ v·∫≠y:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># solution.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> long_to_bytes
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> gmpy2 <span style="color:#f92672">import</span> iroot
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">5655306554322573090396099186606396534230961323765470852969315242956396512318053585607579359989407371627321079880719083136343885009234351073645372666488587</span>
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> <span style="color:#ae81ff">249064480176144876250402041707185886135379496538171928784862949393878232927200977890895568473400681389529997203697206006850790029940405682934025</span>
</span></span><span style="display:flex;"><span>mod_m <span style="color:#f92672">=</span> <span style="color:#ae81ff">499063603337435213780295973826237775412685978121823376141602090122856806</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pt <span style="color:#f92672">=</span> iroot(c, <span style="color:#ae81ff">2</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>print(long_to_bytes(pt))
</span></span></code></pre></div><pre><code>Flag: HOLACTF{f33ls_l1k3_l0s1ng_h3r}
</code></pre>
<h2 id="misc">
<a class="header-anchor" href="#misc"></a>
Misc
</h2><h3 id="1-lunadb">
<a class="header-anchor" href="#1-lunadb"></a>
1. LunaDB
</h3><p><img src="https://hackmd.io/_uploads/S1XYxSWclg.png" alt="image"></p>
<pre tabindex="0"><code class="language-rust=" data-lang="rust=">// main.rs
use std::fs::{File, OpenOptions};
use std::io::{self, Read, Write, BufRead, Cursor, Seek, SeekFrom};
use std::path::Path;
use std::env;
use std::process;
use std::time::{SystemTime, UNIX_EPOCH};
use rand::{Rng, thread_rng};
use rand::distributions::Alphanumeric;
use openssl::symm::{Cipher, Crypter, Mode};
use hex_literal::hex;
use byteorder::{LittleEndian, ReadBytesExt, WriteBytesExt};
use leb128;
const H_START: [u8; 4] = hex!(&#34;FF1337FF&#34;);
const H_END:   [u8; 4] = hex!(&#34;FFCAFEFF&#34;);
const D_START:   [u8; 4] = hex!(&#34;FF7270FF&#34;);
const D_END:     [u8; 4] = hex!(&#34;FFEDEDFF&#34;);
const F_START: [u8; 4] = hex!(&#34;FFDEADFF&#34;);
const F_END:   [u8; 4] = hex!(&#34;FFBEEFFF&#34;);
const SIG:    [u8; 4] = hex!(&#34;4C554E41&#34;); 
enum DbMode&lt;&#39;a&gt; {
    Append { existing: &amp;&#39;a [[u8; 8]] },
    Create,
}
fn find_pattern(data: &amp;[u8], pattern: &amp;[u8]) -&gt; Option&lt;usize&gt; {
    data.windows(pattern.len()).position(|w| w == pattern)
}
fn get_input(prompt_text: &amp;str) -&gt; io::Result&lt;String&gt; {
    print!(&#34;{}&#34;, prompt_text);
    io::stdout().flush()?;
    let stdin = io::stdin();
    let mut line = String::new();
    stdin.lock().read_line(&amp;mut line)?;
    Ok(line.trim().to_string())
}

...

fn main() -&gt; io::Result&lt;()&gt; {
    let args: Vec&lt;String&gt; = env::args().collect();
    if args.len() != 2 {
        eprintln!(&#34;Usage: {} &lt;lunadb_file&gt;&#34;, args[0]);
        process::exit(1);
    }
    let db_path = Path::new(&amp;args[1]);
    let num_notes_to_create: usize = loop {
        match get_input(&#34;How many notes do you want to create? &#34;)?.parse() {
            Ok(n) if n &gt; 0 =&gt; break n,
            _ =&gt; println!(&#34;Please enter a valid positive number.&#34;),
        }
    };
    if db_path.exists() {
        
        let mut f = Vec::new();
        File::open(&amp;db_path)?.read_to_end(&amp;mut f)?;
        let keys = {
            let start = find_pattern(&amp;f, &amp;F_START).unwrap() + F_START.len();
            let end   = find_pattern(&amp;f, &amp;F_END).unwrap();
            (&amp;f[start..end]).chunks_exact(8)
                         .map(|c| c.try_into().unwrap())
                          .collect::&lt;Vec&lt;[u8;8]&gt;&gt;()
        };
        let next_id = get_next_id(&amp;f)?;
        let (notes, _, _) = build(DbMode::Append { existing: &amp;keys }, num_notes_to_create, next_id)?;
        write_db(&amp;db_path, None, Some(&amp;f), &amp;notes, &amp;[])?;
        println!(&#34;Appended {} notes&#34;, num_notes_to_create);
    } else {
        let header = Header {
            db_name:  get_input(&#34;Database Name: &#34;)?,
            reg_name: get_input(&#34;Registered Name: &#34;)?,
            license_key: get_input(&#34;License Key: &#34;)?.into_bytes(),
        };
        let (notes, keys, _) = build(DbMode::Create, num_notes_to_create, 1)?;
        write_db(&amp;db_path, Some(header), None, &amp;notes, &amp;keys)?;
        println!(&#34;Created new DB with {} notes&#34;, num_notes_to_create);
    }
    Ok(())
}
</code></pre><p>ƒê·ªÅ cho ta hai t·ªáp <code>main.rs</code> v√† <code>secret.lunadb</code>, v·ªõi y√™u c·∫ßu ƒë·ªçc t·ªáp secret.
T·ª´ <code>main.rs</code> th√¨ m√¨nh bi·∫øt ƒë∆∞·ª£c r·∫±ng:</p>
<ul>
<li>Ghi ch√∫ ƒë∆∞·ª£c m√£ h√≥a b·∫±ng DES-ECB</li>
<li>Key ƒë∆∞·ª£c l∆∞u tr·ªØ trong ph·∫ßn <code>F_START..F_END</code> (kh·ªëi 8-bytes)</li>
<li>M·ªói ghi ch√∫ c√≥ m·ªôt <code>key_index_field</code>.</li>
<li>M·∫£ng string/byte s·ª≠ d·ª•ng t√πy ch·ªânh <code>tag + LEB128 length + data format</code>.</li>
</ul>
<p>Sau ƒë√≥, m√¨nh nh·ªù chatGPT t·∫°o ra 1 c√°i decryptor th·ªèa m√£n v√† d·ª´ng khi th·∫•y flag format:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># solution.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> struct
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> io <span style="color:#f92672">import</span> BytesIO
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Cipher <span style="color:#f92672">import</span> DES
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ---- Constants (magic markers) ----</span>
</span></span><span style="display:flex;"><span>H_START <span style="color:#f92672">=</span> bytes<span style="color:#f92672">.</span>fromhex(<span style="color:#e6db74">&#34;FF1337FF&#34;</span>)
</span></span><span style="display:flex;"><span>H_END   <span style="color:#f92672">=</span> bytes<span style="color:#f92672">.</span>fromhex(<span style="color:#e6db74">&#34;FFCAFEFF&#34;</span>)
</span></span><span style="display:flex;"><span>D_START <span style="color:#f92672">=</span> bytes<span style="color:#f92672">.</span>fromhex(<span style="color:#e6db74">&#34;FF7270FF&#34;</span>)
</span></span><span style="display:flex;"><span>D_END   <span style="color:#f92672">=</span> bytes<span style="color:#f92672">.</span>fromhex(<span style="color:#e6db74">&#34;FFEDEDFF&#34;</span>)
</span></span><span style="display:flex;"><span>F_START <span style="color:#f92672">=</span> bytes<span style="color:#f92672">.</span>fromhex(<span style="color:#e6db74">&#34;FFDEADFF&#34;</span>)
</span></span><span style="display:flex;"><span>F_END   <span style="color:#f92672">=</span> bytes<span style="color:#f92672">.</span>fromhex(<span style="color:#e6db74">&#34;FFBEEFFF&#34;</span>)
</span></span><span style="display:flex;"><span>SIG     <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;LUNA&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ---- Helpers ----</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">find_pattern</span>(data: bytes, pattern: bytes) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Find pattern inside data and return its position.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    pos <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>find(pattern)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> pos <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Pattern </span><span style="color:#e6db74">{</span>pattern<span style="color:#f92672">.</span>hex()<span style="color:#e6db74">}</span><span style="color:#e6db74"> not found&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> pos
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">read_uleb128</span>(f: BytesIO) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Read unsigned LEB128 integer.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    result, shift <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> b:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">EOFError</span>(<span style="color:#e6db74">&#34;Unexpected EOF in LEB128&#34;</span>)
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> b[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">|=</span> (b <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x7F</span>) <span style="color:#f92672">&lt;&lt;</span> shift
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (b <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x80</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        shift <span style="color:#f92672">+=</span> <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">read_string</span>(f: BytesIO) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Read custom encoded string (flag + LEB128 + data).&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    flag <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> flag:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">EOFError</span>(<span style="color:#e6db74">&#34;Unexpected EOF reading string&#34;</span>)
</span></span><span style="display:flex;"><span>    flag <span style="color:#f92672">=</span> flag[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> flag <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x00</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> flag <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x0b</span>:
</span></span><span style="display:flex;"><span>        length <span style="color:#f92672">=</span> read_uleb128(f)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> f<span style="color:#f92672">.</span>read(length)<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#34;utf-8&#34;</span>, errors<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;replace&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> flag <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x0c</span>:
</span></span><span style="display:flex;"><span>        length <span style="color:#f92672">=</span> read_uleb128(f)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> f<span style="color:#f92672">.</span>read(length)<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#34;utf-8&#34;</span>, errors<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;replace&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Invalid string flag </span><span style="color:#e6db74">{</span>flag<span style="color:#e6db74">:</span><span style="color:#e6db74">#x</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">read_bytes</span>(f: BytesIO) <span style="color:#f92672">-&gt;</span> bytes:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Read custom encoded byte string.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    flag <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> flag:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">EOFError</span>(<span style="color:#e6db74">&#34;Unexpected EOF reading bytes&#34;</span>)
</span></span><span style="display:flex;"><span>    flag <span style="color:#f92672">=</span> flag[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> flag <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x00</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> flag <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x0c</span>:
</span></span><span style="display:flex;"><span>        length <span style="color:#f92672">=</span> read_uleb128(f)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> f<span style="color:#f92672">.</span>read(length)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> flag <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x0b</span>:
</span></span><span style="display:flex;"><span>        length <span style="color:#f92672">=</span> read_uleb128(f)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> f<span style="color:#f92672">.</span>read(length)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Invalid byte flag </span><span style="color:#e6db74">{</span>flag<span style="color:#e6db74">:</span><span style="color:#e6db74">#x</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">des_decrypt</span>(key: bytes, data: bytes) <span style="color:#f92672">-&gt;</span> bytes:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Decrypt DES-ECB with padding removal.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    cipher <span style="color:#f92672">=</span> DES<span style="color:#f92672">.</span>new(key, DES<span style="color:#f92672">.</span>MODE_ECB)
</span></span><span style="display:flex;"><span>    pt <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span>decrypt(data)
</span></span><span style="display:flex;"><span>    padlen <span style="color:#f92672">=</span> pt[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;=</span> padlen <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">and</span> pt<span style="color:#f92672">.</span>endswith(bytes([padlen])<span style="color:#f92672">*</span>padlen):
</span></span><span style="display:flex;"><span>        pt <span style="color:#f92672">=</span> pt[:<span style="color:#f92672">-</span>padlen]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> pt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ---- Main LunaDB Parser ----</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse_lunadb</span>(filename: str):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(filename, <span style="color:#e6db74">&#34;rb&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Validate</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> data<span style="color:#f92672">.</span>startswith(SIG):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#34;Not a valid LunaDB file&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Extract sections</span>
</span></span><span style="display:flex;"><span>    d_start <span style="color:#f92672">=</span> find_pattern(data, D_START) <span style="color:#f92672">+</span> len(D_START)
</span></span><span style="display:flex;"><span>    d_end   <span style="color:#f92672">=</span> find_pattern(data, D_END)
</span></span><span style="display:flex;"><span>    f_start <span style="color:#f92672">=</span> find_pattern(data, F_START) <span style="color:#f92672">+</span> len(F_START)
</span></span><span style="display:flex;"><span>    f_end   <span style="color:#f92672">=</span> find_pattern(data, F_END)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    notes_section <span style="color:#f92672">=</span> data[d_start:d_end]
</span></span><span style="display:flex;"><span>    keys_section  <span style="color:#f92672">=</span> data[f_start:f_end]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Parse keys</span>
</span></span><span style="display:flex;"><span>    keys <span style="color:#f92672">=</span> [keys_section[i:i<span style="color:#f92672">+</span><span style="color:#ae81ff">8</span>] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(keys_section), <span style="color:#ae81ff">8</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Parse notes</span>
</span></span><span style="display:flex;"><span>    fnotes <span style="color:#f92672">=</span> BytesIO(notes_section)
</span></span><span style="display:flex;"><span>    notes <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> fnotes<span style="color:#f92672">.</span>tell() <span style="color:#f92672">&lt;</span> len(notes_section):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            note_id <span style="color:#f92672">=</span> struct<span style="color:#f92672">.</span>unpack(<span style="color:#e6db74">&#34;&lt;H&#34;</span>, fnotes<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">2</span>))[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        access_token <span style="color:#f92672">=</span> read_string(fnotes)
</span></span><span style="display:flex;"><span>        first_name   <span style="color:#f92672">=</span> read_string(fnotes)
</span></span><span style="display:flex;"><span>        last_name    <span style="color:#f92672">=</span> read_string(fnotes)
</span></span><span style="display:flex;"><span>        email        <span style="color:#f92672">=</span> read_string(fnotes)
</span></span><span style="display:flex;"><span>        title        <span style="color:#f92672">=</span> read_string(fnotes)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        key_index_field <span style="color:#f92672">=</span> struct<span style="color:#f92672">.</span>unpack(<span style="color:#e6db74">&#34;&lt;Q&#34;</span>, fnotes<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">8</span>))[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        encrypted_content <span style="color:#f92672">=</span> read_bytes(fnotes)
</span></span><span style="display:flex;"><span>        creation_date <span style="color:#f92672">=</span> struct<span style="color:#f92672">.</span>unpack(<span style="color:#e6db74">&#34;&lt;Q&#34;</span>, fnotes<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">8</span>))[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        modification_date <span style="color:#f92672">=</span> struct<span style="color:#f92672">.</span>unpack(<span style="color:#e6db74">&#34;&lt;Q&#34;</span>, fnotes<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">8</span>))[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        suspended <span style="color:#f92672">=</span> struct<span style="color:#f92672">.</span>unpack(<span style="color:#e6db74">&#34;&lt;B&#34;</span>, fnotes<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">1</span>))[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Which key was used?</span>
</span></span><span style="display:flex;"><span>        plaintext <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> key_index_field <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0xFFFFFFFFFFFFFFFF</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> idx <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">64</span>):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> key_index_field <span style="color:#f92672">&amp;</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> idx):
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> idx <span style="color:#f92672">&lt;</span> len(keys):
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                            plaintext <span style="color:#f92672">=</span> des_decrypt(keys[idx], encrypted_content)<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#34;utf-8&#34;</span>, errors<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;replace&#34;</span>)
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>                            plaintext <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&lt;decrypt error: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&gt;&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            plaintext <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;no content&gt;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        notes<span style="color:#f92672">.</span>append({
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;id&#34;</span>: note_id,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;title&#34;</span>: title,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;author&#34;</span>: <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>first_name<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{</span>last_name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;email&#34;</span>: email,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;content&#34;</span>: plaintext,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;suspended&#34;</span>: suspended,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;access_token&#34;</span>: access_token,
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> notes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ---- Run ----</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> sys<span style="color:#f92672">,</span> json
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Usage: </span><span style="color:#e6db74">{</span>sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74"> &lt;lunadb_file&gt;&#34;</span>)
</span></span><span style="display:flex;"><span>        sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    notes <span style="color:#f92672">=</span> parse_lunadb(sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> notes:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;=&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">40</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Note ID: </span><span style="color:#e6db74">{</span>n[<span style="color:#e6db74">&#39;id&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Title: </span><span style="color:#e6db74">{</span>n[<span style="color:#e6db74">&#39;title&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Author: </span><span style="color:#e6db74">{</span>n[<span style="color:#e6db74">&#39;author&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74"> &lt;</span><span style="color:#e6db74">{</span>n[<span style="color:#e6db74">&#39;email&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&gt;&#34;</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Access Token: </span><span style="color:#e6db74">{</span>n[<span style="color:#e6db74">&#39;access_token&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Suspended: </span><span style="color:#e6db74">{</span>n[<span style="color:#e6db74">&#39;suspended&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Content:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">{</span>n[<span style="color:#e6db74">&#39;content&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;HOLACTF{&#34;</span> <span style="color:#f92672">in</span> n[<span style="color:#e6db74">&#39;content&#39;</span>]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span></code></pre></div><p>K·∫øt qu·∫£ tr·∫£ v·ªÅ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>Note ID: 2976
</span></span><span style="display:flex;"><span>Title: coding
</span></span><span style="display:flex;"><span>Author: Candice Debroux <span style="color:#f92672">&lt;</span>Candice_Debroux<span style="color:#a6e22e">@gmx.com</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>Access Token: 7zVjVolwo0ZOXwnbexQEx7YsxyelEekQ
</span></span><span style="display:flex;"><span>Suspended: 0
</span></span><span style="display:flex;"><span>Content:
</span></span><span style="display:flex;"><span>Programming today is a race between software engineers striving to build bigger and better idiot<span style="color:#f92672">-</span>proof programs and the Universe trying to produce bigger and better idiots. So far, the Universe is winning. 
</span></span><span style="display:flex;"><span><span style="color:#f92672">========================================</span>
</span></span><span style="display:flex;"><span>Note ID: 7272
</span></span><span style="display:flex;"><span>Title: This is real flag
</span></span><span style="display:flex;"><span>Author: lunaere the secret agent <span style="color:#f92672">&lt;</span>luna<span style="color:#a6e22e">@osu.me</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>Access Token: ZEBD9aJy8iMuGBqUaa1yUKoXvddvGLra
</span></span><span style="display:flex;"><span>Suspended: 1
</span></span><span style="display:flex;"><span>Content:
</span></span><span style="display:flex;"><span>HOLACTF{4_c0Ol_Cu5t0m_f1lE_5truC7}
</span></span></code></pre></div><pre><code>Flag: HOLACTF{4_c0Ol_Cu5t0m_f1lE_5truC7}
</code></pre>
<h3 id="2-weird-png">
<a class="header-anchor" href="#2-weird-png"></a>
2. Weird PNG
</h3><p><img src="https://hackmd.io/_uploads/Bkx6VSb5eg.png" alt="image"></p>
<p>ƒê·ªÅ cho ta m·ªôt file <code>weird.png</code> v√† khi ph√¢n t√≠ch, ta ƒë∆∞·ª£c:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">‚ûú</span>  <span style="color:#a6e22e">build</span> <span style="color:#a6e22e">git</span><span style="color:#f92672">:</span>(<span style="color:#a6e22e">master</span>) <span style="color:#960050;background-color:#1e0010">‚úó</span> <span style="color:#a6e22e">xxd</span> <span style="color:#a6e22e">weird</span>.<span style="color:#a6e22e">png</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">00000000</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">8950</span> <span style="color:#ae81ff">4e47</span> <span style="color:#ae81ff">0</span><span style="color:#a6e22e">d0a</span> <span style="color:#ae81ff">1</span><span style="color:#a6e22e">a0a</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">000</span><span style="color:#a6e22e">d</span> <span style="color:#ae81ff">4948</span> <span style="color:#ae81ff">4452</span>  .<span style="color:#a6e22e">PNG</span>........<span style="color:#a6e22e">IHDR</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">00000010</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">00</span><span style="color:#a6e22e">ff</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">00</span><span style="color:#a6e22e">ff</span> <span style="color:#ae81ff">0802</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span>  ................
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">00000020</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">008</span><span style="color:#a6e22e">c</span> <span style="color:#a6e22e">c88e</span> <span style="color:#a6e22e">d88e</span> <span style="color:#a6e22e">c0b8</span> <span style="color:#a6e22e">c007</span> <span style="color:#ae81ff">8</span><span style="color:#a6e22e">ed0</span> <span style="color:#a6e22e">bc00</span> <span style="color:#ae81ff">7</span><span style="color:#a6e22e">c83</span>  ..............<span style="color:#f92672">|</span>.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">00000030</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ec01</span> <span style="color:#ae81ff">89e5</span> <span style="color:#a6e22e">c646</span> <span style="color:#ae81ff">0000</span> <span style="color:#a6e22e">b85f</span> <span style="color:#ae81ff">7</span><span style="color:#a6e22e">d50</span> <span style="color:#a6e22e">b832</span> <span style="color:#ae81ff">3750</span>  .....<span style="color:#a6e22e">F</span>...<span style="color:#a6e22e">_</span>}<span style="color:#a6e22e">P</span>.<span style="color:#ae81ff">27</span><span style="color:#a6e22e">P</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">00000040</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">b85f</span> <span style="color:#ae81ff">3750</span> <span style="color:#a6e22e">b821</span> <span style="color:#ae81ff">4035</span> <span style="color:#ae81ff">1212</span> <span style="color:#ae81ff">50</span><span style="color:#a6e22e">b8</span> <span style="color:#a6e22e">bccc</span> <span style="color:#ae81ff">3588</span>  .<span style="color:#a6e22e">_7P</span>.<span style="color:#f92672">!</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">5.</span>.<span style="color:#a6e22e">P</span>...<span style="color:#ae81ff">5.</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">00000050</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">8850</span> <span style="color:#a6e22e">b8a8</span> <span style="color:#a6e22e">a935</span> <span style="color:#ae81ff">9999</span> <span style="color:#ae81ff">50</span><span style="color:#a6e22e">b8</span> <span style="color:#ae81ff">5</span><span style="color:#a6e22e">b78</span> <span style="color:#ae81ff">350</span><span style="color:#a6e22e">f</span> <span style="color:#ae81ff">2750</span>  .<span style="color:#a6e22e">P</span>...<span style="color:#ae81ff">5.</span>.<span style="color:#a6e22e">P</span>.[<span style="color:#a6e22e">x5</span>.<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">P</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">00000060</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">b807</span> <span style="color:#ae81ff">5</span><span style="color:#a6e22e">c35</span> <span style="color:#ae81ff">3713</span> <span style="color:#ae81ff">50</span><span style="color:#a6e22e">b8</span> <span style="color:#ae81ff">2815</span> <span style="color:#ae81ff">3577</span> <span style="color:#ae81ff">7750</span> <span style="color:#a6e22e">b85c</span>  ..<span style="color:#960050;background-color:#1e0010">\</span><span style="color:#ae81ff">57.</span><span style="color:#a6e22e">P</span>.(.<span style="color:#ae81ff">5</span><span style="color:#a6e22e">wwP</span>.<span style="color:#f92672">\</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">00000070</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3035</span> <span style="color:#ae81ff">6969</span> <span style="color:#ae81ff">50</span><span style="color:#a6e22e">b8</span> <span style="color:#ae81ff">5348</span> <span style="color:#ae81ff">3560</span> <span style="color:#ae81ff">0950</span> <span style="color:#a6e22e">b864</span> <span style="color:#ae81ff">5935</span>  <span style="color:#ae81ff">05</span><span style="color:#a6e22e">iiP</span>.<span style="color:#a6e22e">SH5</span><span style="color:#e6db74">`.P.dY5
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00000080: 2222 50b8 5245 3511 1150 b86d 0235 2143  &#34;&#34;P.RE5..P.m.5!C
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00000090: 50b8 7c5d 3534 1250 89e5 8a46 0045 08c0  P.|]54.P...F.E..
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">000000a0: 740a b40e b700 b307 cd10 ebee ebfe 0000  t...............
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">000000b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">000001f0: 0000 0000 0000 0000 0000 0000 0000 55aa  ..............U.
</span></span></span></code></pre></div><p>·ªû ƒë√¢y, sau IHDR ƒë√°ng ra ph·∫£i c√≥ CRC r·ªìi t·ªõi c√°c chunk nh∆∞ IDAT, IEND. Tuy nhi√™n, ta l·∫°i th·∫•y byte nh∆∞ m√£ m√°y x86 v√† khi h·ªèi chatGPT th√¨ ƒë∆∞·ª£c tr·∫£ l·ªùi l√†: File kh√¥ng ph·∫£i PNG th·∫≠t, m√† l√† MBR boot sector 512 bytes ƒë∆∞·ª£c b·ªçc ƒë·∫ßu PNG h·ª£p l·ªá.
V√¨ v·∫≠y m√¨nh ƒë√£ l·∫•y chu·ªói ƒë∆∞·ª£c in ra v√† nh·ªù AI t·∫°o script python gi·∫£i m√£:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>data <span style="color:#f92672">=</span> bytes<span style="color:#f92672">.</span>fromhex(
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;8c c8 8e d8 8e c0 b8 c0 07 8e d0 bc 00 7c 83 ec 01 89 e5 c6 46 00 00 &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;b8 5f 7d 50 b8 32 37 50 b8 5f 37 50 b8 21 40 35 12 12 50 b8 bc cc 35 &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;88 88 50 b8 a8 a9 35 99 99 50 b8 5b 78 35 0f 27 50 b8 07 5c 35 37 13 &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;50 b8 28 15 35 77 77 50 b8 5c 30 35 69 69 50 b8 53 48 35 60 09 50 b8 &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;64 59 35 22 22 50 b8 52 45 35 11 11 50 b8 6d 02 35 21 43 50 b8 7c 5d &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;35 34 12 50 89 e5 8a 46 00 45 08 c0 74 0a b4 0e b4 00 b3 07 cd 10 eb ee eb fe&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; ax<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>; words<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> i <span style="color:#f92672">&lt;</span> len(data):
</span></span><span style="display:flex;"><span>    b<span style="color:#f92672">=</span>data[i]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> b<span style="color:#f92672">==</span><span style="color:#ae81ff">0xB8</span>:
</span></span><span style="display:flex;"><span>        ax <span style="color:#f92672">=</span> data[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">|</span> (data[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">8</span>)
</span></span><span style="display:flex;"><span>        i<span style="color:#f92672">+=</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> b<span style="color:#f92672">==</span><span style="color:#ae81ff">0x35</span>:
</span></span><span style="display:flex;"><span>        imm <span style="color:#f92672">=</span> data[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">|</span> (data[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">8</span>)
</span></span><span style="display:flex;"><span>        ax <span style="color:#f92672">=</span> (ax <span style="color:#f92672">^</span> imm) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xffff</span>
</span></span><span style="display:flex;"><span>        i<span style="color:#f92672">+=</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> b<span style="color:#f92672">==</span><span style="color:#ae81ff">0x50</span>:
</span></span><span style="display:flex;"><span>        words<span style="color:#f92672">.</span>append(ax <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xffff</span>)
</span></span><span style="display:flex;"><span>        i<span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        i<span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># gh√©p theo th·ª© t·ª± pop (ƒë·∫£o)</span>
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(((w <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>)<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;little&#39;</span>) <span style="color:#f92672">+</span> ((w<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">8</span>)<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xff</span>)<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;little&#39;</span>)) <span style="color:#66d9ef">for</span> w <span style="color:#f92672">in</span> reversed(words))
</span></span><span style="display:flex;"><span>print(s<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;latin1&#39;</span>))
</span></span></code></pre></div><pre><code>Flag: HOLACTF{3A5Y_b0OT_104D3R_727_}
</code></pre>
<h2 id="osint">
<a class="header-anchor" href="#osint"></a>
Osint
</h2><h3 id="1-ehc-is-my-family">
<a class="header-anchor" href="#1-ehc-is-my-family"></a>
1. EHC is my family
</h3><p><img src="https://hackmd.io/_uploads/Sy8IUr-qxe.png" alt="image">
<img src="https://hackmd.io/_uploads/rknuIB-5gl.jpg" alt="danang_ehc"></p>
<p>ƒê·ªÉ √Ω b√™n tr√°i m√¨nh th·∫•y c√≥ logo c·ªßa tr∆∞·ªùng VKU, n√™n bi·∫øt ngay ƒë√≥ l√† Tr∆∞·ªùng ƒê·∫°i h·ªçc C√¥ng ngh·ªá Th√¥ng tin v√† Truy·ªÅn th√¥ng Vi·ªát H√†n.</p>
<pre><code>Flag: HOLACTF{truong_dai_hoc_cong_nghe_thong_tin_va_truyen_thong_viet_han}
</code></pre>
</div>
    <footer class="article-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/ctf"
        rel="tag"
        >CTF</a
      >
    </li><li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/cryptography"
        rel="tag"
        >CRYPTOGRAPHY</a
      >
    </li><li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/miscellaneous"
        rel="tag"
        >MISCELLANEOUS</a
      >
    </li><li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/osint"
        rel="tag"
        >OSINT</a
      >
    </li></ul>
</footer>
  </div><nav
    id="article-nav"
    aria-label="Article navigation"
    data-aos="fade-up"
  ><div class="article-nav-link-wrap left"><img
            data-src="/images/Certificate.png"
            data-sizes="auto"
            alt="NahamCon CTF 2025"
            class="lazyload"
          /><a
          href="/post/nahamconctf2025/"
          aria-label="Prev:NahamCon CTF 2025"
          title="Prev:NahamCon CTF 2025"
        ></a>
        <div class="article-nav-caption">Prev</div>
        <h3 class="article-nav-title">NahamCon CTF 2025</h3>
      </div><div class="article-nav-link-wrap right"><img
            data-src="/images/imaginary.jpg"
            data-sizes="auto"
            alt="ImaginaryCTF 2025"
            class="lazyload"
          /><a
          href="/post/imaginaryctf2025/"
          aria-label="Next:ImaginaryCTF 2025"
          title="Next:ImaginaryCTF 2025"
        ></a>
        <div class="article-nav-caption">Next</div>
        <h3 class="article-nav-title">ImaginaryCTF 2025</h3>
      </div></nav></article></section>
        </div><footer id="footer" aria-label="Site footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info"><div>
      <span class="icon-copyright"></span>2020-2025<span class="footer-info-sep rotate"></span>
      D-Sketon
    </div><div>
        Powered by&nbsp;<a
          href="https://gohugo.io/"
          target="_blank"
          rel="noopener nofollow noreferrer"
          >Hugo</a
        >&nbsp; Theme.<a
          href="https://github.com/D-Sketon/hugo-theme-reimu"
          target="_blank"
          rel="noopener nofollow noreferrer"
          >Reimu</a
        >
      </div><div>
        <span class="icon-brush"
          >&nbsp;23.8k</span
        >
        &nbsp;|&nbsp;
        <span class="icon-coffee">&nbsp;01:57</span>
      </div><div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv"
          >Number of visits&nbsp;<span
            id="busuanzi_value_site_pv"
          ></span
        ></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv"
          >Number of visitors&nbsp;<span
            id="busuanzi_value_site_uv"
          ></span
        ></span>
      </div></div>
</footer>
<div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div><div id="mask" class="hide"></div>
      </div><nav id="mobile-nav" aria-label="Mobile navigation">
  <div class="sidebar-wrap"><div class="sidebar-toc-sidebar"><h3 class="toc-title">Contents</h3>
<div class="sidebar-toc-wrapper toc-div-class">
  <nav id="TableOfContents">
  <ul>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#1-cs2rtrash">1. Cs2RTrash</a></li>
        <li><a href="#2-enigmahardcode">2. EnigmaHardCode</a></li>
        <li><a href="#3-imlosingyou">3. ImLosingYou</a></li>
      </ul>
    </li>
    <li><a href="#misc">Misc</a>
      <ul>
        <li><a href="#1-lunadb">1. LunaDB</a></li>
        <li><a href="#2-weird-png">2. Weird PNG</a></li>
      </ul>
    </li>
    <li><a href="#osint">Osint</a>
      <ul>
        <li><a href="#1-ehc-is-my-family">1. EHC is my family</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div></div>
        <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img
    data-src="/avatar/avatar.webp"
    data-sizes="auto"
    alt="D-Sketon"
    class="lazyload"
  />
  <div class="sidebar-author-name">D-Sketon</div>
  <div class="sidebar-description">Â∞ëÂ•≥Á•àÁ•∑‰∏≠...</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div><div class="sidebar-state-number">9</div>
  </div>
  <a class="sidebar-state-category" href="/categories/" aria-label="sidebar-state-category-link">
    <div>Categories</div>
    <div class="sidebar-state-number">
      3
    </div>
  </a>
  <a class="sidebar-state-tag" href="/tags/" aria-label="sidebar-state-tag-link">
    <div>Tags</div>
    <div class="sidebar-state-number">7</div>
  </a>
</div>
<div class="sidebar-social"></div>
<div class="sidebar-menu"><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Home</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Archives</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">About</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/friend"
        aria-label="Friend"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Friend</div>
    </div></div>
</div></div><div class="sidebar-btn-wrapper">
        <div class="sidebar-toc-btn current"></div>
        <div class="sidebar-common-btn"></div>
      </div></nav>
</div><script
    src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"
    integrity="sha384-3gT/vsepWkfz/ff7PpWNUeMzeWoH3cDhm/A8jM7ouoAK0/fP/9bcHHR5kHq2nf&#43;e" crossorigin="anonymous"></script><script
    src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"
    integrity="sha384-J08i8An/QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"></script><script src="/js/main.js" integrity="" crossorigin="anonymous" ></script><script src="/js/aos.js" integrity="" crossorigin="anonymous" ></script><script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", aosInit);
    } else {
      aosInit();
    }
  </script><script src="/js/pjax_main.js" integrity="" crossorigin="anonymous" data-pjax></script><script
    src="https://npm.webcache.cn/mouse-firework@0.1.1/dist/index.umd.js"
    integrity="sha384-8LyaidD9GPxQQgLJO/WRw/O2h3BoNq/ApI/ecpvM6RsrCz2qP2ppBXUKihP4V/2d" crossorigin="anonymous"></script><script>
  if (! false  || !window.matchMedia('(max-width: 768px)').matches) {
    if (window.firework) {
      const options = JSON.parse("{\"excludeelements\":[\"a\",\"button\"],\"particles\":[{\"colors\":[\"var(--red-1)\",\"var(--red-2)\",\"var(--red-3)\",\"var(--red-4)\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"emit\"],\"number\":20,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.3,0.5],\"radius\":[16,32]}},{\"colors\":[\"var(--red-0)\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"diffuse\"],\"number\":1,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.2,0.5],\"lineWidth\":6,\"radius\":20}}]}");
      options.excludeElements = options.excludeelements;
      delete options.excludeelements;
      window.firework(options);
    }
  }
</script>

<div id="lazy-script">
  <div><script data-pjax>
        window.REIMU_POST = {
          author: "D-Sketon",
          title: "HOLACTF 2025",
          url: "https:\/\/r1muru2006.github.io\/post\/holactf2025\/",
          description: "Sau ƒë√¢y l√† nh·ªØng b√†i m√¨nh l√†m ƒë∆∞·ª£c trong th·ªùi gian c·ªßa gi·∫£i v·ªõi t·ªïng l√† 6 b√†i v·ªõi 3 b√†i crypto, 2 b√†i misc v√† 1 b√†i osint.",
          cover: "https:\/\/r1muru2006.github.io\/images\/holactf.jpg",
        };
      </script><script src="/js/insert_highlight.js" integrity="" crossorigin="anonymous" data-pjax></script><script src="/js/tabs.js" integrity="" crossorigin="anonymous" data-pjax></script><script type="module" data-pjax>const PhotoSwipeLightbox = (await safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe-lightbox.esm.min.js", "sha384-DiL6M\/gG\u002bwmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF\/N6lrZi\/")).default;const initPswp = (gallery, children) => {
          if (_$$(`${gallery} ${children}`).length > 0) {
            new PhotoSwipeLightbox({
              gallery,
              children,pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")}).init();
          }
        }
        const pswp = () => {
          initPswp('.article-entry', 'a.article-gallery-item');
          initPswp('.article-gallery', 'a.article-gallery-item');
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script><script
    src="https://npm.webcache.cn/katex@0.16.24/dist/katex.min.js"
    data-pjaxintegrity="sha384-MWNUH0WmtsYGhn2cbH6ELRCbf9LG3QDqCC&#43;gqPB3IBNO35xjZK3Ejb6oONRpDbPg" crossorigin="anonymous"></script><script
    src="https://npm.webcache.cn/katex@0.16.24/dist/contrib/auto-render.min.js"
    data-pjaxintegrity="sha384-hCXGrW6PitJEwbkoStFjeJxv&#43;fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"></script><script data-pjax>
          var renderMath = () => {
            if (!window.renderMathInElement) return;
            window.renderMathInElement(_$("article"), {
              delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "\\[", right: "\\]", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
              ],
            });
          };
          if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", renderMath, { once: true });
          } else {
            renderMath();
          }
        </script></div>
</div><script
    src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js"
    asyncintegrity="sha384-0M75wtSkhjIInv4coYlaJU83&#43;OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id&#43;S" crossorigin="anonymous"></script><script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then((registrations) => {
        for (let registration of registrations) {
          registration.unregister();
        }
      });
    }
  </script><script>
  const reimuCopyright = String.raw`
   ______     ______     __     __    __     __  __    
  /\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
  \ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
   \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
    \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                    
  `;
  console.log(String.raw`%c ${reimuCopyright}`, "color: #ff5252;");
  console.log(
    "%c Theme.Reimu" + " %c https://github.com/D-Sketon/hugo-theme-reimu ",
    "color: white; background: #ff5252; padding:5px 0;",
    "padding:4px;border:1px solid #ff5252;",
  );
</script></body>
</html>
