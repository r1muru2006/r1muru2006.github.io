<!doctype html>
<html
  lang="en-us" 
  data-theme-mode="auto"
  >
  <head><meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no"
/><title>
  WannaGame NMLT | D-Sketon
</title>
<meta name="description" content="Đây là Write-up giành cho cuộc thi CTFs để lấy điểm Nhập môn lập trình của mình vào năm nhất."/><script>
  window.siteConfig = JSON.parse("{\"anchor_icon\":null,\"base\":\"https://r1muru2006.github.io/\",\"clipboard\":{\"copyright\":{\"count\":50,\"enable\":false,\"license_type\":\"by-nc-sa\"},\"fail\":{\"en\":\"Copy failed (ﾟ⊿ﾟ)ﾂ\",\"ja\":\"コピー失敗 (ﾟ⊿ﾟ)ﾂ\",\"pt-br\":\"Falha ao copiar (ﾟ⊿ﾟ)ﾂ\",\"zh-cn\":\"复制失败 (ﾟ⊿ﾟ)ﾂ\",\"zh-tw\":\"複製失敗 (ﾟ⊿ﾟ)ﾂ\"},\"success\":{\"en\":\"Copy successfully (*^▽^*)\",\"ja\":\"コピー成功 (*^▽^*)\",\"pt-br\":\"Copiado com sucesso (*^▽^*)\",\"zh-cn\":\"复制成功 (*^▽^*)\",\"zh-tw\":\"複製成功 (*^▽^*)\"}},\"code_block\":{\"expand\":true},\"icon_font\":\"4552607_4k4bc36ef96\",\"outdate\":{\"daysago\":180,\"enable\":false,\"message\":{\"en\":\"This article was last updated on {time}. Please note that the content may no longer be applicable.\",\"ja\":\"この記事は最終更新日：{time}。記載内容が現在有効でない可能性がありますのでご注意ください。\",\"pt-br\":\"Este artigo foi atualizado pela última vez em {time}. Observe que o conteúdo pode não ser mais aplicável.\",\"zh-cn\":\"本文最后更新于 {time}，请注意文中内容可能已不适用。\",\"zh-tw\":\"本文最後更新於 {time}，請注意文中內容可能已不適用。\"}}}");
  
</script>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  rel="preload"
  as="style"
  href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap"
/>
<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap"
  media="print"
  onload="this.media='all'"
/>
<link
    rel="preload"
    href="//at.alicdn.com/t/c/font_4552607_4k4bc36ef96.woff2"
    as="font"
    type="font/woff2"
    crossorigin="anonymous"
  /><link rel="stylesheet" href="/css/loader.min.ac746e154f756f8220326eeb52a719f142ab038be5a8ddf30ea5ef15ef2356ea.css" />
<meta property="og:type" content="website" />
  <meta property="og:title" content="WannaGame NMLT | D-Sketon" />
  <meta
    property="og:description"
    content="Đây là Write-up giành cho cuộc thi CTFs để lấy điểm Nhập môn lập trình của mình vào năm nhất."
  />
  <meta property="og:url" content="https://r1muru2006.github.io/post/wannagamenmlt/" />
  <meta
    property="og:site_name"
    content="My New Hugo Site"
  />
  <meta
    property="og:image"
    content="/images/WannaW1n.png"
  />
  <meta property="article:author" content="D-Sketon" />
  <meta property="article:published_time" content="2025-04-08T10:07:31&#43;07:00" />
  <meta property="article:modified_time" content="2025-04-08T10:07:31&#43;07:00" /><meta property="article:tag" content="CTFCryptographyReverse Engineering" /><meta name="twitter:card" content="summary" />
  <meta name="twitter:image" content="/images/WannaW1n.png" />
<link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/main.min.3f4fd122cf0f99ff7801eb4c3d87d2c30d757b99c89ded49cd78a6de22bd22ba.css" />
<link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css"
    integrity="sha384-IfxC36XL/toUyJ939C73PcgMuRzAZuIzZxE38drsmO5p6jD7ei&#43;Zx/1oA/0l8ysE" crossorigin="anonymous"onload="this.onload=null;this.rel='stylesheet'"
  /><link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/katex@0.16.24/dist/katex.min.css"
    integrity="sha384-tTgKLjMYmJr94v8qu2PE5MUGSMbyN2xiH266JUB3gpm8vnnJywd1dWSOEfrFz&#43;YI" crossorigin="anonymous"onload="this.onload=null;this.rel='stylesheet'"
  /><script
    src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"
    integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"></script><link
    rel="stylesheet"
    href="https://npm.webcache.cn/@reimujs/aos@0.1.2/dist/aos.css"
    integrity="sha384-GMRP93c6Hkz9JVKGAuRR3nTS7M07RwPgTFenXiosjq2VbVgvdDNcz1g6Mkj8AONa" crossorigin="anonymous"/></head>
  <body><div id='loader'>
    <div class="loading-left-bg loading-bg"></div>
    <div class="loading-right-bg loading-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi rotate"><svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="https://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
            <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="var(--red-1, #ff5252)" />
            <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z 
          M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95z" fill="var(--red-1, #ff5252)" />
          </svg></div><div class="loading-word">Loading...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    var loaderEl = document.getElementById('loader');
    var startLoading = () => {
      time = Date.now();
      loaderEl.classList.remove("loading");
    }
    var hideLoader = () => {
      document.body.style.overflow = 'auto';
      loader.classList.add('loading');
    };

    var endLoading = () => {
      if (!time) {
        hideLoader();
      } else {
        if (Date.now() - time > 500) {
          time = null;
          hideLoader();
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    loaderEl.addEventListener('click', endLoading);
  </script><div id="copy-tooltip"></div>
<div id="lang-tooltip">
This article does not have a corresponding language version
</div>
<div id="heatmap-tooltip"></div><div id="container">
      <div id="wrap"><div id="header-nav">
  <nav id="main-nav" aria-label="Primary navigation"><a class="main-nav-link-wrap" href="/">
        <div class='main-nav-icon icon rotate'>&#xe62b;</div>
        <span class="main-nav-link">Home</span>
      </a><a class="main-nav-link-wrap" href="/archives">
        <div class='main-nav-icon icon rotate'>&#xe62b;</div>
        <span class="main-nav-link">Archives</span>
      </a><a class="main-nav-link-wrap" href="/about">
        <div class='main-nav-icon icon rotate'>&#xe62b;</div>
        <span class="main-nav-link">About</span>
      </a><a class="main-nav-link-wrap" href="/friend">
        <div class='main-nav-icon icon rotate'>&#xe62b;</div>
        <span class="main-nav-link">Friend</span>
      </a><a id="main-nav-toggle" class="nav-icon" aria-label="Toggle navigation" role="button"></a>
  </nav>
  <nav id="sub-nav" aria-label="Secondary navigation"></nav></div>
<header id="header" aria-label="Site header"><picture></picture>
    <img  fetchpriority="high" src="/images/WannaW1n.png" alt="WannaGame NMLT"><div id="header-outer">
    <div id="header-title"><span id="logo">
            <h1 data-aos="slide-up">WannaGame NMLT</h1>
          </span><h2 id="subtitle-wrap" data-aos="slide-down"></h2></div>
  </div>
</header><div id="content"
          aria-label="Page content"
          
          class="sidebar-right"  ><aside id="sidebar" aria-label="Sidebar"><div class="sidebar-wrapper-container sticky"><div class="sidebar-wrapper">
    <div
      class="sidebar-wrap"
      data-aos="fade-up"
    ><div class="sidebar-toc-sidebar"><h3 class="toc-title">Contents</h3>
<div class="sidebar-toc-wrapper toc-div-class">
  <nav id="TableOfContents">
  <ul>
    <li><a href="#pwn">Pwn</a>
      <ul>
        <li><a href="#1-hello-pwner">1. Hello pwner</a></li>
      </ul>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#2-substitution">2. Substitution</a></li>
        <li><a href="#3-hix">3. Hix</a></li>
        <li><a href="#4-dh">4. DH</a></li>
      </ul>
    </li>
    <li><a href="#reverse">Reverse</a>
      <ul>
        <li><a href="#5-giacmotrua2">5. GiacMoTrua2</a></li>
        <li><a href="#6-easy-flag-checker">6. Easy Flag Checker</a></li>
        <li><a href="#7-giacmotrua1">7. GiacMoTrua1</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div></div>
          <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img
    data-src="/avatar/avatar.webp"
    data-sizes="auto"
    alt="D-Sketon"
    class="lazyload"
  />
  <div class="sidebar-author-name">D-Sketon</div>
  <div class="sidebar-description">少女祈祷中...</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div><div class="sidebar-state-number">9</div>
  </div>
  <a class="sidebar-state-category" href="/categories/" aria-label="sidebar-state-category-link">
    <div>Categories</div>
    <div class="sidebar-state-number">
      3
    </div>
  </a>
  <a class="sidebar-state-tag" href="/tags/" aria-label="sidebar-state-tag-link">
    <div>Tags</div>
    <div class="sidebar-state-number">7</div>
  </a>
</div>
<div class="sidebar-social"></div>
<div class="sidebar-menu"><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Home</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Archives</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">About</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/friend"
        aria-label="Friend"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Friend</div>
    </div></div>
</div><div class="sidebar-btn-wrapper" style="position:static">
            <div class="sidebar-toc-btn current"></div>
            <div class="sidebar-common-btn"></div>
          </div></div>
  </div><div class="sidebar-widget"></div></div></aside>
<section id="main" aria-label="Main content"><article
  class="h-entry article"
  itemscope
  itemtype="https://schema.org/BlogPosting"
>
  <div
    class="article-inner"
    data-aos="fade-up"
  >
    <div class="article-meta"><div class="article-date">
  <span
    class="article-date-link icon-calendar"
    data-aos="zoom-in"
  >
    <time datetime="2025-04-08 10:07:31 &#43;0700 &#43;07" itemprop="datePublished"
      >2025-04-08</time
    >
    <time style="display: none;" id="post-update-time"
      >2025-04-08</time
    >
  </span></div>
<div class="article-category"><a
      class="article-category-link"
      href="/categories/ctf-write-up"
      data-aos="zoom-in"
      >CTF WRITE-UP</a
    ><a
      class="article-category-link"
      href="/categories/wannagame"
      data-aos="zoom-in"
      >WANNAGAME</a
    ></div>
</div><div class="hr-line"></div><div class="e-content article-entry" itemprop="articleBody"><h2 id="pwn">
<a class="header-anchor" href="#pwn"></a>
Pwn
</h2><h3 id="1-hello-pwner">
<a class="header-anchor" href="#1-hello-pwner"></a>
1. Hello pwner
</h3><p><img src="https://hackmd.io/_uploads/SyPcemLL1g.png" alt="image"></p>
<pre><code>Flag: W1{welcome_to_assembly}
</code></pre>
<h2 id="crypto">
<a class="header-anchor" href="#crypto"></a>
Crypto
</h2><h3 id="2-substitution">
<a class="header-anchor" href="#2-substitution"></a>
2. Substitution
</h3><p>Tải file, giải nén và mở chall lên:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>KEY <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#e6db74">&#39;Q&#39;</span>, <span style="color:#e6db74">&#39;B&#39;</span>: <span style="color:#e6db74">&#39;W&#39;</span>, <span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#e6db74">&#39;E&#39;</span>, <span style="color:#e6db74">&#39;D&#39;</span>: <span style="color:#e6db74">&#39;R&#39;</span>, <span style="color:#e6db74">&#39;E&#39;</span>: <span style="color:#e6db74">&#39;T&#39;</span>, <span style="color:#e6db74">&#39;F&#39;</span>: <span style="color:#e6db74">&#39;Y&#39;</span>, <span style="color:#e6db74">&#39;G&#39;</span>: <span style="color:#e6db74">&#39;U&#39;</span>, <span style="color:#e6db74">&#39;H&#39;</span>: <span style="color:#e6db74">&#39;I&#39;</span>, <span style="color:#e6db74">&#39;I&#39;</span>: <span style="color:#e6db74">&#39;O&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;J&#39;</span>: <span style="color:#e6db74">&#39;P&#39;</span>, <span style="color:#e6db74">&#39;K&#39;</span>: <span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#e6db74">&#39;L&#39;</span>: <span style="color:#e6db74">&#39;S&#39;</span>, <span style="color:#e6db74">&#39;M&#39;</span>: <span style="color:#e6db74">&#39;D&#39;</span>, <span style="color:#e6db74">&#39;N&#39;</span>: <span style="color:#e6db74">&#39;F&#39;</span>, <span style="color:#e6db74">&#39;O&#39;</span>: <span style="color:#e6db74">&#39;G&#39;</span>, <span style="color:#e6db74">&#39;P&#39;</span>: <span style="color:#e6db74">&#39;H&#39;</span>, <span style="color:#e6db74">&#39;Q&#39;</span>: <span style="color:#e6db74">&#39;J&#39;</span>, <span style="color:#e6db74">&#39;R&#39;</span>: <span style="color:#e6db74">&#39;K&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;S&#39;</span>: <span style="color:#e6db74">&#39;L&#39;</span>, <span style="color:#e6db74">&#39;T&#39;</span>: <span style="color:#e6db74">&#39;Z&#39;</span>, <span style="color:#e6db74">&#39;U&#39;</span>: <span style="color:#e6db74">&#39;X&#39;</span>, <span style="color:#e6db74">&#39;V&#39;</span>: <span style="color:#e6db74">&#39;C&#39;</span>, <span style="color:#e6db74">&#39;W&#39;</span>: <span style="color:#e6db74">&#39;V&#39;</span>, <span style="color:#e6db74">&#39;X&#39;</span>: <span style="color:#e6db74">&#39;B&#39;</span>, <span style="color:#e6db74">&#39;Y&#39;</span>: <span style="color:#e6db74">&#39;N&#39;</span>, <span style="color:#e6db74">&#39;Z&#39;</span>: <span style="color:#e6db74">&#39;M&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;a&#39;</span>: <span style="color:#e6db74">&#39;q&#39;</span>, <span style="color:#e6db74">&#39;b&#39;</span>: <span style="color:#e6db74">&#39;w&#39;</span>, <span style="color:#e6db74">&#39;c&#39;</span>: <span style="color:#e6db74">&#39;e&#39;</span>, <span style="color:#e6db74">&#39;d&#39;</span>: <span style="color:#e6db74">&#39;r&#39;</span>, <span style="color:#e6db74">&#39;e&#39;</span>: <span style="color:#e6db74">&#39;t&#39;</span>, <span style="color:#e6db74">&#39;f&#39;</span>: <span style="color:#e6db74">&#39;y&#39;</span>, <span style="color:#e6db74">&#39;g&#39;</span>: <span style="color:#e6db74">&#39;u&#39;</span>, <span style="color:#e6db74">&#39;h&#39;</span>: <span style="color:#e6db74">&#39;i&#39;</span>, <span style="color:#e6db74">&#39;i&#39;</span>: <span style="color:#e6db74">&#39;o&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;j&#39;</span>: <span style="color:#e6db74">&#39;p&#39;</span>, <span style="color:#e6db74">&#39;k&#39;</span>: <span style="color:#e6db74">&#39;a&#39;</span>, <span style="color:#e6db74">&#39;l&#39;</span>: <span style="color:#e6db74">&#39;s&#39;</span>, <span style="color:#e6db74">&#39;m&#39;</span>: <span style="color:#e6db74">&#39;d&#39;</span>, <span style="color:#e6db74">&#39;n&#39;</span>: <span style="color:#e6db74">&#39;f&#39;</span>, <span style="color:#e6db74">&#39;o&#39;</span>: <span style="color:#e6db74">&#39;g&#39;</span>, <span style="color:#e6db74">&#39;p&#39;</span>: <span style="color:#e6db74">&#39;h&#39;</span>, <span style="color:#e6db74">&#39;q&#39;</span>: <span style="color:#e6db74">&#39;j&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>: <span style="color:#e6db74">&#39;k&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;s&#39;</span>: <span style="color:#e6db74">&#39;l&#39;</span>, <span style="color:#e6db74">&#39;t&#39;</span>: <span style="color:#e6db74">&#39;z&#39;</span>, <span style="color:#e6db74">&#39;u&#39;</span>: <span style="color:#e6db74">&#39;x&#39;</span>, <span style="color:#e6db74">&#39;v&#39;</span>: <span style="color:#e6db74">&#39;c&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>: <span style="color:#e6db74">&#39;v&#39;</span>, <span style="color:#e6db74">&#39;x&#39;</span>: <span style="color:#e6db74">&#39;b&#39;</span>, <span style="color:#e6db74">&#39;y&#39;</span>: <span style="color:#e6db74">&#39;n&#39;</span>, <span style="color:#e6db74">&#39;z&#39;</span>: <span style="color:#e6db74">&#39;m&#39;</span>,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hehe</span>(data, key):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(key<span style="color:#f92672">.</span>get(char, char) <span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encrypt</span>(plaintext):
</span></span><span style="display:flex;"><span>    substituted <span style="color:#f92672">=</span> hehe(plaintext, KEY)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> substituted
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    plaintext <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;W1{???????????????}&#34;</span>
</span></span><span style="display:flex;"><span>    encrypted <span style="color:#f92672">=</span> encrypt(plaintext)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;encrypted.txt&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>        f<span style="color:#f92672">.</span>write(encrypted)
</span></span></code></pre></div><h4 id="phân-tích">
<a class="header-anchor" href="#ph%c3%a2n-t%c3%adch"></a>
Phân tích:
</h4><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hehe</span>(data, key):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(key<span style="color:#f92672">.</span>get(char, char) <span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> data)
</span></span></code></pre></div><p>Hàm <code>hehe</code> lấy <code>data</code> và chuyển đổi từng ký tự trong dữ liệu đó sang ký tự tương ứng bằng danh sách của <code>KEY</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encrypt</span>(plaintext):
</span></span><span style="display:flex;"><span>    substituted <span style="color:#f92672">=</span> hehe(plaintext, KEY)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> substituted
</span></span></code></pre></div><p>Hàm <code>encrypt</code> có mục đich là sử dụng hàm hehe để mã hóa dữ liệu.
 </p>
<h4 id="giải">
<a class="header-anchor" href="#gi%e1%ba%a3i"></a>
Giải:
</h4><p>Để lấy được <code>plaintext</code> thì ta cần giải mã <code>encrypted</code>, nghĩa là phải đảo ngược lại quá trình chuyển đổi ký tự trong danh sách của <code>KEY</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>KEY_rev <span style="color:#f92672">=</span> {i : v <span style="color:#66d9ef">for</span> v, i <span style="color:#f92672">in</span> KEY<span style="color:#f92672">.</span>items()}
</span></span></code></pre></div><p>Rồi sử dụng hàm <code>hehe</code> chuyển đổi tiếp 1 lần nữa để được <code>data</code> ban đầu.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hehe</span>(data, key):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(key<span style="color:#f92672">.</span>get(char, char) <span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> data)
</span></span></code></pre></div><p>Script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>KEY <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#e6db74">&#39;Q&#39;</span>, <span style="color:#e6db74">&#39;B&#39;</span>: <span style="color:#e6db74">&#39;W&#39;</span>, <span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#e6db74">&#39;E&#39;</span>, <span style="color:#e6db74">&#39;D&#39;</span>: <span style="color:#e6db74">&#39;R&#39;</span>, <span style="color:#e6db74">&#39;E&#39;</span>: <span style="color:#e6db74">&#39;T&#39;</span>, <span style="color:#e6db74">&#39;F&#39;</span>: <span style="color:#e6db74">&#39;Y&#39;</span>, <span style="color:#e6db74">&#39;G&#39;</span>: <span style="color:#e6db74">&#39;U&#39;</span>, <span style="color:#e6db74">&#39;H&#39;</span>: <span style="color:#e6db74">&#39;I&#39;</span>, <span style="color:#e6db74">&#39;I&#39;</span>: <span style="color:#e6db74">&#39;O&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;J&#39;</span>: <span style="color:#e6db74">&#39;P&#39;</span>, <span style="color:#e6db74">&#39;K&#39;</span>: <span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#e6db74">&#39;L&#39;</span>: <span style="color:#e6db74">&#39;S&#39;</span>, <span style="color:#e6db74">&#39;M&#39;</span>: <span style="color:#e6db74">&#39;D&#39;</span>, <span style="color:#e6db74">&#39;N&#39;</span>: <span style="color:#e6db74">&#39;F&#39;</span>, <span style="color:#e6db74">&#39;O&#39;</span>: <span style="color:#e6db74">&#39;G&#39;</span>, <span style="color:#e6db74">&#39;P&#39;</span>: <span style="color:#e6db74">&#39;H&#39;</span>, <span style="color:#e6db74">&#39;Q&#39;</span>: <span style="color:#e6db74">&#39;J&#39;</span>, <span style="color:#e6db74">&#39;R&#39;</span>: <span style="color:#e6db74">&#39;K&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;S&#39;</span>: <span style="color:#e6db74">&#39;L&#39;</span>, <span style="color:#e6db74">&#39;T&#39;</span>: <span style="color:#e6db74">&#39;Z&#39;</span>, <span style="color:#e6db74">&#39;U&#39;</span>: <span style="color:#e6db74">&#39;X&#39;</span>, <span style="color:#e6db74">&#39;V&#39;</span>: <span style="color:#e6db74">&#39;C&#39;</span>, <span style="color:#e6db74">&#39;W&#39;</span>: <span style="color:#e6db74">&#39;V&#39;</span>, <span style="color:#e6db74">&#39;X&#39;</span>: <span style="color:#e6db74">&#39;B&#39;</span>, <span style="color:#e6db74">&#39;Y&#39;</span>: <span style="color:#e6db74">&#39;N&#39;</span>, <span style="color:#e6db74">&#39;Z&#39;</span>: <span style="color:#e6db74">&#39;M&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;a&#39;</span>: <span style="color:#e6db74">&#39;q&#39;</span>, <span style="color:#e6db74">&#39;b&#39;</span>: <span style="color:#e6db74">&#39;w&#39;</span>, <span style="color:#e6db74">&#39;c&#39;</span>: <span style="color:#e6db74">&#39;e&#39;</span>, <span style="color:#e6db74">&#39;d&#39;</span>: <span style="color:#e6db74">&#39;r&#39;</span>, <span style="color:#e6db74">&#39;e&#39;</span>: <span style="color:#e6db74">&#39;t&#39;</span>, <span style="color:#e6db74">&#39;f&#39;</span>: <span style="color:#e6db74">&#39;y&#39;</span>, <span style="color:#e6db74">&#39;g&#39;</span>: <span style="color:#e6db74">&#39;u&#39;</span>, <span style="color:#e6db74">&#39;h&#39;</span>: <span style="color:#e6db74">&#39;i&#39;</span>, <span style="color:#e6db74">&#39;i&#39;</span>: <span style="color:#e6db74">&#39;o&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;j&#39;</span>: <span style="color:#e6db74">&#39;p&#39;</span>, <span style="color:#e6db74">&#39;k&#39;</span>: <span style="color:#e6db74">&#39;a&#39;</span>, <span style="color:#e6db74">&#39;l&#39;</span>: <span style="color:#e6db74">&#39;s&#39;</span>, <span style="color:#e6db74">&#39;m&#39;</span>: <span style="color:#e6db74">&#39;d&#39;</span>, <span style="color:#e6db74">&#39;n&#39;</span>: <span style="color:#e6db74">&#39;f&#39;</span>, <span style="color:#e6db74">&#39;o&#39;</span>: <span style="color:#e6db74">&#39;g&#39;</span>, <span style="color:#e6db74">&#39;p&#39;</span>: <span style="color:#e6db74">&#39;h&#39;</span>, <span style="color:#e6db74">&#39;q&#39;</span>: <span style="color:#e6db74">&#39;j&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>: <span style="color:#e6db74">&#39;k&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;s&#39;</span>: <span style="color:#e6db74">&#39;l&#39;</span>, <span style="color:#e6db74">&#39;t&#39;</span>: <span style="color:#e6db74">&#39;z&#39;</span>, <span style="color:#e6db74">&#39;u&#39;</span>: <span style="color:#e6db74">&#39;x&#39;</span>, <span style="color:#e6db74">&#39;v&#39;</span>: <span style="color:#e6db74">&#39;c&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>: <span style="color:#e6db74">&#39;v&#39;</span>, <span style="color:#e6db74">&#39;x&#39;</span>: <span style="color:#e6db74">&#39;b&#39;</span>, <span style="color:#e6db74">&#39;y&#39;</span>: <span style="color:#e6db74">&#39;n&#39;</span>, <span style="color:#e6db74">&#39;z&#39;</span>: <span style="color:#e6db74">&#39;m&#39;</span>,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>KEY_rev <span style="color:#f92672">=</span> {i : v <span style="color:#66d9ef">for</span> v, i <span style="color:#f92672">in</span> KEY<span style="color:#f92672">.</span>items()}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hehe</span>(data, key):
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(key<span style="color:#f92672">.</span>get(char, char) <span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>(plaintext):
</span></span><span style="display:flex;"><span>  substituted <span style="color:#f92672">=</span> hehe(plaintext, KEY_rev)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> substituted
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>  encrypted <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;V1</span><span style="color:#e6db74">{lxwlzozxzogf}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  decrypted <span style="color:#f92672">=</span> decrypt(encrypted)
</span></span><span style="display:flex;"><span>  print(decrypted)
</span></span></code></pre></div><pre><code>Flag: W1{substitution}
</code></pre>
<p> </p>
<h3 id="3-hix">
<a class="header-anchor" href="#3-hix"></a>
3. Hix
</h3><p>Tải file, giải nén và mở chall lên:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> hashlib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>methods <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;md5&#39;</span>, <span style="color:#e6db74">&#39;sha256&#39;</span>, <span style="color:#e6db74">&#39;sha3_256&#39;</span>, <span style="color:#e6db74">&#39;sha3_512&#39;</span>, <span style="color:#e6db74">&#39;sha3_384&#39;</span>, <span style="color:#e6db74">&#39;sha1&#39;</span>, <span style="color:#e6db74">&#39;sha384&#39;</span>, <span style="color:#e6db74">&#39;sha3_224&#39;</span>, <span style="color:#e6db74">&#39;sha512&#39;</span>, <span style="color:#e6db74">&#39;sha224&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">random_encrypt</span>(x) :
</span></span><span style="display:flex;"><span>    method <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>choice(methods)
</span></span><span style="display:flex;"><span>    hash_obj <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>new(method)
</span></span><span style="display:flex;"><span>    hash_obj<span style="color:#f92672">.</span>update(x<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> hash_obj<span style="color:#f92672">.</span>hexdigest()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>() :
</span></span><span style="display:flex;"><span>    message <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;./../private/flag.txt&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>)<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>    enc <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> message :
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> (ord(char) <span style="color:#f92672">+</span> <span style="color:#ae81ff">20</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">130</span>
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>sha512(str(x)<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest()
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> random_encrypt(x)
</span></span><span style="display:flex;"><span>        enc<span style="color:#f92672">.</span>append(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;encrypted_memory.txt&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>) <span style="color:#66d9ef">as</span> f :
</span></span><span style="display:flex;"><span>        f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;ct = &#34;</span> <span style="color:#f92672">+</span> str(enc))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span> :
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div><h4 id="phân-tích-1">
<a class="header-anchor" href="#ph%c3%a2n-t%c3%adch-1"></a>
Phân tích:
</h4><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>methods <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;md5&#39;</span>, <span style="color:#e6db74">&#39;sha256&#39;</span>, <span style="color:#e6db74">&#39;sha3_256&#39;</span>, <span style="color:#e6db74">&#39;sha3_512&#39;</span>, <span style="color:#e6db74">&#39;sha3_384&#39;</span>, <span style="color:#e6db74">&#39;sha1&#39;</span>, <span style="color:#e6db74">&#39;sha384&#39;</span>, <span style="color:#e6db74">&#39;sha3_224&#39;</span>, <span style="color:#e6db74">&#39;sha512&#39;</span>, <span style="color:#e6db74">&#39;sha224&#39;</span>]
</span></span></code></pre></div><p>Đây là các thuật toán được sử dụng cho hàm băm.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">random_encrypt</span>(x) :
</span></span><span style="display:flex;"><span>    method <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>choice(methods)
</span></span><span style="display:flex;"><span>    hash_obj <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>new(method)
</span></span><span style="display:flex;"><span>    hash_obj<span style="color:#f92672">.</span>update(x<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> hash_obj<span style="color:#f92672">.</span>hexdigest()
</span></span></code></pre></div><p>Hàm <code>random_encrypt</code> dùng để mã hóa một chuỗi x bằng cách sử dụng một thuật toán băm bất kì có sẵn trong <code>methods</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> message :
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> (ord(char) <span style="color:#f92672">+</span> <span style="color:#ae81ff">20</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">130</span>
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>sha512(str(x)<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest()
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> random_encrypt(x)
</span></span><span style="display:flex;"><span>        enc<span style="color:#f92672">.</span>append(x)
</span></span></code></pre></div><p>Lấy từng kí tự trong <code>message</code>, sau đó lấy giá trị của ký tự đó trong ASCII rồi cộng 20 và lấy modulo 130. Tiếp theo, chuyển nó về một chuỗi rồi băm bằng SHA-512. Đến cuối thì sử dụng hàm <code>random_encrypt</code>.
 </p>
<h4 id="giải-1">
<a class="header-anchor" href="#gi%e1%ba%a3i-1"></a>
Giải:
</h4><p>Ý tưởng: Vì x nằm trong đoạn từ 0 đến 129 (là một số nhỏ) nên ta có thể brute-force từng giá trị x khi thử với mỗi phương pháp băm để tìm ra các x tương ứng với từng giá trị của <code>ct</code> một cách dễ dàng.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">reverse_encrypt</span>(enc_hash):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> method <span style="color:#f92672">in</span> methods:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">130</span>):
</span></span><span style="display:flex;"><span>                test_input <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>sha512(str(x)<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest()
</span></span><span style="display:flex;"><span>                hash_obj <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>new(method)
</span></span><span style="display:flex;"><span>                hash_obj<span style="color:#f92672">.</span>update(test_input<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> hash_obj<span style="color:#f92672">.</span>hexdigest() <span style="color:#f92672">==</span> enc_hash:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span></code></pre></div><p>Sau đó, với từng giá trị trong <code>ct</code>, ta dùng hàm <code>reverse_encrypt</code> và truy ngược lại giá trị x ban đầu bằng các phép toán và đổi sang dạng ASCII để giải mã nó bằng hàm sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>():
</span></span><span style="display:flex;"><span>    decrypted_message <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> ct_hash <span style="color:#f92672">in</span> ct:
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> reverse_encrypt(ct_hash)
</span></span><span style="display:flex;"><span>        original_ascii <span style="color:#f92672">=</span> (x <span style="color:#f92672">-</span> <span style="color:#ae81ff">20</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">130</span>
</span></span><span style="display:flex;"><span>        decrypted_message <span style="color:#f92672">+=</span> chr(original_ascii)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> decrypted_message
</span></span></code></pre></div><p>Script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ct <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;f189636f8eef640b55d03387864fd17efd324453cc9276be5ff6bd4da88b13fca72438daaab00830a6d14330d37c0f7bee1e7c32d5dda0541a171f66a2343dc1&#39;</span>, <span style="color:#e6db74">&#39;1388cafa58065fa0c04372ce57f303cc4ec9fe62&#39;</span>, <span style="color:#e6db74">&#39;f6266e2849bf8b8575701814cc3f3eb5369e887db54b34e85b1e4608b4fbf5e5&#39;</span>, <span style="color:#e6db74">&#39;31f33ac191e818db784cf8321d70f84763db2b2e599f90cf65868eec85a10f20ae0e23aa1cd48c2f13eec355b2975089490761a291ac2a1bcf33f5fbecead431&#39;</span>, <span style="color:#e6db74">&#39;981e4bce5dede3faa51a936f650e2c1d64169493860c67d68a1ffbbfa32f58598e7869f3f11aefc1620ee8d3ebe4e5f5&#39;</span>, <span style="color:#e6db74">&#39;f06ffaaa6290bf47d26ba2c09c28dddd8f5bcad6ac464ec17fea48040acf1214d10bc109b7c47cffddb6bccd6b61b61a9e629a8f47ab26b80593f29c8c297489&#39;</span>, <span style="color:#e6db74">&#39;a7d95b3bbde885b4eaa76afc6572e18e4483351005f637fe1f5a7bc0b000fe1f&#39;</span>, <span style="color:#e6db74">&#39;85245de371c327440a5f343f27d6df361225806e679950bab3a5a336&#39;</span>, <span style="color:#e6db74">&#39;ea1923e909de3c3c3384ad9ae7696d73&#39;</span>, <span style="color:#e6db74">&#39;21df20aab35967470aada32375f535d4a735789bf0789fd421f85163c4d75c6e&#39;</span>, <span style="color:#e6db74">&#39;b9491ae1a9de40d30a86c00139bd7d6f496f5bf4ce013bc2d5a43a97&#39;</span>, <span style="color:#e6db74">&#39;03f061f60f3527b15ff31d31dcce0761&#39;</span>, <span style="color:#e6db74">&#39;981e4bce5dede3faa51a936f650e2c1d64169493860c67d68a1ffbbfa32f58598e7869f3f11aefc1620ee8d3ebe4e5f5&#39;</span>, <span style="color:#e6db74">&#39;f2a1a7e9dd5e6363050b0cdb0579ebfebdc5e348ab538bdcf47616139351cf2b9f92cb4d14446b3ad8bf182875b81e75&#39;</span>, <span style="color:#e6db74">&#39;24aaafc58a2b897aed5829b2e96d73b1de7cd680d76a1143cdc8baef&#39;</span>, <span style="color:#e6db74">&#39;6d80d11e5f1161ef86619dcdb186852b5218d6ac224b81b63555fe73741631c36ae0bcb5b3228fbed796c22dedeed587c9d65ddb825aee4fae92b6619e7ffd8f&#39;</span>, <span style="color:#e6db74">&#39;6f8b39550106044625102ee0cabf9fe1393f0013388633d5742fcc7e8df7708793a96885b9d18b795a2b0d9014704b9f&#39;</span>, <span style="color:#e6db74">&#39;ddf3c543be9cac44f3af078583fe5fddb64104d93308c146c23f52ff25b2a6e23606c42dc0060a4dd9b11b446759cb5de1844471eb3d6d25c43c6fcc0d8d60c4&#39;</span>, <span style="color:#e6db74">&#39;95f2739053cf64555b0c0662b5e2d63822433f7fcac6960de6d57efda427461a58c6e2ffac6da6f4caa9407df10cc0be&#39;</span>, <span style="color:#e6db74">&#39;a1bd4e0efc7ce8bd1d63433a0baa87e3a486fbfe2729d73d1dbf7d2822d201ee8726c6d94da1f09f1a53554e440ad6041ecab545b2085dc28c6f6849f0fcea23&#39;</span>, <span style="color:#e6db74">&#39;a7d95b3bbde885b4eaa76afc6572e18e4483351005f637fe1f5a7bc0b000fe1f&#39;</span>, <span style="color:#e6db74">&#39;2b4561a521a82af6a26dfb76078ca97ba53a720f7ee67d923a6d3a13&#39;</span>, <span style="color:#e6db74">&#39;b21ed1f3d501a8a842ef1b26ed3863cf10cf8231ee23a079f749cfa322702c8e&#39;</span>, <span style="color:#e6db74">&#39;d798a32b52384219f8779dccf8b2173f4b73f075cbeb4507ee83c94e&#39;</span>, <span style="color:#e6db74">&#39;b863fa3492fb87edcdef766f38a508ed&#39;</span>, <span style="color:#e6db74">&#39;9f876db4b58c1b7e499f35cdbd533a810060a0c8250bfc5421e0f42b2715b027&#39;</span>, <span style="color:#e6db74">&#39;4b14748ba0f3da581ddd7ec49dac41d34ea1ee6dae90818333b11501&#39;</span>, <span style="color:#e6db74">&#39;85153b2a5f8dea7f5488906cb65d61e9ac0666057636ff6b356dd4d8d0fc5d20&#39;</span>, <span style="color:#e6db74">&#39;6b91d6259827176bcb3f312a8faca297e56c7e627235b930cf8163b3e7a5328b&#39;</span>, <span style="color:#e6db74">&#39;b21ed1f3d501a8a842ef1b26ed3863cf10cf8231ee23a079f749cfa322702c8e&#39;</span>, <span style="color:#e6db74">&#39;4c8740f90af1055f194a4c8e1b69522da228812465eb72b82b35c927bc48bf9d&#39;</span>, <span style="color:#e6db74">&#39;b248b6b2f2c9365aa9a0e9b37a8057effd29bb2f34c79ec0b40124d08986832b5d227db95cb97b176541589985762d9a&#39;</span>, <span style="color:#e6db74">&#39;7260f9b5d1c58d0609523114ed324f396335d940f852dba558461b34c5a53630&#39;</span>, <span style="color:#e6db74">&#39;a1bd4e0efc7ce8bd1d63433a0baa87e3a486fbfe2729d73d1dbf7d2822d201ee8726c6d94da1f09f1a53554e440ad6041ecab545b2085dc28c6f6849f0fcea23&#39;</span>, <span style="color:#e6db74">&#39;1077caf3ed754ed8fbd49c76134906e8&#39;</span>, <span style="color:#e6db74">&#39;f3565219d115ec74a85056997cc25e98e3e4912a31c858c1e45b841047698e93&#39;</span>, <span style="color:#e6db74">&#39;83315b8fa07a35b12e3f47ebb365268b4a4a8ef2&#39;</span>, <span style="color:#e6db74">&#39;64c008d6460c2b98aba616b1d0d11a06b9df564b87d3aeedda83b36aacd3d0c160465109eb06c62e86e360cf026faa27a616dbbf2bec269be9ad128af96073bb&#39;</span>, <span style="color:#e6db74">&#39;60bbd94b3ac3ea7149fc6cd850d72d4f1750601275832815dd9a23d4c3757d84aca29d716da5dd72a0045f15ff969925&#39;</span>, <span style="color:#e6db74">&#39;94327e8c8321421e72f52cd726336e824630ec7dda31b07ce83f11b8234aea7a&#39;</span>, <span style="color:#e6db74">&#39;a69ef62254280226cc4223a2341c727afcd7ce4e3ffd3f2f1c57d9d3cd30659b52b1c2b56f911a7157041b5f0ff8176f&#39;</span>, <span style="color:#e6db74">&#39;3c904622c8d8d79c6704d50ae0175b049b3a5708705ecdce932fe426b9f46f1bd6585b8288c1d38f6301c31af5feac02&#39;</span>, <span style="color:#e6db74">&#39;a3939bf491ffd9824056e249d6e355d8423855f0&#39;</span>]
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> hashlib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>methods <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;md5&#39;</span>, <span style="color:#e6db74">&#39;sha256&#39;</span>, <span style="color:#e6db74">&#39;sha3_256&#39;</span>, <span style="color:#e6db74">&#39;sha3_512&#39;</span>, <span style="color:#e6db74">&#39;sha3_384&#39;</span>, <span style="color:#e6db74">&#39;sha1&#39;</span>, <span style="color:#e6db74">&#39;sha384&#39;</span>, <span style="color:#e6db74">&#39;sha3_224&#39;</span>, <span style="color:#e6db74">&#39;sha512&#39;</span>, <span style="color:#e6db74">&#39;sha224&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">reverse_encrypt</span>(enc_hash):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> method <span style="color:#f92672">in</span> methods:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">130</span>):
</span></span><span style="display:flex;"><span>                test_input <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>sha512(str(x)<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest()
</span></span><span style="display:flex;"><span>                hash_obj <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>new(method)
</span></span><span style="display:flex;"><span>                hash_obj<span style="color:#f92672">.</span>update(test_input<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> hash_obj<span style="color:#f92672">.</span>hexdigest() <span style="color:#f92672">==</span> enc_hash:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>():
</span></span><span style="display:flex;"><span>    decrypted_message <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> ct_hash <span style="color:#f92672">in</span> ct:
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> reverse_encrypt(ct_hash)
</span></span><span style="display:flex;"><span>        original_ascii <span style="color:#f92672">=</span> (x <span style="color:#f92672">-</span> <span style="color:#ae81ff">20</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">130</span>
</span></span><span style="display:flex;"><span>        decrypted_message <span style="color:#f92672">+=</span> chr(original_ascii)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> decrypted_message
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    flag <span style="color:#f92672">=</span> decrypt()
</span></span><span style="display:flex;"><span>    print(flag)
</span></span></code></pre></div><pre><code>Flag: W1{are_you_trying_to_predict_randomness@_@}
</code></pre>
<p> </p>
<h3 id="4-dh">
<a class="header-anchor" href="#4-dh"></a>
4. DH
</h3><p>Tải file, giải nén và mở chall lên:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> isPrime, long_to_bytes, getPrime
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Cipher <span style="color:#f92672">import</span> AES
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.Padding <span style="color:#f92672">import</span> pad
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> random <span style="color:#f92672">import</span> randint
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> hashlib <span style="color:#f92672">import</span> sha256
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>FLAG <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;W1{fake-flag}&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DH</span>:   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>gen_params()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gen_params</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>r <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">512</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>q <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>p <span style="color:#f92672">=</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>q <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>r) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> isPrime(self<span style="color:#f92672">.</span>p):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>h <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>g <span style="color:#f92672">=</span> pow(self<span style="color:#f92672">.</span>h, <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>r, self<span style="color:#f92672">.</span>p)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>g <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>a <span style="color:#f92672">=</span> randint(<span style="color:#ae81ff">2</span>, self<span style="color:#f92672">.</span>p <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>b <span style="color:#f92672">=</span> randint(<span style="color:#ae81ff">2</span>, self<span style="color:#f92672">.</span>p <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>A, self<span style="color:#f92672">.</span>B <span style="color:#f92672">=</span> pow(self<span style="color:#f92672">.</span>g, self<span style="color:#f92672">.</span>a, self<span style="color:#f92672">.</span>p), pow(self<span style="color:#f92672">.</span>g, self<span style="color:#f92672">.</span>b, self<span style="color:#f92672">.</span>p)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>ss <span style="color:#f92672">=</span> pow(self<span style="color:#f92672">.</span>A, self<span style="color:#f92672">.</span>b, self<span style="color:#f92672">.</span>p)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encrypt</span>(self, flag_part):
</span></span><span style="display:flex;"><span>        key <span style="color:#f92672">=</span> sha256(long_to_bytes(self<span style="color:#f92672">.</span>ss))<span style="color:#f92672">.</span>digest()[:<span style="color:#ae81ff">16</span>]
</span></span><span style="display:flex;"><span>        cipher <span style="color:#f92672">=</span> AES<span style="color:#f92672">.</span>new(key, AES<span style="color:#f92672">.</span>MODE_ECB)
</span></span><span style="display:flex;"><span>        ct <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span>encrypt(pad(flag_part, <span style="color:#ae81ff">16</span>))<span style="color:#f92672">.</span>hex()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;encrypted = </span><span style="color:#e6db74">{</span>ct<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_params</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;p = </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>p<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">g = </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>g<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">A = </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>A<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">B = </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>B<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dh <span style="color:#f92672">=</span> DH()
</span></span><span style="display:flex;"><span>    print(dh<span style="color:#f92672">.</span>get_params())
</span></span><span style="display:flex;"><span>    print(dh<span style="color:#f92672">.</span>encrypt(FLAG))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">85013941328859365232686230728938372320812319905627686919070637645614632817039920673725615375841158719310596592903101914818137738460649589340349796188816568005092757847</span>
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> <span style="color:#ae81ff">20033344683527080232439150682925185454003164954955126339094967675384779782733210350757021743656898625398860187361281262413493941502725149445995471514781822892886669776</span>
</span></span><span style="display:flex;"><span>A <span style="color:#f92672">=</span> <span style="color:#ae81ff">76548721461171533747911417838852759206858825205673491250696441734297318615226024320798706656529038703728631231084155790148283919370554345818139818854112841655270107839</span>
</span></span><span style="display:flex;"><span>B <span style="color:#f92672">=</span> <span style="color:#ae81ff">2103083080159597422706551446020625757109756570951674830166998494220734179439318911618156966499109201221652320384817270671579741987575328177442670242481963924501204498</span>
</span></span><span style="display:flex;"><span>encrypted <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;240e7b7678aaaa0dcbe06de7c5598a1ca0be7e2ae584bc7dfd2388cdb1d4fb6a37ceb94556757afc293999cbe5a5a2dbb4071ebf6cfd4332088555f9b2de1922&#34;</span>
</span></span></code></pre></div><p> </p>
<h4 id="phân-tích-2">
<a class="header-anchor" href="#ph%c3%a2n-t%c3%adch-2"></a>
Phân tích:
</h4><p>Trong class DH, có:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gen_params</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>r <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">512</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>q <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>p <span style="color:#f92672">=</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>q <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>r) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> isPrime(self<span style="color:#f92672">.</span>p):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>h <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>g <span style="color:#f92672">=</span> pow(self<span style="color:#f92672">.</span>h, <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>r, self<span style="color:#f92672">.</span>p)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>g <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>a <span style="color:#f92672">=</span> randint(<span style="color:#ae81ff">2</span>, self<span style="color:#f92672">.</span>p <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>b <span style="color:#f92672">=</span> randint(<span style="color:#ae81ff">2</span>, self<span style="color:#f92672">.</span>p <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>A, self<span style="color:#f92672">.</span>B <span style="color:#f92672">=</span> pow(self<span style="color:#f92672">.</span>g, self<span style="color:#f92672">.</span>a, self<span style="color:#f92672">.</span>p), pow(self<span style="color:#f92672">.</span>g, self<span style="color:#f92672">.</span>b, self<span style="color:#f92672">.</span>p)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>ss <span style="color:#f92672">=</span> pow(self<span style="color:#f92672">.</span>A, self<span style="color:#f92672">.</span>b, self<span style="color:#f92672">.</span>p)
</span></span></code></pre></div><p>Hàm <code>gen_params</code> tạo một bộ khóa Diffie-Hellman.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_params</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;p = </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>p<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">g = </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>g<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">A = </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>A<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">B = </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>B<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>Khi lấy hàm <code>get_params</code> thì sẽ trả về các giá trị p, g, A, B.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encrypt</span>(self, flag_part):
</span></span><span style="display:flex;"><span>        key <span style="color:#f92672">=</span> sha256(long_to_bytes(self<span style="color:#f92672">.</span>ss))<span style="color:#f92672">.</span>digest()[:<span style="color:#ae81ff">16</span>]
</span></span><span style="display:flex;"><span>        cipher <span style="color:#f92672">=</span> AES<span style="color:#f92672">.</span>new(key, AES<span style="color:#f92672">.</span>MODE_ECB)
</span></span><span style="display:flex;"><span>        ct <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span>encrypt(pad(flag_part, <span style="color:#ae81ff">16</span>))<span style="color:#f92672">.</span>hex()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;encrypted = </span><span style="color:#e6db74">{</span>ct<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>Ngoài ra, còn có hàm <code>encrypt</code> lấy giá trị <code>ss</code> từ hàm <code>gen_params</code> để tạo key cho thuật toán mã hóa AES chế độ ECB, cuối cùng dùng nó để mã hóa <code>FLAG</code>.</p>
<h4 id="giải-2">
<a class="header-anchor" href="#gi%e1%ba%a3i-2"></a>
Giải:
</h4><p>Để tìm ra <code>FLAG</code> thì ta cần lấy được <code>key</code> để giải mã <code>cipher</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>key <span style="color:#f92672">=</span> sha256(long_to_bytes(ss))<span style="color:#f92672">.</span>digest()[:<span style="color:#ae81ff">16</span>]
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> AES<span style="color:#f92672">.</span>new(key, AES<span style="color:#f92672">.</span>MODE_ECB)
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span>decrypt(encrypted)
</span></span></code></pre></div><p>Do đó, ta phải tìm ra giá trị <code>ss</code> để tạo được <code>key</code>.
Ta có các phương trình sau:</p>
<p>$A≡g^a$ (mod p); $B≡g^b$ $⇒ss≡A^b≡(g^a )^b≡g^{ab}≡(g^b )^a≡B^a$ (mod p)</p>
<p>Ta đã có p, g, A, vậy ta chỉ cần có thêm b là có thể tìm ra <code>ss</code>. Tới đây, tôi sử dụng thuật toán Pohlig-Hellman để tìm b qua công thức $B≡g^b$ (mod p) bằng công cụ Alpetron.</p>
<p><img src="https://hackmd.io/_uploads/B1qrVPIIJg.png" alt="image"></p>
<p>Set k = 0, lấy được b = exp và tính được <code>ss</code>. Sau đây là script cho thử thách:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> long_to_bytes
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Cipher <span style="color:#f92672">import</span> AES
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> hashlib <span style="color:#f92672">import</span> sha256
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">85013941328859365232686230728938372320812319905627686919070637645614632817039920673725615375841158719310596592903101914818137738460649589340349796188816568005092757847</span>
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> <span style="color:#ae81ff">20033344683527080232439150682925185454003164954955126339094967675384779782733210350757021743656898625398860187361281262413493941502725149445995471514781822892886669776</span>
</span></span><span style="display:flex;"><span>A <span style="color:#f92672">=</span> <span style="color:#ae81ff">76548721461171533747911417838852759206858825205673491250696441734297318615226024320798706656529038703728631231084155790148283919370554345818139818854112841655270107839</span>
</span></span><span style="display:flex;"><span>B <span style="color:#f92672">=</span> <span style="color:#ae81ff">2103083080159597422706551446020625757109756570951674830166998494220734179439318911618156966499109201221652320384817270671579741987575328177442670242481963924501204498</span>
</span></span><span style="display:flex;"><span>encrypted <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;240e7b7678aaaa0dcbe06de7c5598a1ca0be7e2ae584bc7dfd2388cdb1d4fb6a37ceb94556757afc293999cbe5a5a2dbb4071ebf6cfd4332088555f9b2de1922&#34;</span>
</span></span><span style="display:flex;"><span>encrypted <span style="color:#f92672">=</span> bytes<span style="color:#f92672">.</span>fromhex(encrypted)
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> <span style="color:#ae81ff">2891401095038</span>
</span></span><span style="display:flex;"><span>ss <span style="color:#f92672">=</span> pow(A, b, p)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> sha256(long_to_bytes(ss))<span style="color:#f92672">.</span>digest()[:<span style="color:#ae81ff">16</span>]
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> AES<span style="color:#f92672">.</span>new(key, AES<span style="color:#f92672">.</span>MODE_ECB)
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span>decrypt(encrypted)
</span></span><span style="display:flex;"><span>print(flag<span style="color:#f92672">.</span>decode())
</span></span></code></pre></div><pre><code>Flag: W1{so_you_know_about_the_Diffie-Hellman-key_exchange}
</code></pre>
<h2 id="reverse">
<a class="header-anchor" href="#reverse"></a>
Reverse
</h2><h3 id="5-giacmotrua2">
<a class="header-anchor" href="#5-giacmotrua2"></a>
5. GiacMoTrua2
</h3><p>Tải file về và phiên dịch mã giả bằng IDA, ta có:</p>
<p><img src="https://hackmd.io/_uploads/rymjEDIIJl.png" alt="image"></p>
<p>Chương trình yêu cầu ta nhập một chuỗi bí mật và đem chuỗi đó so sánh với flag sau khi qua hàm <code>Lookthis</code> được mã hóa thành: &ldquo;W1{live_speels_a5_NoOn_4v4ry_emit!}&rdquo;</p>
<p><img src="https://hackmd.io/_uploads/BJY7rwIIkx.png" alt="image">
<img src="https://hackmd.io/_uploads/BJ37rvI81e.png" alt="image"></p>
<p>Hàm <code>swap</code> dùng để đổi hai kí tự cho nhau. Hàm <code>Lookthis</code> có 3 vòng lặp riêng biệt trên từng khoảng với nhiệm vụ đổi ký tự tương ứng. Như vậy, ta chỉ cần viết script đảo ngược lại và đổi ký tự thì sẽ cho ra được <code>flag</code> ban đầu:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">reverse_lookthis</span>(flag):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">28</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> k <span style="color:#f92672">&lt;</span> (<span style="color:#ae81ff">61</span> <span style="color:#f92672">-</span> k):
</span></span><span style="display:flex;"><span>           flag[k], flag[<span style="color:#ae81ff">61</span> <span style="color:#f92672">-</span> k] <span style="color:#f92672">=</span> flag[<span style="color:#ae81ff">61</span> <span style="color:#f92672">-</span> k], flag[k]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> j <span style="color:#f92672">&lt;</span> (<span style="color:#ae81ff">21</span> <span style="color:#f92672">-</span> j):
</span></span><span style="display:flex;"><span>           flag[j], flag[<span style="color:#ae81ff">21</span> <span style="color:#f92672">-</span> j] <span style="color:#f92672">=</span> flag[<span style="color:#ae81ff">21</span> <span style="color:#f92672">-</span> j], flag[j]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> i <span style="color:#f92672">&lt;</span> (<span style="color:#ae81ff">9</span> <span style="color:#f92672">-</span> i):
</span></span><span style="display:flex;"><span>           flag[i], flag[<span style="color:#ae81ff">9</span> <span style="color:#f92672">-</span> i] <span style="color:#f92672">=</span> flag[<span style="color:#ae81ff">9</span> <span style="color:#f92672">-</span> i], flag[i]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">return</span> flag
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fake_flag <span style="color:#f92672">=</span> [ord(c) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> <span style="color:#e6db74">&#34;W1{live_speels_a5_NoOn_4v4ry_emit!}&#34;</span>]
</span></span><span style="display:flex;"><span>real_flag <span style="color:#f92672">=</span> reverse_lookthis(fake_flag)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(chr(c) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> real_flag)
</span></span><span style="display:flex;"><span>print(flag)
</span></span></code></pre></div><pre><code>Flag: W1{evil_sleeps_a5_NoOn_4v4ry_time!}
</code></pre>
<p> </p>
<h3 id="6-easy-flag-checker">
<a class="header-anchor" href="#6-easy-flag-checker"></a>
6. Easy Flag Checker
</h3><p>Tải file và phiên dịch mã giả bằng IDA, có:</p>
<p><img src="https://hackmd.io/_uploads/S1iYSwI8kg.png" alt="image"></p>
<p>Qua hàm main, chương trình yêu cầu ta nhập một chuỗi 20 ký tự, sau đó thực hiện vòng lặp kiểm tra với mỗi ký tự thứ 4*i+32 XOR với 0x38. Sau đó lấy ký tự đó so sánh ngay với <code>dword_4020</code> thứ i. Chúng ta sẽ truy cập thử vào <code>dword_4020</code>:</p>
<p><img src="https://hackmd.io/_uploads/rkrcrvULJx.png" alt="image"></p>
<p>Ở đây, các giá trị trong <code>unk_4020</code> là các byte đã được mã hóa. Do đó, ta sẽ lấy các giá trị khác 0 để thực hiện phép XOR và nối lại tạo thành flag.</p>
<p>Sau đây là script cho thử thách:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">reverse_lookthis</span>(flag):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">28</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> k <span style="color:#f92672">&lt;</span> (<span style="color:#ae81ff">61</span> <span style="color:#f92672">-</span> k):
</span></span><span style="display:flex;"><span>           flag[k], flag[<span style="color:#ae81ff">61</span> <span style="color:#f92672">-</span> k] <span style="color:#f92672">=</span> flag[<span style="color:#ae81ff">61</span> <span style="color:#f92672">-</span> k], flag[k]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> j <span style="color:#f92672">&lt;</span> (<span style="color:#ae81ff">21</span> <span style="color:#f92672">-</span> j):
</span></span><span style="display:flex;"><span>           flag[j], flag[<span style="color:#ae81ff">21</span> <span style="color:#f92672">-</span> j] <span style="color:#f92672">=</span> flag[<span style="color:#ae81ff">21</span> <span style="color:#f92672">-</span> j], flag[j]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> i <span style="color:#f92672">&lt;</span> (<span style="color:#ae81ff">9</span> <span style="color:#f92672">-</span> i):
</span></span><span style="display:flex;"><span>           flag[i], flag[<span style="color:#ae81ff">9</span> <span style="color:#f92672">-</span> i] <span style="color:#f92672">=</span> flag[<span style="color:#ae81ff">9</span> <span style="color:#f92672">-</span> i], flag[i]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">return</span> flag
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fake_flag <span style="color:#f92672">=</span> [ord(c) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> <span style="color:#e6db74">&#34;W1{live_speels_a5_NoOn_4v4ry_emit!}&#34;</span>]
</span></span><span style="display:flex;"><span>real_flag <span style="color:#f92672">=</span> reverse_lookthis(fake_flag)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(chr(c) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> real_flag)
</span></span><span style="display:flex;"><span>print(flag)
</span></span></code></pre></div><pre><code>Flag: W1{v3ry_34sy_r1gh7?}
</code></pre>
<p> </p>
<h3 id="7-giacmotrua1">
<a class="header-anchor" href="#7-giacmotrua1"></a>
7. GiacMoTrua1
</h3><p>Ta thấy tệp thử thách có định dạng .pyc. Sau khi thử tìm kiếm thì tôi biết được đây là một tệp đầu ra được biên dịch được tạo từ mã nguồn được viết bằng ngôn ngữ lập trình Python. Do đó tôi sử dụng PyLingual – một công cụ online để dịch ngược và khôi phục mã nguồn Python:</p>
<p><img src="https://hackmd.io/_uploads/S1zzUDULkg.png" alt="image"></p>
<p>Tải file python này về, ta nhận được thử thách như sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dic <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">85</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">33</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">36</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">37</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">38</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">41</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">42</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">44</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">45</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">46</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">47</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">48</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">49</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">51</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">52</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">53</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">54</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">55</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">56</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">57</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">58</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">59</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">60</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">61</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">62</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">63</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">64</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">65</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">66</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">67</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">33</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">68</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">34</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">69</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">35</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">70</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">36</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">71</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">37</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">72</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">38</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">73</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">39</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">74</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">40</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">75</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">41</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">76</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">42</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">77</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">43</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">78</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">44</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">79</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">45</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">46</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">81</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">47</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">82</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">48</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">83</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">49</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">84</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">50</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">85</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">51</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">86</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">52</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">87</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">53</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">88</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">54</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">55</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">90</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">56</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">91</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">57</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">97</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">58</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">98</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">59</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">99</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">60</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">61</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">101</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">62</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">102</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">63</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">103</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">104</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">65</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">105</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">66</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">106</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">67</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">107</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">68</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">108</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">69</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">109</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">70</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">110</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">71</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">111</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">72</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">112</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">73</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">113</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">74</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">114</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">75</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">115</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">76</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">116</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">77</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">117</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">78</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">118</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">79</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">119</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">80</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">120</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">81</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">121</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">82</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">122</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">83</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">123</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">84</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">125</span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#34;Let me help you check your flag: &#34;</span>)
</span></span><span style="display:flex;"><span>length <span style="color:#f92672">=</span> len(flag)
</span></span><span style="display:flex;"><span>ans <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> length <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(length):
</span></span><span style="display:flex;"><span>   ans[i] <span style="color:#f92672">=</span> dic[ord(flag[i]) <span style="color:#f92672">^</span> <span style="color:#ae81ff">112</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(length, length <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>   ans[i] <span style="color:#f92672">=</span> ans[i <span style="color:#f92672">-</span> length]
</span></span><span style="display:flex;"><span>fin <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range((<span style="color:#ae81ff">23</span> <span style="color:#f92672">*</span> length <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span>) <span style="color:#f92672">%</span> length, (<span style="color:#ae81ff">23</span> <span style="color:#f92672">*</span> length <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span>) <span style="color:#f92672">%</span> length <span style="color:#f92672">+</span> length):
</span></span><span style="display:flex;"><span>   fin <span style="color:#f92672">+=</span> chr(ans[i])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> fin <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;R8Abq,R&amp;;j%R6;kiiR%hR@k6iy0Ji.[k!8R,kHR*i??&#34;</span>:
</span></span><span style="display:flex;"><span>   print(<span style="color:#e6db74">&#34;Rightttt!&#34;</span>)
</span></span><span style="display:flex;"><span>   print(<span style="color:#e6db74">&#34;Heyy you are really lovely, i promise!&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>   print(<span style="color:#e6db74">&#34;Think more....&#34;</span>)
</span></span></code></pre></div><h4 id="phân-tích-3">
<a class="header-anchor" href="#ph%c3%a2n-t%c3%adch-3"></a>
Phân tích:
</h4><p>Flag được nhập vào và qua một số bước biến đổi trở thành một đoạn mã hóa cho trước là: <code>“R8Abq,R&amp;;j%R6;kiiR%hR@k6iy0Ji.[k!8R,kHR*i??”</code>
Đầu tiên, chúng ta lấy từng giá trị của <code>flag</code> dạng thập phân ở hệ Unicode để XOR với 112 rồi lấy đó làm chỉ số để tra bảng <code>dic</code> và gán vào dãy <code>ans</code>, tiếp theo lấy <code>ans</code> thêm vào sau để tạo thành 1 dãy có độ dài gấp đôi <code>flag</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(length):
</span></span><span style="display:flex;"><span>   ans[i] <span style="color:#f92672">=</span> dic[ord(flag[i]) <span style="color:#f92672">^</span> <span style="color:#ae81ff">112</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(length, length <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>   ans[i] <span style="color:#f92672">=</span> ans[i <span style="color:#f92672">-</span> length]
</span></span></code></pre></div><p>Sau đó lập thành dãy <code>fin</code> mà ta đã biết trước bằng cách lấy i trong khoảng từ <code>(23*length+16)  % length</code> tới <code>(23*length+16)  % length + length</code> và lấy đó làm chỉ số với <code>ans</code> để chuyển nó về dạng Unicode và thêm vào <code>fin</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fin <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range((<span style="color:#ae81ff">23</span> <span style="color:#f92672">*</span> length <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span>) <span style="color:#f92672">%</span> length, (<span style="color:#ae81ff">23</span> <span style="color:#f92672">*</span> length <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span>) <span style="color:#f92672">%</span> length <span style="color:#f92672">+</span> length):
</span></span><span style="display:flex;"><span>    fin <span style="color:#f92672">+=</span> chr(ans[i])
</span></span></code></pre></div><p> </p>
<h4 id="giải-3">
<a class="header-anchor" href="#gi%e1%ba%a3i-3"></a>
Giải:
</h4><p>Nhận thấy, <code>fin</code> có độ dài bằng length và lớn hơn 16 nên:
$23×length+16≡16$ (mod length)</p>
<p>Do đó, <code>ans</code> sẽ được tính từ chỉ số 16 của <code>fin</code> tăng dần và quay ngược lên 15.
Sau đó, ta phải đảo ngược bảng giá trị <code>dic</code> cùng với việc thực hiện phép XOR với 112 để truy ngược lại giá trị ban đầu của flag.</p>
<p>Đây là script cho thử thách:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dic <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">85</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">33</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">36</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">37</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">38</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">41</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">42</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">44</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">45</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">46</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">47</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">48</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">49</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">51</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">52</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">53</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">54</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">55</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">56</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">57</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">58</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">59</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">60</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">61</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">62</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">63</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">64</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">65</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">66</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">67</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">33</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">68</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">34</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">69</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">35</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">70</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">36</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">71</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">37</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">72</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">38</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">73</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">39</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">74</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">40</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">75</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">41</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">76</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">42</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">77</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">43</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">78</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">44</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">79</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">45</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">46</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">81</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">47</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">82</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">48</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">83</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">49</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">84</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">50</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">85</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">51</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">86</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">52</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">87</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">53</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">88</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">54</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">55</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">90</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">56</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">91</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">57</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">97</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">58</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">98</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">59</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">99</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">60</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">61</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">101</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">62</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">102</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">63</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">103</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">104</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">65</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">105</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">66</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">106</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">67</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">107</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">68</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">108</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">69</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">109</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">70</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">110</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">71</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">111</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">72</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">112</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">73</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">113</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">74</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">114</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">75</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">115</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">76</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">116</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">77</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">117</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">78</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">118</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">79</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">119</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">80</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">120</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">81</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">121</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">82</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">122</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">83</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">123</span>
</span></span><span style="display:flex;"><span>dic[<span style="color:#ae81ff">84</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">125</span>
</span></span><span style="display:flex;"><span>fin <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;R8Abq,R&amp;;j%R6;kiiR%hR@k6iy0Ji.[k!8R,kHR*i??&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>length <span style="color:#f92672">=</span> len(fin)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ans <span style="color:#f92672">=</span> [ord(fin[i <span style="color:#f92672">-</span> <span style="color:#ae81ff">16</span>]) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(length)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>reverse_dic <span style="color:#f92672">=</span> {v: i <span style="color:#66d9ef">for</span> i, v <span style="color:#f92672">in</span> enumerate(dic)}
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(chr(reverse_dic[ans[i]] <span style="color:#f92672">^</span> <span style="color:#ae81ff">112</span>) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(length))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(flag)
</span></span></code></pre></div><pre><code>Flag: W1{H3pe_y3U_w1ll_enJ9y_th2s_ch311_s0_m3c1!}
</code></pre>
</div>
    <footer class="article-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/ctf"
        rel="tag"
        >CTF</a
      >
    </li><li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/cryptography"
        rel="tag"
        >CRYPTOGRAPHY</a
      >
    </li><li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/reverse-engineering"
        rel="tag"
        >REVERSE ENGINEERING</a
      >
    </li></ul>
</footer>
  </div><nav
    id="article-nav"
    aria-label="Article navigation"
    data-aos="fade-up"
  ><div class="article-nav-link-wrap left"><img
            data-src="/images/dicectf.png"
            data-sizes="auto"
            alt="DiceCTF 2025"
            class="lazyload"
          /><a
          href="/post/dicectf2025/"
          aria-label="Prev:DiceCTF 2025"
          title="Prev:DiceCTF 2025"
        ></a>
        <div class="article-nav-caption">Prev</div>
        <h3 class="article-nav-title">DiceCTF 2025</h3>
      </div><div class="article-nav-link-wrap right"><img
            data-src="/images/w1cyber.png"
            data-sizes="auto"
            alt="WannaGame Cyber Knight 2025"
            class="lazyload"
          /><a
          href="/post/wannagamecyberknight2025/"
          aria-label="Next:WannaGame Cyber Knight 2025"
          title="Next:WannaGame Cyber Knight 2025"
        ></a>
        <div class="article-nav-caption">Next</div>
        <h3 class="article-nav-title">WannaGame Cyber Knight 2025</h3>
      </div></nav></article></section>
        </div><footer id="footer" aria-label="Site footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info"><div>
      <span class="icon-copyright"></span>2020-2025<span class="footer-info-sep rotate"></span>
      D-Sketon
    </div><div>
        Powered by&nbsp;<a
          href="https://gohugo.io/"
          target="_blank"
          rel="noopener nofollow noreferrer"
          >Hugo</a
        >&nbsp; Theme.<a
          href="https://github.com/D-Sketon/hugo-theme-reimu"
          target="_blank"
          rel="noopener nofollow noreferrer"
          >Reimu</a
        >
      </div><div>
        <span class="icon-brush"
          >&nbsp;23.8k</span
        >
        &nbsp;|&nbsp;
        <span class="icon-coffee">&nbsp;01:57</span>
      </div><div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv"
          >Number of visits&nbsp;<span
            id="busuanzi_value_site_pv"
          ></span
        ></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv"
          >Number of visitors&nbsp;<span
            id="busuanzi_value_site_uv"
          ></span
        ></span>
      </div></div>
</footer>
<div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div><div id="mask" class="hide"></div>
      </div><nav id="mobile-nav" aria-label="Mobile navigation">
  <div class="sidebar-wrap"><div class="sidebar-toc-sidebar"><h3 class="toc-title">Contents</h3>
<div class="sidebar-toc-wrapper toc-div-class">
  <nav id="TableOfContents">
  <ul>
    <li><a href="#pwn">Pwn</a>
      <ul>
        <li><a href="#1-hello-pwner">1. Hello pwner</a></li>
      </ul>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#2-substitution">2. Substitution</a></li>
        <li><a href="#3-hix">3. Hix</a></li>
        <li><a href="#4-dh">4. DH</a></li>
      </ul>
    </li>
    <li><a href="#reverse">Reverse</a>
      <ul>
        <li><a href="#5-giacmotrua2">5. GiacMoTrua2</a></li>
        <li><a href="#6-easy-flag-checker">6. Easy Flag Checker</a></li>
        <li><a href="#7-giacmotrua1">7. GiacMoTrua1</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div></div>
        <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img
    data-src="/avatar/avatar.webp"
    data-sizes="auto"
    alt="D-Sketon"
    class="lazyload"
  />
  <div class="sidebar-author-name">D-Sketon</div>
  <div class="sidebar-description">少女祈祷中...</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div><div class="sidebar-state-number">9</div>
  </div>
  <a class="sidebar-state-category" href="/categories/" aria-label="sidebar-state-category-link">
    <div>Categories</div>
    <div class="sidebar-state-number">
      3
    </div>
  </a>
  <a class="sidebar-state-tag" href="/tags/" aria-label="sidebar-state-tag-link">
    <div>Tags</div>
    <div class="sidebar-state-number">7</div>
  </a>
</div>
<div class="sidebar-social"></div>
<div class="sidebar-menu"><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Home</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Archives</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">About</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/friend"
        aria-label="Friend"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Friend</div>
    </div></div>
</div></div><div class="sidebar-btn-wrapper">
        <div class="sidebar-toc-btn current"></div>
        <div class="sidebar-common-btn"></div>
      </div></nav>
</div><script
    src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"
    integrity="sha384-3gT/vsepWkfz/ff7PpWNUeMzeWoH3cDhm/A8jM7ouoAK0/fP/9bcHHR5kHq2nf&#43;e" crossorigin="anonymous"></script><script
    src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"
    integrity="sha384-J08i8An/QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"></script><script src="/js/main.js" integrity="" crossorigin="anonymous" ></script><script src="/js/aos.js" integrity="" crossorigin="anonymous" ></script><script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", aosInit);
    } else {
      aosInit();
    }
  </script><script src="/js/pjax_main.js" integrity="" crossorigin="anonymous" data-pjax></script><script
    src="https://npm.webcache.cn/mouse-firework@0.1.1/dist/index.umd.js"
    integrity="sha384-8LyaidD9GPxQQgLJO/WRw/O2h3BoNq/ApI/ecpvM6RsrCz2qP2ppBXUKihP4V/2d" crossorigin="anonymous"></script><script>
  if (! false  || !window.matchMedia('(max-width: 768px)').matches) {
    if (window.firework) {
      const options = JSON.parse("{\"excludeelements\":[\"a\",\"button\"],\"particles\":[{\"colors\":[\"var(--red-1)\",\"var(--red-2)\",\"var(--red-3)\",\"var(--red-4)\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"emit\"],\"number\":20,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.3,0.5],\"radius\":[16,32]}},{\"colors\":[\"var(--red-0)\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"diffuse\"],\"number\":1,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.2,0.5],\"lineWidth\":6,\"radius\":20}}]}");
      options.excludeElements = options.excludeelements;
      delete options.excludeelements;
      window.firework(options);
    }
  }
</script>

<div id="lazy-script">
  <div><script data-pjax>
        window.REIMU_POST = {
          author: "D-Sketon",
          title: "WannaGame NMLT",
          url: "https:\/\/r1muru2006.github.io\/post\/wannagamenmlt\/",
          description: "Đây là Write-up giành cho cuộc thi CTFs để lấy điểm Nhập môn lập trình của mình vào năm nhất.",
          cover: "https:\/\/r1muru2006.github.io\/images\/WannaW1n.png",
        };
      </script><script src="/js/insert_highlight.js" integrity="" crossorigin="anonymous" data-pjax></script><script src="/js/tabs.js" integrity="" crossorigin="anonymous" data-pjax></script><script type="module" data-pjax>const PhotoSwipeLightbox = (await safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe-lightbox.esm.min.js", "sha384-DiL6M\/gG\u002bwmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF\/N6lrZi\/")).default;const initPswp = (gallery, children) => {
          if (_$$(`${gallery} ${children}`).length > 0) {
            new PhotoSwipeLightbox({
              gallery,
              children,pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")}).init();
          }
        }
        const pswp = () => {
          initPswp('.article-entry', 'a.article-gallery-item');
          initPswp('.article-gallery', 'a.article-gallery-item');
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script><script
    src="https://npm.webcache.cn/katex@0.16.24/dist/katex.min.js"
    data-pjaxintegrity="sha384-MWNUH0WmtsYGhn2cbH6ELRCbf9LG3QDqCC&#43;gqPB3IBNO35xjZK3Ejb6oONRpDbPg" crossorigin="anonymous"></script><script
    src="https://npm.webcache.cn/katex@0.16.24/dist/contrib/auto-render.min.js"
    data-pjaxintegrity="sha384-hCXGrW6PitJEwbkoStFjeJxv&#43;fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"></script><script data-pjax>
          var renderMath = () => {
            if (!window.renderMathInElement) return;
            window.renderMathInElement(_$("article"), {
              delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "\\[", right: "\\]", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
              ],
            });
          };
          if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", renderMath, { once: true });
          } else {
            renderMath();
          }
        </script></div>
</div><script
    src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js"
    asyncintegrity="sha384-0M75wtSkhjIInv4coYlaJU83&#43;OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id&#43;S" crossorigin="anonymous"></script><script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then((registrations) => {
        for (let registration of registrations) {
          registration.unregister();
        }
      });
    }
  </script><script>
  const reimuCopyright = String.raw`
   ______     ______     __     __    __     __  __    
  /\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
  \ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
   \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
    \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                    
  `;
  console.log(String.raw`%c ${reimuCopyright}`, "color: #ff5252;");
  console.log(
    "%c Theme.Reimu" + " %c https://github.com/D-Sketon/hugo-theme-reimu ",
    "color: white; background: #ff5252; padding:5px 0;",
    "padding:4px;border:1px solid #ff5252;",
  );
</script></body>
</html>
