<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Learning on r1muru's blog</title><link>https://r1muru2006.github.io/categories/learning/</link><description>Recent content from r1muru's blog</description><generator>Hugo</generator><language>en-us</language><managingEditor>cuongchu200@gmail.com (r1muru)</managingEditor><webMaster>cuongchu200@gmail.com (r1muru)</webMaster><copyright>All articles on this blog are licensed under the BY-NC-SA license agreement unless otherwise stated. Please indicate the source when reprinting!</copyright><lastBuildDate>Mon, 15 Sep 2025 20:31:17 +0700</lastBuildDate><atom:link href="https://r1muru2006.github.io/categories/learning/index.xml" rel="self" type="application/rss+xml"/><item><title>Crack Random Modules</title><link>https://r1muru2006.github.io/post/crackrandommodule/</link><pubDate>Mon, 15 Sep 2025 20:31:17 +0700</pubDate><author>cuongchu200@gmail.com (r1muru)</author><guid>https://r1muru2006.github.io/post/crackrandommodule/</guid><description>
<![CDATA[<h1>Crack Random Modules</h1><p>Author: r1muru(cuongchu200@gmail.com)</p>
        
          <p>Khởi động nhẹ nhàng: <a href="https://www.youtube.com/watch?v=-h_rj2-HP2E">How To Predict Random Numbers Generated By Computers</a></p>
<h2 id="1-python">
<a class="header-anchor" href="#1-python"></a>
1. Python
</h2><p>Hàm random của Python sử dụng thuật toán <a href="https://en.wikipedia.org/wiki/Mersenne_Twister">Mersenne Twister</a> - với 624 số nguyên 32 bit làm trạng thái, sau đó cứ mỗi lần xuất ra một số nguyên 32 bit, nó sẽ thay đổi trạng thái.</p>
<h3 id="mersenne-twister">
<a class="header-anchor" href="#mersenne-twister"></a>
Mersenne Twister
</h3><p>Ta sẽ phân tích thuật toán tạo số ngẫu nhiên trong khoảng <code>[0,0xffffffff]</code>: <a href="https://github.com/python/cpython/blob/23362f8c301f72bbf261b56e1af93e8c52f5b6cf/Modules/_randommodule.c">Link</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cm">/* Period parameters -- These are all magic.  Don&#39;t change. */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define N 624
</span></span></span><span class="line"><span class="cl"><span class="cp">#define M 397
</span></span></span><span class="line"><span class="cl"><span class="cp">#define MATRIX_A 0x9908b0dfU    </span><span class="cm">/* constant vector a */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define UPPER_MASK 0x80000000U  </span><span class="cm">/* most significant w-r bits */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define LOWER_MASK 0x7fffffffU  </span><span class="cm">/* least significant r bits */</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">uint32_t</span>
</span></span><span class="line"><span class="cl"><span class="nf">genrand_uint32</span><span class="p">(</span><span class="n">RandomObject</span> <span class="o">*</span><span class="n">self</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint32_t</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="k">const</span> <span class="kt">uint32_t</span> <span class="n">mag01</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0U</span><span class="p">,</span> <span class="n">MATRIX_A</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* mag01[x] = x * MATRIX_A  for x=0,1 */</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint32_t</span> <span class="o">*</span><span class="n">mt</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">mt</span> <span class="o">=</span> <span class="n">self</span><span class="o">-&gt;</span><span class="n">state</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="o">-&gt;</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">N</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* generate N words at one time */</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">kk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="n">kk</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">kk</span><span class="o">&lt;</span><span class="n">N</span><span class="o">-</span><span class="n">M</span><span class="p">;</span><span class="n">kk</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">mt</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="n">ANDUPPER_MASK</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">mt</span><span class="p">[</span><span class="n">kk</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="n">ANDLOWER_MASK</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">mt</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt</span><span class="p">[</span><span class="n">kk</span><span class="o">+</span><span class="n">M</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="n">mag01</span><span class="p">[</span><span class="n">y</span> <span class="n">AND</span> <span class="mh">0x1U</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(;</span><span class="n">kk</span><span class="o">&lt;</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">kk</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">mt</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="n">ANDUPPER_MASK</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">mt</span><span class="p">[</span><span class="n">kk</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="n">ANDLOWER_MASK</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">mt</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt</span><span class="p">[</span><span class="n">kk</span><span class="o">+</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">N</span><span class="p">)]</span> <span class="o">^</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="n">mag01</span><span class="p">[</span><span class="n">y</span> <span class="n">AND</span> <span class="mh">0x1U</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">mt</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="n">ANDUPPER_MASK</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">mt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="n">ANDLOWER_MASK</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">mt</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">mt</span><span class="p">[</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="n">mag01</span><span class="p">[</span><span class="n">y</span> <span class="n">AND</span> <span class="mh">0x1U</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">self</span><span class="o">-&gt;</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="o">=</span> <span class="n">mt</span><span class="p">[</span><span class="n">self</span><span class="o">-&gt;</span><span class="n">index</span><span class="o">++</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="o">^=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="mi">11</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="o">^=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">)</span> <span class="n">AND</span> <span class="mh">0x9d2c5680U</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="o">^=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="mi">15</span><span class="p">)</span> <span class="n">AND</span> <span class="mh">0xefc60000U</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="o">^=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="mi">18</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Nếu <code>index &gt;= N (= 624)</code>, nghĩa là đã dùng hết số trong mảng <code>mt[]</code> và do đó phải tạo lại 624 số tiếp theo. Mảng <code>mt[]</code> được thay đổi bằng quá trình sau:</p>
        
        <hr><p>Published on 2025-09-15 at <a href='https://r1muru2006.github.io/'>r1muru's blog</a>, last modified on 2025-09-15</p>]]></description><category>Learning</category></item></channel></rss>