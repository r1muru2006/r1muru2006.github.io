<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Blog đầu nên mình sẽ lấy giải lần đầu mình chơi cùng team aespaFanClub :3"><title>picoCTF 2025</title><link rel=canonical href=https://r1muru2006.github.io/p/picoctf-2025/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="picoCTF 2025"><meta property='og:description' content="Blog đầu nên mình sẽ lấy giải lần đầu mình chơi cùng team aespaFanClub :3"><meta property='og:url' content='https://r1muru2006.github.io/p/picoctf-2025/'><meta property='og:site_name' content='r1muru'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='CTF'><meta property='article:tag' content='Cryptography'><meta property='article:published_time' content='2025-03-22T13:52:19+07:00'><meta property='article:modified_time' content='2025-03-22T13:52:19+07:00'><meta property='og:image' content='https://r1muru2006.github.io/p/picoctf-2025/picoCTF.png'><meta name=twitter:title content="picoCTF 2025"><meta name=twitter:description content="Blog đầu nên mình sẽ lấy giải lần đầu mình chơi cùng team aespaFanClub :3"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://r1muru2006.github.io/p/picoctf-2025/picoCTF.png'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/r1muru_hu_96d524052e0dfddb.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>r1muru</a></h1><h2 class=site-description>Life is not fair, get used to it!</h2></div></header><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#general>General</a><ol><li><a href=#fantasy-ctf>FANTASY CTF</a></li></ol></li><li><a href=#crypto>Crypto</a><ol><li><a href=#hashcrack>hashcrack</a></li><li><a href=#even-rsa-can-be-broken>EVEN RSA CAN BE BROKEN???</a></li><li><a href=#guess-my-cheese-part-1>Guess My Cheese (Part 1)</a></li><li><a href=#chacha-slide>ChaCha Slide</a></li><li><a href=#guess-my-cheese-part-2>Guess My Cheese (Part 2)</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/picoctf-2025/><img src=/p/picoctf-2025/picoCTF_hu_6903220123d9dbea.png srcset="/p/picoctf-2025/picoCTF_hu_6903220123d9dbea.png 800w, /p/picoctf-2025/picoCTF_hu_34bb482dd4260e35.png 1600w" width=800 height=450 loading=lazy alt="Featured image of post picoCTF 2025"></a></div><div class=article-details><header class=article-category><a href=/categories/ctf-write-up/>CTF Write-Up</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/picoctf-2025/>picoCTF 2025</a></h2><h3 class=article-subtitle>Blog đầu nên mình sẽ lấy giải lần đầu mình chơi cùng team aespaFanClub :3</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 22, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>18 minute read</time></div></footer></div></header><section class=article-content><blockquote><p>Theo cá nhân mình thấy các challenge về crypto của giải phân hóa rõ ràng các mức độ khác nhau</p></blockquote><h2 id=general>General</h2><h3 id=fantasy-ctf>FANTASY CTF</h3><p>Bài này mình nghĩ là chọn hướng nào cũng ra được vì đến cuối cùng sẽ đẩy ra flag :))</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>FANTASY</span> <span class=nx>CTF</span> <span class=nx>SIMULATION</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>The</span> <span class=nx>simulation</span> <span class=nx>begins</span> <span class=k>in</span> <span class=nx>the</span> <span class=kr>private</span> <span class=nx>room</span> <span class=k>of</span> <span class=nx>Eibhilin</span><span class=p>,</span> <span class=nx>a</span> <span class=nx>bright</span><span class=p>,</span> <span class=nx>young</span> <span class=nx>student</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=nx>The</span> <span class=nx>room</span> <span class=nx>is</span> <span class=nx>dimly</span> <span class=nx>lit</span><span class=p>,</span> <span class=kd>with</span> <span class=nx>the</span> <span class=nx>glow</span> <span class=k>of</span> <span class=nx>her</span> <span class=nx>multiple</span> <span class=nx>monitors</span> <span class=nx>casting</span> <span class=nx>an</span>
</span></span><span class=line><span class=cl><span class=nx>electric</span> <span class=nx>blue</span> <span class=nx>hue</span> <span class=nx>on</span> <span class=nx>the</span> <span class=nx>walls</span><span class=p>.</span> <span class=nx>Around</span> <span class=nx>the</span> <span class=nx>room</span> <span class=nx>are</span> <span class=nx>posters</span> <span class=k>of</span> <span class=nx>vintage</span> <span class=nx>movies</span>
</span></span><span class=line><span class=cl><span class=nx>from</span> <span class=nx>the</span> <span class=nx>MCU</span> <span class=err>—</span> <span class=nx>ancient</span> <span class=nx>guardians</span> <span class=nx>from</span> <span class=nx>another</span> <span class=nx>age</span> <span class=nx>staring</span> <span class=nx>down</span> <span class=nx>like</span> <span class=nx>digital</span>
</span></span><span class=line><span class=cl><span class=nx>sentinels</span><span class=p>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>Press</span> <span class=nx>Enter</span> <span class=nx>to</span> <span class=k>continue</span><span class=p>...)</span>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Eibhilin</span> <span class=nx>stretches</span> <span class=nx>back</span> <span class=k>in</span> <span class=nx>her</span> <span class=nx>chair</span><span class=p>,</span> <span class=nx>adjusting</span> <span class=nx>the</span> <span class=nx>holo</span><span class=o>-</span><span class=nx>display</span> <span class=k>of</span> <span class=nx>her</span>
</span></span><span class=line><span class=cl><span class=nx>keyboard</span><span class=p>.</span> <span class=nx>A</span> <span class=nx>soft</span> <span class=nx>hum</span> <span class=k>of</span> <span class=nx>a</span> <span class=nx>nearby</span> <span class=nx>server</span> <span class=nx>fills</span> <span class=nx>the</span> <span class=nx>air</span> <span class=nx>as</span> <span class=nx>her</span> <span class=nx>AI</span> <span class=nx>companion</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=sb>`Nyx`</span><span class=p>,</span> <span class=nx>comes</span> <span class=nx>to</span> <span class=nx>life</span><span class=p>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>Press</span> <span class=nx>Enter</span> <span class=nx>to</span> <span class=k>continue</span><span class=p>...)</span>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;Good evening, Ei,&#34;</span> <span class=nx>Nyx</span> <span class=nx>chirps</span><span class=p>,</span> <span class=s2>&#34;The 3025 edition of picoCTF registration is
</span></span></span><span class=line><span class=cl><span class=s2>open. You asked me to remind so you could try out the competition for the first
</span></span></span><span class=line><span class=cl><span class=s2>time. Do you wish to proceed?&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>Press</span> <span class=nx>Enter</span> <span class=nx>to</span> <span class=k>continue</span><span class=p>...)</span>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Outside</span><span class=p>,</span> <span class=nx>the</span> <span class=nx>city</span> <span class=k>of</span> <span class=nx>Nexalus</span> <span class=nx>glimmers</span> <span class=nx>under</span> <span class=nx>the</span> <span class=nx>stars</span><span class=p>,</span> <span class=nx>but</span> <span class=nx>Eibhilin</span><span class=s1>&#39;s focus
</span></span></span><span class=line><span class=cl><span class=s1>remains entirely on the screen in front of her.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>&#34;Yes, Nyx. Let&#39;</span><span class=nx>s</span> <span class=k>do</span> <span class=nx>it</span><span class=o>!</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Nyx brings up the registration page.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Options:
</span></span></span><span class=line><span class=cl><span class=s2>A) *Register multiple accounts*
</span></span></span><span class=line><span class=cl><span class=s2>B) *Share an account with a friend*
</span></span></span><span class=line><span class=cl><span class=s2>C) *Register a single, private account*
</span></span></span><span class=line><span class=cl><span class=s2>[a/b/c] &gt; A
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Nyx chimes in, &#34;</span><span class=nx>Eibhilin</span><span class=p>,</span> <span class=nx>don</span><span class=s1>&#39;t do that! That&#39;</span><span class=nx>s</span> <span class=nx>been</span> <span class=nx>grounds</span> <span class=k>for</span>
</span></span><span class=line><span class=cl><span class=nx>disqualification</span> <span class=k>for</span> <span class=nx>the</span> <span class=nx>past</span> <span class=mi>1</span><span class=p>,</span><span class=mi>000</span> <span class=nx>years</span><span class=o>!</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nx>Oh</span><span class=p>,</span> <span class=nx>thanks</span> <span class=nx>Nyx</span><span class=p>,</span> <span class=nx>that</span> <span class=nx>was</span> <span class=nx>close</span><span class=o>!</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nx>Ok</span><span class=p>,</span><span class=s2>&#34; Nyx says, &#34;</span><span class=nx>Registering</span> <span class=nx>you</span> <span class=k>for</span> <span class=nx>the</span> <span class=nx>competition</span><span class=p>...</span> <span class=nx>There</span><span class=s1>&#39;s an introductory
</span></span></span><span class=line><span class=cl><span class=s1>audio message, piping to your speakers.&#34;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>&#34;Welcome hacker! You&#39;</span><span class=nx>re</span> <span class=nx>about</span> <span class=nx>to</span> <span class=nx>embark</span> <span class=nx>on</span> <span class=nx>a</span> <span class=nx>journey</span> <span class=nx>that</span> <span class=nx>will</span> <span class=nx>teach</span> <span class=nx>you</span> <span class=nx>many</span>
</span></span><span class=line><span class=cl><span class=nx>esoteric</span> <span class=nx>and</span> <span class=nx>valuable</span> <span class=nx>skills</span><span class=p>.</span> <span class=nx>Our</span> <span class=nx>mission</span> <span class=nx>is</span> <span class=nx>to</span> <span class=nx>guide</span> <span class=nx>you</span> <span class=k>in</span> <span class=nx>the</span> <span class=nx>right</span> <span class=nx>path</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nx>that</span> <span class=nx>you</span> <span class=nx>may</span> <span class=nx>use</span> <span class=nx>these</span> <span class=nx>skills</span> <span class=nx>to</span> <span class=nx>protect</span> <span class=nx>and</span> <span class=nx>defend</span> <span class=nx>and</span> <span class=nx>never</span> <span class=k>for</span> <span class=nx>selfish</span> <span class=nx>gain</span>
</span></span><span class=line><span class=cl><span class=nx>or</span> <span class=nx>deceit</span><span class=p>.</span> <span class=nx>We</span> <span class=nx>hope</span> <span class=nx>you</span> <span class=nx>enjoy</span> <span class=nx>the</span> <span class=nx>challenges</span> <span class=nx>that</span> <span class=nx>our</span> <span class=nx>authors</span> <span class=nx>have</span> <span class=nx>devised</span> <span class=k>this</span>
</span></span><span class=line><span class=cl><span class=nx>year</span><span class=p>.</span> <span class=nx>Always</span> <span class=nx>remember</span><span class=o>:</span> <span class=s1>&#39;With great power, comes great responsibility!&#39;</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Nyx continues, &#34;</span><span class=nx>I</span><span class=s1>&#39;ve gleaned from the Ether that in CTF competitions, it&#39;</span><span class=nx>s</span>
</span></span><span class=line><span class=cl><span class=nx>always</span> <span class=nx>good</span> <span class=nx>to</span> <span class=nx>start</span> <span class=kd>with</span> <span class=nx>the</span> <span class=s1>&#39;sanity&#39;</span> <span class=nx>challenge</span><span class=p>.</span> <span class=nx>It</span> <span class=nx>should</span> <span class=nx>be</span> <span class=nx>the</span> <span class=nx>challenge</span>
</span></span><span class=line><span class=cl><span class=nx>worth</span> <span class=nx>the</span> <span class=nx>least</span> <span class=nx>amount</span> <span class=k>of</span> <span class=nx>points</span><span class=p>.</span> <span class=nx>I</span><span class=s1>&#39;ll pull it up. You&#39;</span><span class=nx>re</span> <span class=nx>looking</span> <span class=k>for</span> <span class=nx>something</span>
</span></span><span class=line><span class=cl><span class=nx>called</span> <span class=nx>the</span> <span class=nx>flag</span><span class=p>.</span> <span class=nx>You</span> <span class=nx>should</span> <span class=nx>know</span> <span class=nx>it</span> <span class=nx>when</span> <span class=nx>you</span> <span class=nx>see</span> <span class=nx>it</span><span class=p>.</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nx>Oh</span> <span class=nx>interesting</span><span class=p>,</span><span class=s2>&#34; Eibhilin says, &#34;</span><span class=nx>It</span> <span class=nx>seems</span> <span class=nx>like</span> <span class=nx>the</span> <span class=nx>sanity</span> <span class=nx>challenge</span> <span class=nx>is</span> <span class=nx>an</span> <span class=nx>old</span>
</span></span><span class=line><span class=cl><span class=nx>school</span> <span class=nx>interactive</span> <span class=nx>fiction</span> <span class=nx>game</span><span class=p>.</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Options:
</span></span></span><span class=line><span class=cl><span class=s2>A) *Play the game*
</span></span></span><span class=line><span class=cl><span class=s2>B) *Search the Ether for the flag*
</span></span></span><span class=line><span class=cl><span class=s2>[a/b] &gt; A
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nx>Good</span> <span class=nx>choice</span><span class=p>,</span> <span class=nx>Ei</span><span class=p>,</span><span class=s2>&#34; Nyx says, &#34;</span><span class=nx>You</span> <span class=nx>never</span> <span class=nx>want</span> <span class=nx>to</span> <span class=nx>share</span> <span class=nx>flags</span> <span class=nx>or</span> <span class=nx>artifact</span>
</span></span><span class=line><span class=cl><span class=nx>downloads</span><span class=p>.</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2> Playing the Game
</span></span></span><span class=line><span class=cl><span class=s2>Playing the Game:   0%|                                           [time left: ?]
</span></span></span><span class=line><span class=cl><span class=s2>Playing the Game: 100%|██████████████████████████████████████ [time left: 00:00]
</span></span></span><span class=line><span class=cl><span class=s2>Playing the Game completed successfully!
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nx>That</span> <span class=nx>was</span> <span class=nx>fun</span><span class=o>!</span><span class=s2>&#34; Eibhilin exclaims, &#34;</span><span class=nx>I</span> <span class=nx>found</span> <span class=nx>the</span> <span class=nx>flag</span><span class=o>!</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Nyx says, &#34;</span><span class=nx>Great</span> <span class=nx>job</span><span class=p>,</span> <span class=nx>Ei</span><span class=o>!</span> <span class=nx>I</span><span class=s1>&#39;ve read that a lot of players create writeups of
</span></span></span><span class=line><span class=cl><span class=s1>interesting challenges they solve during the competition. Just be sure to wait
</span></span></span><span class=line><span class=cl><span class=s1>to publish them until after the winners have been announced. We can work on
</span></span></span><span class=line><span class=cl><span class=s1>that together if you&#39;</span><span class=nx>d</span> <span class=nx>like</span><span class=p>.</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nx>Thanks</span><span class=p>,</span> <span class=nx>Nyx</span><span class=o>!</span> <span class=nx>Here</span><span class=s1>&#39;s the flag I found: picoCTF{m1113n1um_3d1710n_76b680a5}&#34;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>&#34;Great, you just got 10 points!&#34; Nyx exclaims.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>Eibhilin smiles, &#34;I&#39;</span><span class=nx>m</span> <span class=nx>off</span> <span class=nx>to</span> <span class=nx>a</span> <span class=nx>good</span> <span class=nx>start</span><span class=o>!</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Nyx says, &#34;</span><span class=nx>Let</span><span class=err>&#39;</span><span class=nx>s</span> <span class=nx>keep</span> <span class=nx>going</span><span class=o>!</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>Press</span> <span class=nx>Enter</span> <span class=nx>to</span> <span class=k>continue</span><span class=p>...)</span>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>END</span> <span class=nx>OF</span> <span class=nx>FANTASY</span> <span class=nx>CTF</span> <span class=nx>SIMULATION</span>
</span></span><span class=line><span class=cl><span class=nx>Thank</span> <span class=nx>you</span> <span class=k>for</span> <span class=nx>playing</span><span class=o>!</span> <span class=nx>To</span> <span class=nx>reemphasize</span> <span class=nx>some</span> <span class=nx>rules</span> <span class=k>for</span> <span class=k>this</span> <span class=nx>year</span><span class=o>:</span>
</span></span><span class=line><span class=cl><span class=mf>1.</span> <span class=nx>Register</span> <span class=nx>only</span> <span class=nx>one</span> <span class=nx>account</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=nx>Do</span> <span class=nx>not</span> <span class=nx>share</span> <span class=nx>accounts</span><span class=p>,</span> <span class=nx>flags</span> <span class=nx>or</span> <span class=nx>artifact</span> <span class=nx>downloads</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=nx>Wait</span> <span class=nx>to</span> <span class=nx>publish</span> <span class=nx>writeups</span> <span class=nx>publicly</span> <span class=nx>until</span> <span class=nx>after</span> <span class=nx>the</span> <span class=nx>organizers</span> <span class=nx>announce</span> <span class=nx>the</span>
</span></span><span class=line><span class=cl><span class=nx>winners</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=mf>4.</span> <span class=nx>picoCTF</span><span class=p>{</span><span class=nx>m1113n1um_3d1710n_76b680a5</span><span class=p>}</span> <span class=nx>is</span> <span class=nx>a</span> <span class=nx>real</span> <span class=nx>flag</span><span class=o>!</span> <span class=nx>Submit</span> <span class=nx>it</span> <span class=k>for</span> <span class=nx>some</span>
</span></span><span class=line><span class=cl><span class=nx>points</span> <span class=k>in</span> <span class=nx>picoCTF</span> <span class=mi>2025</span><span class=o>!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>Press</span> <span class=nx>Enter</span> <span class=nx>to</span> <span class=k>continue</span><span class=p>...)</span>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>FLag: picoCTF{m1113n1um_3d1710n_76b680a5}
</code></pre><h2 id=crypto>Crypto</h2><h3 id=hashcrack>hashcrack</h3><p>Ở bài này mình dựa vào số bytes của hash và các tools online để tìm ra password, như là: <a class=link href=https://10015.io/tools/md5-encrypt-decrypt target=_blank rel=noopener>MD5</a>, <a class=link href=https://10015.io/tools/sha1-encrypt-decrypt target=_blank rel=noopener>SHA1</a>, <a class=link href=https://10015.io/tools/sha256-encrypt-decrypt target=_blank rel=noopener>SHA256</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Welcome</span><span class=o>!!</span> <span class=nx>Looking</span> <span class=nx>For</span> <span class=nx>the</span> <span class=nx>Secret</span><span class=o>?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>We</span> <span class=nx>have</span> <span class=nx>identified</span> <span class=nx>a</span> <span class=nx>hash</span><span class=o>:</span> <span class=mi>482</span><span class=nx>c811da5d5b4bc6d497ffa98491e38</span> <span class=c1>//md5
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Enter</span> <span class=nx>the</span> <span class=nx>password</span> <span class=k>for</span> <span class=nx>identified</span> <span class=nx>hash</span><span class=o>:</span> <span class=nx>password123</span>
</span></span><span class=line><span class=cl><span class=nx>Correct</span><span class=o>!</span> <span class=nx>You</span><span class=s1>&#39;ve cracked the MD5 hash with no secret found!
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>Flag is yet to be revealed!! Crack this hash: b7a875fc1ea228b9061041b7cec4bd3c52ab3ce3 //sha1
</span></span></span><span class=line><span class=cl><span class=s1>Enter the password for the identified hash: letmein
</span></span></span><span class=line><span class=cl><span class=s1>Correct! You&#39;</span><span class=nx>ve</span> <span class=nx>cracked</span> <span class=nx>the</span> <span class=nx>SHA</span><span class=o>-</span><span class=mi>1</span> <span class=nx>hash</span> <span class=kd>with</span> <span class=nx>no</span> <span class=nx>secret</span> <span class=nx>found</span><span class=o>!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Almost</span> <span class=nx>there</span><span class=o>!!</span> <span class=nx>Crack</span> <span class=k>this</span> <span class=nx>hash</span><span class=o>:</span> <span class=mf>916e8</span><span class=nx>c4f79b25028c9e467f1eb8eee6d6bbdff965f9928310ad30a8d88697745</span> <span class=c1>//sha256
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Enter</span> <span class=nx>the</span> <span class=nx>password</span> <span class=k>for</span> <span class=nx>the</span> <span class=nx>identified</span> <span class=nx>hash</span><span class=o>:</span> <span class=nx>qwerty098</span>
</span></span><span class=line><span class=cl><span class=nx>Correct</span><span class=o>!</span> <span class=nx>You</span><span class=err>&#39;</span><span class=nx>ve</span> <span class=nx>cracked</span> <span class=nx>the</span> <span class=nx>SHA</span><span class=o>-</span><span class=mi>256</span> <span class=nx>hash</span> <span class=kd>with</span> <span class=nx>a</span> <span class=nx>secret</span> <span class=nx>found</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=nx>The</span> <span class=nx>flag</span> <span class=nx>is</span><span class=o>:</span> <span class=nx>picoCTF</span><span class=p>{</span><span class=nx>UseStr0nG_h</span><span class=err>@</span><span class=nx>shEs_</span><span class=o>&amp;</span><span class=nx>PaSswDs</span><span class=o>!</span><span class=nx>_eff9dbe0</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>Flag: picoCTF{UseStr0nG_h@shEs_&amp;PaSswDs!_eff9dbe0}
</code></pre><h3 id=even-rsa-can-be-broken>EVEN RSA CAN BE BROKEN???</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># source.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sys</span> <span class=kn>import</span> <span class=n>exit</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>inverse</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>setup</span> <span class=kn>import</span> <span class=n>get_primes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gen_key</span><span class=p>(</span><span class=n>k</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Generates RSA key with k bits
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=p>,</span><span class=n>q</span> <span class=o>=</span> <span class=n>get_primes</span><span class=p>(</span><span class=n>k</span><span class=o>//</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=n>p</span><span class=o>*</span><span class=n>q</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=p>(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>q</span><span class=o>-</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>((</span><span class=n>N</span><span class=p>,</span><span class=n>e</span><span class=p>),</span> <span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encrypt</span><span class=p>(</span><span class=n>pubkey</span><span class=p>,</span> <span class=n>m</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span><span class=p>,</span><span class=n>e</span> <span class=o>=</span> <span class=n>pubkey</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>pow</span><span class=p>(</span><span class=n>bytes_to_long</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)),</span> <span class=n>e</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>(</span><span class=n>flag</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>pubkey</span><span class=p>,</span> <span class=n>_privkey</span> <span class=o>=</span> <span class=n>gen_key</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>encrypted</span> <span class=o>=</span> <span class=n>encrypt</span><span class=p>(</span><span class=n>pubkey</span><span class=p>,</span> <span class=n>flag</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>pubkey</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>encrypted</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=n>flag</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span><span class=p>,</span> <span class=n>cypher</span>  <span class=o>=</span> <span class=n>main</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;N:&#34;</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;e:&#34;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;cyphertext:&#34;</span><span class=p>,</span> <span class=n>cypher</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>Mở kênh kết nối thì ta nhận được <code>N, e, cipher</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=mi>14971332928931600258070222525511394212054658902871612141186429243227295047197174853004285765481866838784351475089613251384629214373054886098787783629288854</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=mi>9685487452310081650666414304396053822632884035194331224959800780976444606689190315693089108703603608391361578584998640257817456167504699460118188426557775</span>
</span></span></code></pre></td></tr></table></div></div><p>Đoạn này mình thấy sai sai vì N chẵn làm mình nghĩ sao bài này nó dễ vậy được và đúng là nó dễ thật @@</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Lấy từ (nc verbal-sleep.picoctf.net 51510)</span>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=mi>14971332928931600258070222525511394212054658902871612141186429243227295047197174853004285765481866838784351475089613251384629214373054886098787783629288854</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=mi>9685487452310081650666414304396053822632884035194331224959800780976444606689190315693089108703603608391361578584998640257817456167504699460118188426557775</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=n>N</span> <span class=o>//</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>q</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>phi</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=nb>pow</span><span class=p>(</span><span class=n>cipher</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>N</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>Flag: picoCTF{tw0_1$_pr!m3625a858b}
</code></pre><h3 id=guess-my-cheese-part-1>Guess My Cheese (Part 1)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=o>*******************************************</span>
</span></span><span class=line><span class=cl><span class=o>***</span>             <span class=nx>Part</span> <span class=mi>1</span>                  <span class=o>***</span>
</span></span><span class=line><span class=cl><span class=o>***</span>    <span class=nx>The</span> <span class=nx>Mystery</span> <span class=k>of</span> <span class=nx>the</span> <span class=nx>CLONED</span> <span class=nx>RAT</span>    <span class=o>***</span>
</span></span><span class=line><span class=cl><span class=o>*******************************************</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>The</span> <span class=kr>super</span> <span class=nx>evil</span> <span class=nx>Dr</span><span class=p>.</span> <span class=nx>Lacktoes</span> <span class=nx>Inn</span> <span class=nx>Tolerant</span> <span class=nx>told</span> <span class=nx>me</span> <span class=nx>he</span> <span class=nx>kidnapped</span> <span class=nx>my</span> <span class=nx>best</span> <span class=nx>friend</span><span class=p>,</span> <span class=nx>Squeexy</span><span class=p>,</span> <span class=nx>and</span> <span class=nx>replaced</span> <span class=nx>him</span> <span class=kd>with</span> <span class=nx>an</span> <span class=nx>evil</span> <span class=nx>clone</span><span class=o>!</span> <span class=nx>You</span> <span class=nx>look</span> <span class=nx>JUST</span> <span class=nx>LIKE</span> <span class=nx>SQUEEXY</span><span class=p>,</span> <span class=nx>but</span> <span class=nx>I</span><span class=s1>&#39;m not sure if you&#39;</span><span class=nx>re</span> <span class=nx>him</span> <span class=nx>or</span> <span class=nx>THE</span> <span class=nx>CLONE</span><span class=p>.</span> <span class=nx>I</span><span class=s1>&#39;ve devised a plan to find out if YOU&#39;</span><span class=nx>RE</span> <span class=nx>the</span> <span class=nx>REAL</span> <span class=nx>SQUEEXY</span><span class=o>!</span> <span class=nx>If</span> <span class=nx>you</span><span class=s1>&#39;re Squeexy, I&#39;</span><span class=nx>ll</span> <span class=nx>give</span> <span class=nx>you</span> <span class=nx>the</span> <span class=nx>key</span> <span class=nx>to</span> <span class=nx>the</span> <span class=nx>cloning</span> <span class=nx>room</span> <span class=nx>so</span> <span class=nx>you</span> <span class=nx>can</span> <span class=nx>maul</span> <span class=nx>the</span> <span class=nx>imposter</span><span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Here</span><span class=s1>&#39;s my secret cheese -- if you&#39;</span><span class=nx>re</span> <span class=nx>Squeexy</span><span class=p>,</span> <span class=nx>you</span><span class=s1>&#39;ll be able to guess it:  LRGGHOZMFOVPB
</span></span></span><span class=line><span class=cl><span class=s1>Hint: The cheeses are top secret and limited edition, so they might look different from cheeses you&#39;</span><span class=nx>re</span> <span class=nx>used</span> <span class=nx>to</span><span class=o>!</span>
</span></span><span class=line><span class=cl><span class=nx>Commands</span><span class=o>:</span> <span class=p>(</span><span class=nx>g</span><span class=p>)</span><span class=nx>uess</span> <span class=nx>my</span> <span class=nx>cheese</span> <span class=nx>or</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span><span class=nx>ncrypt</span> <span class=nx>a</span> <span class=nx>cheese</span>
</span></span><span class=line><span class=cl><span class=nx>What</span> <span class=nx>would</span> <span class=nx>you</span> <span class=nx>like</span> <span class=nx>to</span> <span class=k>do</span><span class=o>?</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>Hint: Remember that cipher we devised together Squeexy? The one that incorporates your affinity for linear equations
</code></pre><p>Thử thách nhắc tới phương trình tuyến tính và <code>affinity</code> nên mình đã google xem thử nó nói về cái gì và đây là kết quả: <a class=link href=https://en.wikipedia.org/wiki/Affine_transformation target=_blank rel=noopener>Affine transformation</a></p><p>Bản đồ affine $f$ tác dụng lên $x$ được biểu diển dưới dạng: $y \equiv f(x)=ax+b$ (mod m).</p><p>Khi áp dụng vào mã hóa thì $y$ là bản mã (Ciphertext), còn $x$ là bản rõ (Plaintext). Nghĩa là:</p><ul><li>Khi mã hóa: $C\equiv aP+b$ (mod m)</li><li>Khi giải mã: $P=a^{-1}(C-b)$ (mod m)</li></ul><p>Ở đây, ta thấy nó được mã hóa theo từng chữ cái trên bảng Latinh nên $m$ sẽ là số lượng chữ cái và hơn nữa để giải mã được thì phải tồn tại nghịch đảo modulo $m$ của $a$.</p><p>Và để làm được điều đó thì $m, a$ phải đôi một nguyên tố cùng nhau. Xem thêm ở <a class=link href=https://wiki.vnoi.info/algo/math/modular-inverse target=_blank rel=noopener>đây</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>possible_a</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span> <span class=k>if</span> <span class=n>gcd</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>Vì chỉ xét tới chữ cái in hoa nên ta sẽ lấy $M=26$.
Ở đây, thử thách cho mình 2 quyền đoán cheese đưa ra và mã hóa 1 cheese nào đó.
Để mà đoán được cheese thì ta cần hệ số $a, b$ và từ đó giải mã ra bản rõ. Do đó, mình sẽ mã hóa 1 cheese nào đó trước rồi đối chiếu và lấy $a, b$ và giải mã để lấy flag.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>What</span> <span class=nx>would</span> <span class=nx>you</span> <span class=nx>like</span> <span class=nx>to</span> <span class=k>do</span><span class=o>?</span>
</span></span><span class=line><span class=cl><span class=nx>e</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>What</span> <span class=nx>cheese</span> <span class=nx>would</span> <span class=nx>you</span> <span class=nx>like</span> <span class=nx>to</span> <span class=nx>encrypt</span><span class=o>?</span> <span class=nx>Cottage</span> <span class=nx>cheese</span>
</span></span><span class=line><span class=cl><span class=nx>Here</span><span class=err>&#39;</span><span class=nx>s</span> <span class=nx>your</span> <span class=nx>encrypted</span> <span class=nx>cheese</span><span class=o>:</span>  <span class=nx>JFMMBZRMJQRRVR</span>
</span></span><span class=line><span class=cl><span class=nx>Not</span> <span class=nx>sure</span> <span class=nx>why</span> <span class=nx>you</span> <span class=nx>want</span> <span class=nx>it</span> <span class=nx>though</span><span class=p>...</span><span class=o>*</span><span class=nx>squeak</span><span class=o>*</span> <span class=o>-</span> <span class=nx>oh</span> <span class=nx>well</span><span class=o>!</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># solution.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>string</span> <span class=kn>import</span> <span class=n>ascii_uppercase</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>GCD</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bảng chữ cái</span>
</span></span><span class=line><span class=cl><span class=n>ALPHABET</span> <span class=o>=</span> <span class=n>ascii_uppercase</span>
</span></span><span class=line><span class=cl><span class=n>M</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>ALPHABET</span><span class=p>)</span>  <span class=c1># M = 26</span>
</span></span><span class=line><span class=cl><span class=n>possible_a</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span> <span class=k>if</span> <span class=n>GCD</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>affine_decrypt</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>a_inv</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plaintext</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>ciphertext</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>C</span> <span class=o>=</span> <span class=n>ALPHABET</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>char</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>P</span> <span class=o>=</span> <span class=p>(</span><span class=n>a_inv</span> <span class=o>*</span> <span class=p>(</span><span class=n>C</span> <span class=o>-</span> <span class=n>b</span><span class=p>))</span> <span class=o>%</span> <span class=n>M</span>
</span></span><span class=line><span class=cl>        <span class=n>plaintext</span> <span class=o>+=</span> <span class=n>ALPHABET</span><span class=p>[</span><span class=n>P</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>plaintext</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mẫu ban đầu với Cottage Cheese</span>
</span></span><span class=line><span class=cl><span class=n>cipher_pattern</span> <span class=o>=</span> <span class=s2>&#34;JFMMBZRMJQRRVR&#34;</span>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=s2>&#34;LRGGHOZMFOVPB&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>found</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>possible_a</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>M</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>decrypted</span> <span class=o>=</span> <span class=n>affine_decrypt</span><span class=p>(</span><span class=n>cipher_pattern</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s1>&#39;COTTAGE&#39;</span> <span class=ow>in</span> <span class=n>decrypted</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>found</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>found</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cheese</span> <span class=o>=</span> <span class=n>affine_decrypt</span><span class=p>(</span><span class=n>cipher</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>cheese</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># WELLINGTONSKA</span>
</span></span></code></pre></td></tr></table></div></div><p>Nhập cheese vào guess và ta lấy được flag</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>I</span> <span class=nx>don</span><span class=s1>&#39;t wanna talk to you too much if you&#39;</span><span class=nx>re</span> <span class=nx>some</span> <span class=nx>suspicious</span> <span class=nx>character</span> <span class=nx>and</span> <span class=nx>not</span> <span class=nx>my</span> <span class=nx>BFF</span> <span class=nx>Squeexy</span><span class=o>!</span>
</span></span><span class=line><span class=cl><span class=nx>You</span> <span class=nx>have</span> <span class=mi>2</span> <span class=nx>more</span> <span class=nx>chances</span> <span class=nx>to</span> <span class=nx>prove</span> <span class=nx>yourself</span> <span class=nx>to</span> <span class=nx>me</span><span class=o>!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Commands</span><span class=o>:</span> <span class=p>(</span><span class=nx>g</span><span class=p>)</span><span class=nx>uess</span> <span class=nx>my</span> <span class=nx>cheese</span> <span class=nx>or</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span><span class=nx>ncrypt</span> <span class=nx>a</span> <span class=nx>cheese</span>
</span></span><span class=line><span class=cl><span class=nx>What</span> <span class=nx>would</span> <span class=nx>you</span> <span class=nx>like</span> <span class=nx>to</span> <span class=k>do</span><span class=o>?</span>
</span></span><span class=line><span class=cl><span class=nx>g</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=nx>_</span>   <span class=nx>_</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nx>q</span><span class=err>\</span><span class=nx>_</span><span class=o>/</span><span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>/</span><span class=p>.</span> <span class=p>.</span><span class=err>\</span><span class=p>.</span><span class=o>-</span><span class=p>.....</span><span class=o>-</span><span class=p>.</span>     <span class=nx>___</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=o>=</span><span class=err>\</span><span class=nx>_t_</span><span class=o>/=</span>     <span class=err>/  `\  (</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span><span class=err>\</span> <span class=p>))</span><span class=nx>__</span> <span class=nx>__</span><span class=err>\</span>   <span class=o>|</span><span class=nx>___</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=sr>/-(/</span><span class=sb>`  `</span><span class=nx>nn</span><span class=o>---</span><span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>SQUEAK SQUEAK SQUEAK
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>         _   _
</span></span></span><span class=line><span class=cl><span class=s1>        (q\_/p)
</span></span></span><span class=line><span class=cl><span class=s1>         /. .\
</span></span></span><span class=line><span class=cl><span class=s1>  ,__   =\_t_/=
</span></span></span><span class=line><span class=cl><span class=s1>     )   /   \
</span></span></span><span class=line><span class=cl><span class=s1>    (   ((   ))
</span></span></span><span class=line><span class=cl><span class=s1>     \  /\) (/\
</span></span></span><span class=line><span class=cl><span class=s1>      `-\  Y  /
</span></span></span><span class=line><span class=cl><span class=s1>         nn^nn
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>Is that you, Squeexy? Are you ready to GUESS...MY...CHEEEEEEESE?
</span></span></span><span class=line><span class=cl><span class=s1>Remember, this is my encrypted cheese:  LRGGHOZMFOVPB
</span></span></span><span class=line><span class=cl><span class=s1>So...what&#39;</span><span class=nx>s</span> <span class=nx>my</span> <span class=nx>cheese</span><span class=o>?</span>
</span></span><span class=line><span class=cl><span class=nx>WELLINGTONSKA</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=nx>_</span>   <span class=nx>_</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nx>q</span><span class=err>\</span><span class=nx>_</span><span class=o>/</span><span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=o>/</span><span class=p>.</span> <span class=p>.</span><span class=err>\</span>         <span class=nx>__</span>
</span></span><span class=line><span class=cl>  <span class=p>,</span><span class=nx>__</span>   <span class=o>=</span><span class=err>\</span><span class=nx>_t_</span><span class=o>/=</span>      <span class=p>.</span><span class=s1>&#39;o O&#39;</span><span class=o>-</span><span class=p>.</span>
</span></span><span class=line><span class=cl>     <span class=p>)</span>   <span class=o>/</span>   <span class=err>\</span>      <span class=o>/</span> <span class=nx>O</span> <span class=nx>o_</span><span class=p>.</span><span class=o>-</span><span class=sb>`|
</span></span></span><span class=line><span class=cl><span class=sb>    (   ((   ))    /O_.-&#39;  O |
</span></span></span><span class=line><span class=cl><span class=sb>     \  /\) (/\    | o   o  o|
</span></span></span><span class=line><span class=cl><span class=sb>      `</span><span class=o>-</span><span class=err>\</span>  <span class=nx>Y</span>  <span class=o>/</span>    <span class=o>|</span><span class=nx>o</span>   <span class=nx>o</span> <span class=nx>O</span><span class=p>.</span><span class=o>-</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>         nn^nn     | O _.-&#39;
</span></span></span><span class=line><span class=cl><span class=sb>                   &#39;--`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>munch</span><span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=nx>_</span>   <span class=nx>_</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nx>q</span><span class=err>\</span><span class=nx>_</span><span class=o>/</span><span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=o>/</span><span class=p>.</span> <span class=p>.</span><span class=err>\</span>         <span class=nx>__</span>
</span></span><span class=line><span class=cl>  <span class=p>,</span><span class=nx>__</span>   <span class=o>=</span><span class=err>\</span><span class=nx>_t_</span><span class=o>/=</span>      <span class=p>.</span><span class=s1>&#39;o O&#39;</span><span class=o>-</span><span class=p>.</span>
</span></span><span class=line><span class=cl>     <span class=p>)</span>   <span class=o>/</span>   <span class=err>\</span>      <span class=o>/</span> <span class=nx>O</span> <span class=nx>o_</span><span class=p>.</span><span class=o>-</span><span class=sb>`|
</span></span></span><span class=line><span class=cl><span class=sb>    (   ((   ))      ).-&#39;  O |
</span></span></span><span class=line><span class=cl><span class=sb>     \  /\) (/\      )   o  o|
</span></span></span><span class=line><span class=cl><span class=sb>      `</span><span class=o>-</span><span class=err>\</span>  <span class=nx>Y</span>  <span class=o>/</span>    <span class=o>|</span><span class=nx>o</span>   <span class=nx>o</span> <span class=nx>O</span><span class=p>.</span><span class=o>-</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>         nn^nn     | O _.-&#39;
</span></span></span><span class=line><span class=cl><span class=sb>                   &#39;--`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>munch</span><span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=nx>_</span>   <span class=nx>_</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nx>q</span><span class=err>\</span><span class=nx>_</span><span class=o>/</span><span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=o>/</span><span class=p>.</span> <span class=p>.</span><span class=err>\</span>         <span class=nx>__</span>
</span></span><span class=line><span class=cl>  <span class=p>,</span><span class=nx>__</span>   <span class=o>=</span><span class=err>\</span><span class=nx>_t_</span><span class=o>/=</span>      <span class=p>.</span><span class=s1>&#39;o O&#39;</span><span class=o>-</span><span class=p>.</span>
</span></span><span class=line><span class=cl>     <span class=p>)</span>   <span class=o>/</span>   <span class=err>\</span>      <span class=o>/</span> <span class=nx>O</span> <span class=nx>o_</span><span class=p>.</span><span class=o>-</span><span class=sb>`|
</span></span></span><span class=line><span class=cl><span class=sb>    (   ((   ))        )&#39;  O |
</span></span></span><span class=line><span class=cl><span class=sb>     \  /\) (/\          )  o|
</span></span></span><span class=line><span class=cl><span class=sb>      `</span><span class=o>-</span><span class=err>\</span>  <span class=nx>Y</span>  <span class=o>/</span>         <span class=p>)</span> <span class=nx>O</span><span class=p>.</span><span class=o>-</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>         nn^nn        ) _.-&#39;
</span></span></span><span class=line><span class=cl><span class=sb>                   &#39;--`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>MUNCH</span><span class=p>.............</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>YUM</span><span class=o>!</span> <span class=nx>MMMMmmmmMMMMmmmMMM</span><span class=o>!!!</span> <span class=nx>Yes</span><span class=p>...</span><span class=nx>yesssss</span><span class=o>!</span> <span class=nx>That</span><span class=s1>&#39;s my cheese!
</span></span></span><span class=line><span class=cl><span class=s1>Here&#39;</span><span class=nx>s</span> <span class=nx>the</span> <span class=nx>password</span> <span class=nx>to</span> <span class=nx>the</span> <span class=nx>cloning</span> <span class=nx>room</span><span class=o>:</span>  <span class=nx>picoCTF</span><span class=p>{</span><span class=nx>ChEeSy033d0004</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>Flag: picoCTF{ChEeSy033d0004}
</code></pre><h3 id=chacha-slide>ChaCha Slide</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># challenge.py</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>secrets</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>ChaCha20_Poly1305</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;flag.txt&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>shasum</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=n>shasum</span><span class=p>(</span><span class=n>shasum</span><span class=p>(</span><span class=n>secrets</span><span class=o>.</span><span class=n>token_bytes</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span> <span class=o>+</span> <span class=n>flag</span><span class=o>.</span><span class=n>encode</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Generate a random nonce to be extra safe</span>
</span></span><span class=line><span class=cl><span class=n>nonce</span> <span class=o>=</span> <span class=n>secrets</span><span class=o>.</span><span class=n>token_bytes</span><span class=p>(</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>messages</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Did you know that ChaCha20-Poly1305 is an authenticated encryption algorithm?&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;That means it protects both the confidentiality and integrity of data!&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>goal</span> <span class=o>=</span> <span class=s2>&#34;But it&#39;s only secure if used correctly!&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encrypt</span><span class=p>(</span><span class=n>message</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>cipher</span> <span class=o>=</span> <span class=n>ChaCha20_Poly1305</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=n>key</span><span class=p>,</span> <span class=n>nonce</span><span class=o>=</span><span class=n>nonce</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext</span><span class=p>,</span> <span class=n>tag</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>encrypt_and_digest</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ciphertext</span> <span class=o>+</span> <span class=n>tag</span> <span class=o>+</span> <span class=n>nonce</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>message_enc</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext</span> <span class=o>=</span> <span class=n>message_enc</span><span class=p>[:</span><span class=o>-</span><span class=mi>28</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>tag</span> <span class=o>=</span> <span class=n>message_enc</span><span class=p>[</span><span class=o>-</span><span class=mi>28</span><span class=p>:</span><span class=o>-</span><span class=mi>12</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>nonce</span> <span class=o>=</span> <span class=n>message_enc</span><span class=p>[</span><span class=o>-</span><span class=mi>12</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=n>cipher</span> <span class=o>=</span> <span class=n>ChaCha20_Poly1305</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=n>key</span><span class=p>,</span> <span class=n>nonce</span><span class=o>=</span><span class=n>nonce</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plaintext</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt_and_verify</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>,</span> <span class=n>tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>plaintext</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>message</span> <span class=ow>in</span> <span class=n>messages</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Plaintext: &#34;</span> <span class=o>+</span> <span class=nb>repr</span><span class=p>(</span><span class=n>message</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>message</span> <span class=o>=</span> <span class=n>message</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Plaintext (hex): &#34;</span> <span class=o>+</span> <span class=n>message</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext</span> <span class=o>=</span> <span class=n>encrypt</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Ciphertext (hex): &#34;</span> <span class=o>+</span> <span class=n>ciphertext</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>user</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;What is your message? &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>user_message</span> <span class=o>=</span> <span class=n>decrypt</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;User message (decrypted): &#34;</span> <span class=o>+</span> <span class=nb>repr</span><span class=p>(</span><span class=n>user_message</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>goal</span> <span class=ow>in</span> <span class=nb>repr</span><span class=p>(</span><span class=n>user_message</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Kết nối với kênh, ta được đoạn tin sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Plaintext</span><span class=o>:</span> <span class=s1>&#39;Did you know that ChaCha20-Poly1305 is an authenticated encryption algorithm?&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>Plaintext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>44696420796</span><span class=nx>f75206b6e6f7720746861742043686143686132302d506f6c793133303520697320616e2061757468656e7469636174656420656e6372797074696f6e20616c676f726974686d3f</span>
</span></span><span class=line><span class=cl><span class=nx>Ciphertext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>7</span><span class=nx>cb5f2e754caea3d3d98048ee7d747c1b677b5ac33a000d74c86b68f7f25a955db62e0a8fd17b0235cfc0541a7f8edf105a5d1ab6a6489cfacb7e4061f5b1c8f4f04e9624220e4cb450bae1e13da93a564ed04959dbde00eb0e72b772fb4a5a47457ad46b48a03432d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Plaintext</span><span class=o>:</span> <span class=s1>&#39;That means it protects both the confidentiality and integrity of data!&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>Plaintext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>54686174206</span><span class=nx>d65616e732069742070726f746563747320626f74682074686520636f6e666964656e7469616c69747920616e6420696e74656772697479206f66206461746121</span>
</span></span><span class=line><span class=cl><span class=nx>Ciphertext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>6</span><span class=nx>cb4f7b30dc8fa7c38854b90b3835fd2ad2393a7269048d411c2f3ff6421b5448b3dbbeefd00f52c46b50558bae4f1bf10a2d6ea776f998aaeabee001f0b0780000ea8774f66f3102a46013366d9ab4b0cf5b4320020b4a5a47457ad46b48a03432d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>What</span> <span class=nx>is</span> <span class=nx>your</span> <span class=nx>message</span><span class=o>?</span>
</span></span></code></pre></td></tr></table></div></div><p>Sơ lược lại thì thử thách nói về hệ mã dòng có xác thực ChaCha20 - Poly1305.
Rõ hơn thì đề cho ta hai đoạn tin nhắn và bản mã của chúng, yêu cầu ta gửi tới bản mã của goal được cho để nhận về flag của chall.</p><p>Để gửi được đúng bản mã của goal, ta phải tìm được 3 phần gồm: <code>ciphertext, tag, nonce</code>. Đơn giản với <code>nonce</code> vì nó đã trùng với cái của 2 ciphertext mẫu có sẵn. Còn <code>ciphertext</code> thì liên quan tới phần mã hóa của Chacha20, <code>tag</code> liên quan tới phần xác thực của Poly1305</p><p>Vì vậy, ta chia ChaCha20 - Poly1305 thành hai phần để phân tích và tấn công:</p><ol><li>Về Chacha20:</li></ol><p>Phương thức này sử dụng mã hóa XOR với <code>keystream</code> là XOR key.</p><p>Nghĩa là: Ciphertext = Plaintext $\oplus$ Keystream</p><p>$\Leftrightarrow$ Ciphertext $\oplus$ Plaintext = Plaintext $\oplus$ Keystream $\oplus$ Plaintext = Keystream</p><p>Và khi mà ta đã biết cái plaintext ở goal rồi thì việc giải mã sẽ đơn giản bằng <strong>known-plaintext attack</strong> như sau: goal_ct = goal $\oplus$ Keystream = goal $\oplus$ Ciphertext $\oplus$ Plaintext</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>ciphertext</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=n>c1</span> <span class=o>^</span> <span class=n>p1</span> <span class=o>^</span> <span class=n>p2</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>c1</span><span class=p>,</span> <span class=n>p1</span><span class=p>,</span> <span class=n>p2</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>ciphertext1</span><span class=p>,</span> <span class=n>plaintext1</span><span class=p>,</span> <span class=n>goal</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>  <span class=c1># vì độ dài goal nhỏ hơn ciphertext1 nên keystream sẽ chạy hết được goal</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>Poly1305:</li></ol><p>Phần này mới thực sự là phức tạp của thử thách, với mục đích chính là tìm cái <code>tag</code> để server check xem có đúng không.
Sau khi google thì ta biết được rằng Poly1305 được dùng như mã xác thực một lần với:</p>$$
tag \equiv Poly1305_r(m)+s \mod 2^{128}
$$<p>Đề cho ta 2 tag của 2 tin nhắn phân biệt mà ta đã biết và được dùng cùng 1 Poly1305 key bí mật (r,s). Bây giờ, chúng ta phải tìm lại key này để giải mã được cấu trúc tạo tag.</p><p>Và ở <a class=link href=https://en.wikipedia.org/wiki/Poly1305#Use_as_a_one-time_authenticator target=_blank rel=noopener>đây</a> cũng có để cách attack nếu sử dụng 2 lần để mã hóa tin nhắn bằng 1 key.</p>$$
tag_1 = (Poly1305_r(m_1) + s )\mod 2^{128} \ (1)
$$$$
tag_2 = (Poly1305_r(mg_2) + s )\mod 2^{128} \ (2)
$$<p>Từ (1) và (2), ta có:</p>$$
tag_1 - tag_2 \equiv Poly1305_r(m_1)- Poly1305_r(m_2) \mod 2^{128}
$$<p>Mình xem ở <a class=link href=https://en.wikipedia.org/wiki/Poly1305#Definition_of_Poly1305 target=_blank rel=noopener>đây</a> để phân tích cái Poly1305 ra:</p>$$
tag_1 - tag_2 \equiv (c_1^1r^q+c_1^2r^{q-1}+...+c_1^qr^1\mod 2^{130} -5)
$$$$
-(c_2^1r^q+c_2^2r^{q-1}+...+c_2^qr^1\mod 2^{130} -5) \mod 2^{128}
$$$$
\Leftrightarrow tag_1 - tag_2 + 2^{128}(i-j) \equiv (((c_1^1-c_2^1)r^q+(c_1^2-c_2^2)r^{q-1}+...+(c_1^q-c_2^q)r^1) \mod 2^{130} -5)
$$<p>Vì <code>tag</code> ban đầu mod 1 giá trị bằng $2^{130} - 5$, gần bằng 130 bits rồi mod $2^{128}$ nghĩa là <code>tag</code> mất 2 bits nên $i,j \in \overline{0,4} \Rightarrow (i-j)\in \overline{-4,4}$.</p><p>Đặt $k = i-j$ thì với mỗi k, ta sẽ dựng 1 phương trình trên GF($2^{130}-5$), tìm nghiệm của phương trình này và nó là <code>r</code> rồi thế lại vào 1 trong hai phương trình trên là ta ra được <code>s</code></p><p>Khi đã có được <code>r, s</code> đối với cặp <code>(key, nonce)</code> này rồi thì ta hoàn toàn có thể tạo 1 cái <code>tag</code> xác thực được cho ciphertext của goal và đây cũng là cách mình thực hiện thử thách này.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># solution.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span><span class=p>,</span> <span class=n>unpad</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sage.all</span> <span class=k>as</span> <span class=nn>sage</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;activist-birds.picoctf.net&#34;</span><span class=p>,</span> <span class=mi>59584</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plaintext1</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=sa>b</span><span class=s2>&#34;Did you know that ChaCha20-Poly1305 is an authenticated encryption algorithm?&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>data</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;Ciphertext (hex): &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>message_enc</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1># lấy từ ciphertext của plaintext từ server</span>
</span></span><span class=line><span class=cl>    <span class=n>message_enc</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>message_enc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext</span> <span class=o>=</span> <span class=n>message_enc</span><span class=p>[:</span><span class=o>-</span><span class=mi>28</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>tag</span> <span class=o>=</span> <span class=n>message_enc</span><span class=p>[</span><span class=o>-</span><span class=mi>28</span><span class=p>:</span><span class=o>-</span><span class=mi>12</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>nonce</span> <span class=o>=</span> <span class=n>message_enc</span><span class=p>[</span><span class=o>-</span><span class=mi>12</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ciphertext</span><span class=p>,</span> <span class=n>tag</span><span class=p>,</span> <span class=n>nonce</span>
</span></span><span class=line><span class=cl><span class=n>ciphertext1</span><span class=p>,</span> <span class=n>tag1</span><span class=p>,</span> <span class=n>nonce</span> <span class=o>=</span> <span class=n>data</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ciphertext2</span><span class=p>,</span> <span class=n>tag2</span><span class=p>,</span> <span class=n>nonce</span> <span class=o>=</span> <span class=n>data</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>goal</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;But it&#39;s only secure if used correctly!&#34;</span>
</span></span><span class=line><span class=cl><span class=n>ciphertext</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=n>c1</span> <span class=o>^</span> <span class=n>p1</span> <span class=o>^</span> <span class=n>p2</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>c1</span><span class=p>,</span> <span class=n>p1</span><span class=p>,</span> <span class=n>p2</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>ciphertext1</span><span class=p>,</span> <span class=n>plaintext1</span><span class=p>,</span> <span class=n>goal</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>  <span class=c1># vì độ dài goal nhỏ hơn ciphertext1 nên keystream sẽ chạy hết được goal</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_poly</span><span class=p>(</span><span class=n>ct</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>mac_data</span> <span class=o>=</span> <span class=n>data</span> <span class=o>+</span> <span class=n>pad</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>mac_data</span> <span class=o>+=</span> <span class=n>ct</span> <span class=o>+</span> <span class=n>pad</span><span class=p>(</span><span class=n>ct</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>mac_data</span> <span class=o>+=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&#34;&lt;Q&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>mac_data</span> <span class=o>+=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&#34;&lt;Q&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>ct</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>round</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>mac_data</span><span class=p>)</span> <span class=o>/</span> <span class=mi>16</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>=</span> <span class=n>mac_data</span><span class=p>[</span><span class=n>i</span> <span class=o>*</span> <span class=mi>16</span> <span class=p>:</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=mi>16</span><span class=p>]</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x01</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>+=</span> <span class=p>(</span><span class=mi>17</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>))</span> <span class=o>*</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span> <span class=o>=</span> <span class=p>(</span><span class=n>f</span> <span class=o>+</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=s2>&#34;little&#34;</span><span class=p>))</span> <span class=o>*</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>f</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tag1_int</span> <span class=o>=</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>tag1</span><span class=p>,</span> <span class=s2>&#34;little&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tag2_int</span> <span class=o>=</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>tag2</span><span class=p>,</span> <span class=s2>&#34;little&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Pr</span> <span class=o>=</span> <span class=n>sage</span><span class=o>.</span><span class=n>PolynomialRing</span><span class=p>(</span><span class=n>sage</span><span class=o>.</span><span class=n>GF</span><span class=p>(</span><span class=mi>2</span><span class=o>**</span><span class=mi>130</span> <span class=o>-</span> <span class=mi>5</span><span class=p>),</span> <span class=s2>&#34;x&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>Pr</span><span class=o>.</span><span class=n>gen</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>f1</span> <span class=o>=</span> <span class=n>make_poly</span><span class=p>(</span><span class=n>ciphertext1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>f2</span> <span class=o>=</span> <span class=n>make_poly</span><span class=p>(</span><span class=n>ciphertext2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>f1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>f2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 597196402248105951626966011877782631804*x^6 + 454145005287357688070972442197395601334*x^5 + 661861931549384550481074575939827950299*x^4 + 530509202787700791233082061683076211973*x^3 + 340282368435768507855198875253190755407*x^2 + 340282366920938464883773901107403685888*x</span>
</span></span><span class=line><span class=cl><span class=c1># 619916185459487913787536860817282020460*x^6 + 431610353687254081499753564988673041325*x^5 + 595420896811833730416722478289825512843*x^4 + 510460122022284652188488210929459569168*x^3 + 340282366920938463463374719923264163328*x^2 + 340282366920938464754646692591436824576*x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=o>-</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>rhs</span> <span class=o>=</span> <span class=n>tag1_int</span> <span class=o>-</span> <span class=n>tag2_int</span> <span class=o>+</span> <span class=mi>2</span><span class=o>**</span><span class=mi>128</span> <span class=o>*</span> <span class=n>k</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>rhs</span><span class=p>,</span> <span class=n>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=n>rhs</span> <span class=o>-</span> <span class=p>(</span><span class=n>f1</span> <span class=o>-</span> <span class=n>f2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>r</span><span class=p>,</span> <span class=n>_</span> <span class=ow>in</span> <span class=n>f</span><span class=o>.</span><span class=n>roots</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>r</span><span class=p>)</span><span class=o>.</span><span class=n>bit_length</span><span class=p>()</span> <span class=o>&lt;=</span> <span class=mi>124</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>s</span> <span class=o>=</span> <span class=p>(</span><span class=n>tag1_int</span> <span class=o>-</span> <span class=nb>int</span><span class=p>(</span><span class=n>f1</span><span class=p>(</span><span class=n>r</span><span class=p>)))</span> <span class=o>%</span> <span class=p>(</span><span class=mi>2</span><span class=o>**</span><span class=mi>128</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># [(20320015409774457323517351832911875936, 340179677694136160511250274535902749702)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>r</span><span class=p>,</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=n>make_poly</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tag</span> <span class=o>=</span> <span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>f</span><span class=p>(</span><span class=n>r</span><span class=p>))</span> <span class=o>+</span> <span class=n>s</span><span class=p>)</span> <span class=o>%</span> <span class=mi>2</span><span class=o>**</span><span class=mi>128</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 314525754662942930020042292487713459951</span>
</span></span><span class=line><span class=cl>    <span class=n>tag</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>tag</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=s2>&#34;little&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=p>(</span><span class=n>ciphertext</span> <span class=o>+</span> <span class=n>tag</span> <span class=o>+</span> <span class=n>nonce</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 7aa9e2e744d1b86e76990595be835cc5a12284a1728a0e960bc5febb302abf169a37b6fcf81db1ef0ee4d59f089de8f06ea49ef8749fecb4a5a47457ad46b48a03432d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;What is your message? &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Trong lúc làm bài thì mình nhập trực tiếp tới server nên được như sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Plaintext</span><span class=o>:</span> <span class=s1>&#39;Did you know that ChaCha20-Poly1305 is an authenticated encryption algorithm?&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>Plaintext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>44696420796</span><span class=nx>f75206b6e6f7720746861742043686143686132302d506f6c793133303520697320616e2061757468656e7469636174656420656e6372797074696f6e20616c676f726974686d3f</span>
</span></span><span class=line><span class=cl><span class=nx>Ciphertext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>7</span><span class=nx>cb5f2e754caea3d3d98048ee7d747c1b677b5ac33a000d74c86b68f7f25a955db62e0a8fd17b0235cfc0541a7f8edf105a5d1ab6a6489cfacb7e4061f5b1c8f4f04e9624220e4cb450bae1e13da93a564ed04959dbde00eb0e72b772fb4a5a47457ad46b48a03432d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Plaintext</span><span class=o>:</span> <span class=s1>&#39;That means it protects both the confidentiality and integrity of data!&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>Plaintext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>54686174206</span><span class=nx>d65616e732069742070726f746563747320626f74682074686520636f6e666964656e7469616c69747920616e6420696e74656772697479206f66206461746121</span>
</span></span><span class=line><span class=cl><span class=nx>Ciphertext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>6</span><span class=nx>cb4f7b30dc8fa7c38854b90b3835fd2ad2393a7269048d411c2f3ff6421b5448b3dbbeefd00f52c46b50558bae4f1bf10a2d6ea776f998aaeabee001f0b0780000ea8774f66f3102a46013366d9ab4b0cf5b4320020b4a5a47457ad46b48a03432d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>What</span> <span class=nx>is</span> <span class=nx>your</span> <span class=nx>message</span><span class=o>?</span> <span class=mi>7</span><span class=nx>aa9e2e744d1b86e76990595be835cc5a12284a1728a0e960bc5febb302abf169a37b6fcf81db1ef0ee4d59f089de8f06ea49ef8749fecb4a5a47457ad46b48a03432d</span>
</span></span><span class=line><span class=cl><span class=nx>User</span> <span class=nx>message</span> <span class=p>(</span><span class=nx>decrypted</span><span class=p>)</span><span class=o>:</span> <span class=nx>b</span><span class=s2>&#34;But it&#39;s only secure if used correctly!&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>picoCTF</span><span class=p>{</span><span class=mi>7</span><span class=nx>urn_17_84ck_n0w_77243c82</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>Flag: picoCTF{7urn_17_84ck_n0w_77243c82}
</code></pre><h3 id=guess-my-cheese-part-2>Guess My Cheese (Part 2)</h3><blockquote><p>Mình để bài này sau cùng vì thực sự thì nó khá là tricky và xém nữa thì mình có thể làm ra nó sớm hơn trong quá trình giải bài nhưng không được.</p></blockquote><p>Thử thách cho ta một cái <code>cheese_list.txt</code> chứa 599 loại cheese cùng với đó là server được kết nối như Part 1 chỉ khác 1 chỗ là không được mã hóa một loại cheese mà ta cho trước.</p><p>Ở đây thì hint có nhắc tới <a class=link href=https://en.wikipedia.org/wiki/Salt_%28cryptography%29 target=_blank rel=noopener>Salt</a> là 2 ký tự thập lục phân và gợi ý cho ta dùng <a class=link href=https://en.wikipedia.org/wiki/Rainbow_table target=_blank rel=noopener>Rainbow table</a></p><p>Đầu tiên, mình cũng brute-force băm SHA256 hết các cheese cộng với việc thêm salt vào cuối $\rightarrow$ không ra. Sau đó, mình nghĩ tới việc băm trước rồi thêm salt sau đó băm tiếp $\rightarrow$ cũng không ra. Rồi mình nghĩ tới việc thêm salt vào từng ký tự xen giữa của cheese rồi băm và tất nhiên $\rightarrow$ không ra. Tiếp theo, mình nghĩ là ồ Part 1 đã cho ta chữ cái in hoa rồi thì có thể phải in hoa hết các cheese xong mới thực hiện $\rightarrow$ không ra.</p><p>Lúc đó mình cũng không nghĩ tới việc là phải ngược lại là in thường hết các cheese và nó đúng thật là như vậy&mldr;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># solution.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>sha256</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;cheese_list.txt&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;r&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cheeses</span> <span class=o>=</span> <span class=p>[</span><span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>data</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>chall</span> <span class=o>=</span> <span class=s2>&#34;9b71b2b23fa26641a0096848f97b78718975832f37ab770c60398949cd991a14&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rainbow_table</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>cheese</span> <span class=ow>in</span> <span class=n>cheeses</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>salt</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>cheese</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=o>+</span> <span class=n>salt</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>byteorder</span><span class=o>=</span><span class=s1>&#39;big&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>new_cheese_hash</span> <span class=o>=</span> <span class=n>sha256</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>rainbow_table</span><span class=p>[</span><span class=n>new_cheese_hash</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>chall</span> <span class=ow>in</span> <span class=n>rainbow_table</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>rainbow_table</span><span class=p>[</span><span class=n>chall</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># b&#39;pyramide\xa9&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>Gửi cheese rồi sau đó là salt vào server thì ta nhận được flag&mldr;</p></section><footer class=article-footer><section class=article-tags><a href=/tags/ctf/>CTF</a>
<a href=/tags/cryptography/>Cryptography</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/imaginaryctf-2025/><div class=article-image><img src=/p/imaginaryctf-2025/imaginary.e9de644d192de193f46c90c0d02a4680_hu_3b6bafe821b2d8e6.jpg width=250 height=150 loading=lazy alt="Featured image of post ImaginaryCTF 2025" data-hash="md5-6d5kTRkt4ZP0bJDA0CpGgA=="></div><div class=article-details><h2 class=article-title>ImaginaryCTF 2025</h2></div></a></article><article class=has-image><a href=/p/holactf-2025/><div class=article-image><img src=/p/holactf-2025/holactf.9c863f56f24ea2049dc35dc145a8456b_hu_3189ab400ea0ac9b.jpg width=250 height=150 loading=lazy alt="Featured image of post HOLACTF 2025" data-hash="md5-nIY/VvJOogSdw13BRahFaw=="></div><div class=article-details><h2 class=article-title>HOLACTF 2025</h2></div></a></article><article class=has-image><a href=/p/nahamcon-ctf-2025/><div class=article-image><img src=/p/nahamcon-ctf-2025/Certificate.7f8c046c663f2b1fa34b68d95d010fdf_hu_bba9b22fc0efc29c.png width=250 height=150 loading=lazy alt="Featured image of post NahamCon CTF 2025" data-hash="md5-f4wEbGY/Kx+jS2jZXQEP3w=="></div><div class=article-details><h2 class=article-title>NahamCon CTF 2025</h2></div></a></article><article class=has-image><a href=/p/wannagame-cyber-knight-2025/><div class=article-image><img src=/p/wannagame-cyber-knight-2025/w1cyber.a4069297ed7a29deb08708dacbe2eab2_hu_20105d278e73481c.png width=250 height=150 loading=lazy alt="Featured image of post WannaGame Cyber Knight 2025" data-hash="md5-pAaSl+16Kd6whwjay+Lqsg=="></div><div class=article-details><h2 class=article-title>WannaGame Cyber Knight 2025</h2></div></a></article><article><a href=/p/wannagame-nmlt/><div class=article-details><h2 class=article-title>WannaGame NMLT</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 r1muru</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>