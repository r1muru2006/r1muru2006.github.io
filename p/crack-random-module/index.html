<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Bạn muốn thắng Vietlott, blog này là dành cho bạn..."><title>Crack Random Module</title><link rel=canonical href=https://r1muru2006.github.io/p/crack-random-module/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="Crack Random Module"><meta property='og:description' content="Bạn muốn thắng Vietlott, blog này là dành cho bạn..."><meta property='og:url' content='https://r1muru2006.github.io/p/crack-random-module/'><meta property='og:site_name' content='r1muru'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='CTF'><meta property='article:tag' content='Cryptography'><meta property='article:tag' content='Research'><meta property='article:published_time' content='2025-09-15T20:31:17+07:00'><meta property='article:modified_time' content='2025-09-15T20:31:17+07:00'><meta property='og:image' content='https://r1muru2006.github.io/p/crack-random-module/random.webp'><meta name=twitter:title content="Crack Random Module"><meta name=twitter:description content="Bạn muốn thắng Vietlott, blog này là dành cho bạn..."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://r1muru2006.github.io/p/crack-random-module/random.webp'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/r1muru_hu_96d524052e0dfddb.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>r1muru</a></h1><h2 class=site-description>Life is not fair, get used to it!</h2></div></header><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#1-python>1. Python</a><ol><li><a href=#mersenne-twister>Mersenne Twister</a></li><li><a href=#khôi-phục-từ-đầu-ra-đầy-đủ-32-bit>Khôi phục từ đầu ra đầy đủ 32-bit</a></li></ol></li><li><a href=#2-javascript>2. Javascript</a><ol><li><a href=#khôi-phục-trạng-thái-từ-một-lượng-giá-trị-ngẫu-nhiên-được-cho>Khôi phục trạng thái từ một lượng giá trị ngẫu nhiên được cho</a></li></ol></li><li><a href=#3-cc>3. C/C++</a><ol><li><a href=#thuật-toán>Thuật toán</a></li><li><a href=#khôi-phục>Khôi phục</a></li></ol></li><li><a href=#4-golang>4. Golang</a><ol><li><a href=#thuật-toán-1>Thuật toán</a></li><li><a href=#khôi-phục-1>Khôi phục</a></li></ol></li><li><a href=#5-bash>5. Bash</a><ol><li><a href=#thuật-toán-2>Thuật toán</a></li><li><a href=#khôi-phục-2>Khôi phục</a></li></ol></li><li><a href=#all-code-in-github>All code in Github</a></li><li><a href=#tài-liệu>Tài liệu</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/crack-random-module/><img src=/p/crack-random-module/random_hu_8360ea9d0e87dec4.webp srcset="/p/crack-random-module/random_hu_8360ea9d0e87dec4.webp 800w, /p/crack-random-module/random_hu_5cca52d7d08c140f.webp 1600w" width=800 height=539 loading=lazy alt="Featured image of post Crack Random Module"></a></div><div class=article-details><header class=article-category><a href=/categories/learning/>Learning</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/crack-random-module/>Crack Random Module</a></h2><h3 class=article-subtitle>Bạn muốn thắng Vietlott, blog này là dành cho bạn...</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Sep 15, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>19 minute read</time></div></footer></div></header><section class=article-content><p>Khởi động nhẹ nhàng: <a class=link href="https://www.youtube.com/watch?v=-h_rj2-HP2E" target=_blank rel=noopener>How To Predict Random Numbers Generated By Computers</a></p><h2 id=1-python>1. Python</h2><p>Hàm random của Python sử dụng thuật toán <a class=link href=https://en.wikipedia.org/wiki/Mersenne_Twister target=_blank rel=noopener>Mersenne Twister</a> - với 624 số nguyên 32 bit làm trạng thái, sau đó cứ mỗi lần xuất ra một số nguyên 32 bit, nó sẽ thay đổi trạng thái.</p><h3 id=mersenne-twister>Mersenne Twister</h3><p>Ta sẽ phân tích thuật toán tạo số ngẫu nhiên trong khoảng <code>[0,0xffffffff]</code>: <a class=link href=https://github.com/python/cpython/blob/23362f8c301f72bbf261b56e1af93e8c52f5b6cf/Modules/_randommodule.c target=_blank rel=noopener>Link</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cm>/* Period parameters -- These are all magic.  Don&#39;t change. */</span>
</span></span><span class=line><span class=cl><span class=cp>#define N 624
</span></span></span><span class=line><span class=cl><span class=cp>#define M 397
</span></span></span><span class=line><span class=cl><span class=cp>#define MATRIX_A 0x9908b0dfU    </span><span class=cm>/* constant vector a */</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#define UPPER_MASK 0x80000000U  </span><span class=cm>/* most significant w-r bits */</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#define LOWER_MASK 0x7fffffffU  </span><span class=cm>/* least significant r bits */</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>uint32_t</span>
</span></span><span class=line><span class=cl><span class=nf>genrand_uint32</span><span class=p>(</span><span class=n>RandomObject</span> <span class=o>*</span><span class=n>self</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=k>const</span> <span class=kt>uint32_t</span> <span class=n>mag01</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mh>0x0U</span><span class=p>,</span> <span class=n>MATRIX_A</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* mag01[x] = x * MATRIX_A  for x=0,1 */</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=o>*</span><span class=n>mt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>mt</span> <span class=o>=</span> <span class=n>self</span><span class=o>-&gt;</span><span class=n>state</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>self</span><span class=o>-&gt;</span><span class=n>index</span> <span class=o>&gt;=</span> <span class=n>N</span><span class=p>)</span> <span class=p>{</span> <span class=cm>/* generate N words at one time */</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>kk</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=n>kk</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>kk</span><span class=o>&lt;</span><span class=n>N</span><span class=o>-</span><span class=n>M</span><span class=p>;</span><span class=n>kk</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>y</span> <span class=o>=</span> <span class=p>(</span><span class=n>mt</span><span class=p>[</span><span class=n>kk</span><span class=p>]</span><span class=n>ANDUPPER_MASK</span><span class=p>)</span><span class=o>|</span><span class=p>(</span><span class=n>mt</span><span class=p>[</span><span class=n>kk</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=n>ANDLOWER_MASK</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>mt</span><span class=p>[</span><span class=n>kk</span><span class=p>]</span> <span class=o>=</span> <span class=n>mt</span><span class=p>[</span><span class=n>kk</span><span class=o>+</span><span class=n>M</span><span class=p>]</span> <span class=o>^</span> <span class=p>(</span><span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>^</span> <span class=n>mag01</span><span class=p>[</span><span class=n>y</span> <span class=n>AND</span> <span class=mh>0x1U</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(;</span><span class=n>kk</span><span class=o>&lt;</span><span class=n>N</span><span class=o>-</span><span class=mi>1</span><span class=p>;</span><span class=n>kk</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>y</span> <span class=o>=</span> <span class=p>(</span><span class=n>mt</span><span class=p>[</span><span class=n>kk</span><span class=p>]</span><span class=n>ANDUPPER_MASK</span><span class=p>)</span><span class=o>|</span><span class=p>(</span><span class=n>mt</span><span class=p>[</span><span class=n>kk</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=n>ANDLOWER_MASK</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>mt</span><span class=p>[</span><span class=n>kk</span><span class=p>]</span> <span class=o>=</span> <span class=n>mt</span><span class=p>[</span><span class=n>kk</span><span class=o>+</span><span class=p>(</span><span class=n>M</span><span class=o>-</span><span class=n>N</span><span class=p>)]</span> <span class=o>^</span> <span class=p>(</span><span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>^</span> <span class=n>mag01</span><span class=p>[</span><span class=n>y</span> <span class=n>AND</span> <span class=mh>0x1U</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=p>(</span><span class=n>mt</span><span class=p>[</span><span class=n>N</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=n>ANDUPPER_MASK</span><span class=p>)</span><span class=o>|</span><span class=p>(</span><span class=n>mt</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=n>ANDLOWER_MASK</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>mt</span><span class=p>[</span><span class=n>N</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>mt</span><span class=p>[</span><span class=n>M</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>^</span> <span class=p>(</span><span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>^</span> <span class=n>mag01</span><span class=p>[</span><span class=n>y</span> <span class=n>AND</span> <span class=mh>0x1U</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>self</span><span class=o>-&gt;</span><span class=n>index</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>mt</span><span class=p>[</span><span class=n>self</span><span class=o>-&gt;</span><span class=n>index</span><span class=o>++</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>^=</span> <span class=p>(</span><span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>11</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>^=</span> <span class=p>(</span><span class=n>y</span> <span class=o>&lt;&lt;</span> <span class=mi>7</span><span class=p>)</span> <span class=n>AND</span> <span class=mh>0x9d2c5680U</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>^=</span> <span class=p>(</span><span class=n>y</span> <span class=o>&lt;&lt;</span> <span class=mi>15</span><span class=p>)</span> <span class=n>AND</span> <span class=mh>0xefc60000U</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>^=</span> <span class=p>(</span><span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>18</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Nếu <code>index >= N (= 624)</code>, nghĩa là đã dùng hết số trong mảng <code>mt[]</code> và do đó phải tạo lại 624 số tiếp theo. Mảng <code>mt[]</code> được thay đổi bằng quá trình sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=p>(</span><span class=n>mt</span><span class=p>[</span><span class=n>kk</span><span class=p>]</span> <span class=n>AND</span> <span class=n>UPPER_MASK</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>mt</span><span class=p>[(</span><span class=n>kk</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=n>N</span><span class=p>]</span> <span class=n>AND</span> <span class=n>LOWER_MASK</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mt</span><span class=p>[</span><span class=n>kk</span><span class=p>]</span> <span class=o>=</span> <span class=n>mt</span><span class=p>[(</span><span class=n>kk</span> <span class=o>+</span> <span class=n>M</span><span class=p>)</span> <span class=o>%</span> <span class=n>N</span><span class=p>]</span> <span class=o>^</span> <span class=p>(</span><span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>^</span> <span class=n>mag01</span><span class=p>[</span><span class=n>y</span> <span class=n>AND</span> <span class=mh>0x1U</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=p>(</span><span class=n>mt</span><span class=p>[</span><span class=n>N</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=n>ANDUPPER_MASK</span><span class=p>)</span><span class=o>|</span><span class=p>(</span><span class=n>mt</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=n>ANDLOWER_MASK</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>mt</span><span class=p>[</span><span class=n>N</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>mt</span><span class=p>[</span><span class=n>M</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>^</span> <span class=p>(</span><span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>^</span> <span class=n>mag01</span><span class=p>[</span><span class=n>y</span> <span class=n>AND</span> <span class=mh>0x1U</span><span class=p>];</span>
</span></span></code></pre></td></tr></table></div></div><p>Sau đó, số <code>y</code> ngẫu nhiên được tạo như sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>mt</span><span class=p>[</span><span class=n>self</span><span class=o>-&gt;</span><span class=n>index</span><span class=o>++</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>^=</span> <span class=p>(</span><span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>11</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>^=</span> <span class=p>(</span><span class=n>y</span> <span class=o>&lt;&lt;</span> <span class=mi>7</span><span class=p>)</span> <span class=n>AND</span> <span class=mh>0x9d2c5680U</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>^=</span> <span class=p>(</span><span class=n>y</span> <span class=o>&lt;&lt;</span> <span class=mi>15</span><span class=p>)</span> <span class=n>AND</span> <span class=mh>0xefc60000U</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>^=</span> <span class=p>(</span><span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>18</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>y</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>Do đó, nếu ta có thể đảo ngược được quá trình này thì ta có thể dự đoán giá trị tiếp theo khi biết được 624 đầu ra 32 bit.</p><h3 id=khôi-phục-từ-đầu-ra-đầy-đủ-32-bit>Khôi phục từ đầu ra đầy đủ 32-bit</h3><p>Sau đây là các bước đảo ngược chi tiết:
<code>y ^= (y >> 18)</code></p><p>Đây là dịch phải 18 bit, ảnh hưởng từ bit cao tới bit thấp và sau bước này thì bit cao không thay đổi cùng với việc $18*2 = 36 > 32$ nên ta chỉ cần 1 lần đảo là được.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Step 1</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>^=</span> <span class=p>(</span><span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>18</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>y ^= (y &lt;&lt; 15) AND 0xefc60000</code></p><p>Ở đây, mask 0xefc60000 có cấu trúc đặc biệt với làm phép biển đổi trở thành 1 hàm tự nghịch đảo, nghĩa là $f(f(x))=x$, với $f(x) = x \oplus ((x &#171; 15)$ AND 0xefc60000). Chứng minh:</p><ul><li>Đặt A = 0xefc60000. Khi đó:</li></ul><p>$f(y)=f(f(x)) = f(x \oplus ((x &#171; 15) AND \ A))$</p><p>$= (x \oplus ((x &#171; 15) AND \ A)) \oplus (((x \oplus ((x &#171; 15) AND \ A)) &#171; 15) AND \ A)$</p><p>$= (x \oplus ((x &#171; 15) AND \ A)) \oplus (((x &#171; 15) AND \ A) \oplus((x &#171; 30) AND (A &#171; 15) AND \ A))$</p><p>$= x \oplus (((x &#171; 15) AND \ A) \oplus ((x &#171; 15) AND \ A)) \oplus((x &#171; 30) AND (A &#171; 15) \ AND \ A) = x$</p><p>(vì tính chất $P \oplus P = 0$ và $A$ có 17 bit thấp là 0 nên nếu dịch trái 15 bit thì 32 bit cuối của $A &#171; 15$ sẽ đều là 0 nên $(A &#171; 15) AND \ A = 0$)</p><p>Do đó, để đảo ngược thì ta chỉ cần 1 lần biến đổi hàm nữa:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Step 2</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>^=</span> <span class=p>(</span><span class=n>y</span> <span class=o>&lt;&lt;</span> <span class=mi>15</span><span class=p>)</span> <span class=n>AND</span> <span class=mh>0xefc60000</span>
</span></span></code></pre></td></tr></table></div></div><p><code>y ^= (y &lt;&lt; 7) AND 0x9d2c5680</code></p><p>Ở bước này thì ta sẽ thiết lập một hàm dịch bit gần tương tự như bước trên:</p><ul><li>Đặt B = 0x9d2c5680.
Với $y = x \oplus ((x &#171; 7) AND \ B)$
, ta sẽ dùng hàm $f(x&rsquo;) = y \oplus ((x&rsquo; &#171; 7) AND \ B)$
Khi đó:</li></ul><p>$f_4(y) = f_4(x \oplus ((x &#171; 7) AND \ B)) = f_3(y \oplus (((x \oplus ((x &#171; 7) AND \ B)) &#171; 7)AND \ B))$</p><p>$= f_3(x \oplus (((x &#171; 7) AND \ B) \oplus ((x &#171; 7) AND \ B)) \oplus((x &#171; (7\times2))AND (B &#171; 7) AND \ B))$</p><p>$= f_3(x \oplus((x &#171; (7\times2))AND (B &#171; 7) AND \ B))$</p><p>$= f_2(x \oplus((x &#171; (7\times3))AND (B &#171; (7\times2)) AND (B &#171; 7) AND \ B))$</p><p>$= f(x \oplus((x &#171; (7\times4))AND (B&#171; (7\times3)) AND (B &#171; (7\times2)) AND (B &#171; 7) AND \ B))$</p><p>$= x \oplus((x &#171; (7\times5))AND (B&#171; (7\times4)) AND (B&#171; (7\times3)) AND (B &#171; (7\times2)) AND (B &#171; 7) AND \ B)$</p><p>$=x$</p><p>(vì B có 7 bit thấp là 0 nên nếu dịch trái 28 bit thì 32 bit cuối của $B &#171; 28$ sẽ đều là 0 nên đẳng thức trên xảy ra.)</p><p>Do đó, để đảo ngược thì ta chỉ cần 4 lần biến đổi hàm như sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Step 3</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>y</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=n>y</span> <span class=o>^</span> <span class=p>(</span><span class=n>res</span> <span class=o>&lt;&lt;</span> <span class=mi>7</span><span class=p>)</span> <span class=n>AND</span> <span class=mh>0x9d2c5680</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>res</span>
</span></span></code></pre></td></tr></table></div></div><p><code>y ^= (y >> 11)</code>
Đây là dịch phải 11 bit, ảnh hưởng từ bit cao tới bit thấp và sau bước này thì bit cao không thay đổi cùng với việc $11*3 = 33 > 32$ nên ta chỉ cần 2 lần đảo để khôi phục từ bit cao đến bit thấp.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Step 4</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>y</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=n>y</span> <span class=o>^</span> <span class=p>(</span><span class=n>res</span> <span class=o>&gt;&gt;</span> <span class=mi>11</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Tổng hợp lại thì ta có hàm đảo (untemper):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>untemper</span><span class=p>(</span><span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 1. Rev: y ^= (y &gt;&gt; 18)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>^=</span> <span class=p>(</span><span class=n>y</span> <span class=o>&gt;&gt;</span> <span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 2. Rev: y ^= (y &lt;&lt; 15) AND 0xefc60000</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>^=</span> <span class=p>(</span><span class=n>y</span> <span class=o>&lt;&lt;</span> <span class=mi>15</span><span class=p>)</span> <span class=n>AND</span> <span class=mh>0xefc60000</span>
</span></span><span class=line><span class=cl>    <span class=c1># 3. Rev: y ^= (y &lt;&lt; 7) AND 0x9d2c5680</span>
</span></span><span class=line><span class=cl>    <span class=n>temp</span> <span class=o>=</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>temp</span> <span class=o>=</span> <span class=n>y</span> <span class=o>^</span> <span class=p>(</span><span class=n>temp</span> <span class=o>&lt;&lt;</span> <span class=mi>7</span><span class=p>)</span> <span class=n>AND</span> <span class=mh>0x9d2c5680</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>temp</span>
</span></span><span class=line><span class=cl>    <span class=c1># 4. Rev: y ^= (y &gt;&gt; 11);</span>
</span></span><span class=line><span class=cl>    <span class=n>temp</span> <span class=o>=</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>temp</span> <span class=o>=</span> <span class=n>y</span> <span class=o>^</span> <span class=p>(</span><span class=n>temp</span> <span class=o>&gt;&gt;</span> <span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>temp</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>y</span>
</span></span></code></pre></td></tr></table></div></div><p>Ví dụ cụ thể:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>state</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>getstate</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>outputs</span> <span class=o>=</span> <span class=p>[</span><span class=n>random</span><span class=o>.</span><span class=n>getrandbits</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1000</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>recovered_state</span> <span class=o>=</span> <span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>([</span><span class=n>untemper</span><span class=p>(</span><span class=n>v</span><span class=p>)</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>outputs</span><span class=p>[:</span><span class=mi>624</span><span class=p>]]</span> <span class=o>+</span> <span class=p>[</span><span class=mi>0</span><span class=p>]),</span> <span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>random</span><span class=o>.</span><span class=n>setstate</span><span class=p>(</span><span class=n>recovered_state</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=n>outputs</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>random</span><span class=o>.</span><span class=n>getrandbits</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>State được phục hồi có 3 phần tử:</li></ul><ol><li>Số nguyên 3, là chỉ số &ldquo;vị trí trạng thái&rdquo; được module random của Python sử dụng để chỉ ra vị trí của bộ tạo trong mảng trạng thái.</li><li>Bộ dữ liệu gồm 624 số nguyên, biểu diễn mảng trạng thái đã phục hồi.</li><li>None là &ldquo;giá trị giữ chỗ&rdquo; để đảm bảo tính tương thích với định dạng trạng thái mà module random của Python mong đợi.</li></ol><p>Khi chạy đoạn kiểm thử trên thì dòng lệnh đối chiếu với <code>assert</code> không bị lỗi, chứng tỏ đã khôi phục thành công state ban đầu.</p><h2 id=2-javascript>2. Javascript</h2><p>Phương thức tĩnh <code>Math.random()</code> trả về một số dấu phẩy động, ngẫu nhiên lớn hơn hoặc bằng 0 và nhỏ hơn 1, với phân phối gần như đồng đều trong phạm vi đó — sau đó bạn có thể điều chỉnh theo phạm vi mong muốn. Việc triển khai sẽ chọn <code>seed</code> ban đầu cho thuật toán tạo số ngẫu nhiên; người dùng không thể chọn hoặc đặt lại <code>seed</code> này.</p><ul><li>XorShift128 trả về trạng thái 128-bit qua <code>state0, state1</code> và được triển khai như sau:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>xs128</span><span class=p>(</span><span class=n>state0</span><span class=p>,</span> <span class=n>state1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>mask</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>64</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>s1</span> <span class=o>=</span> <span class=n>state0</span> <span class=n>AND</span> <span class=n>mask</span>
</span></span><span class=line><span class=cl>    <span class=n>s0</span> <span class=o>=</span> <span class=n>state1</span> <span class=n>AND</span> <span class=n>mask</span>
</span></span><span class=line><span class=cl>    <span class=n>s1</span> <span class=o>^=</span> <span class=p>(</span><span class=n>s1</span> <span class=o>&lt;&lt;</span> <span class=mi>23</span><span class=p>)</span> <span class=n>AND</span> <span class=n>mask</span>
</span></span><span class=line><span class=cl>    <span class=n>s1</span> <span class=o>^=</span> <span class=p>(</span><span class=n>s1</span> <span class=o>&gt;&gt;</span> <span class=mi>17</span><span class=p>)</span> <span class=n>AND</span> <span class=n>mask</span>
</span></span><span class=line><span class=cl>    <span class=n>s1</span> <span class=o>^=</span> <span class=n>s0</span>
</span></span><span class=line><span class=cl>    <span class=n>s1</span> <span class=o>^=</span> <span class=p>(</span><span class=n>s0</span> <span class=o>&gt;&gt;</span> <span class=mi>26</span><span class=p>)</span> <span class=n>AND</span> <span class=n>mask</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>s0</span><span class=p>,</span> <span class=n>s1</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Khi <code>cache</code> trống, 1 chuỗi 64 giá trị ngẫu nhiên mới sẽ được tạo thành qua xs128 và lưu trữ trong <code>cache</code> với chỉ số được đặt ở cuối.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>_refill</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Refill the Math.random cache using xs128.
</span></span></span><span class=line><span class=cl><span class=s2>    Can only be used when Math.random cache is empty.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    A new 64-long list of random values is stored in cache.
</span></span></span><span class=line><span class=cl><span class=s2>    The cache_idx is set to the last index of the cache (63).
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=bp>self</span><span class=o>.</span><span class=n>cache_idx</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>cache</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>64</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>state0</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>state1</span> <span class=o>=</span> <span class=n>xs128</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>state0</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>state1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>cache</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>state0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>cache_idx</span> <span class=o>=</span> <span class=mi>63</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Lúc gọi <code>Math.random()</code> thì <code>next()</code> được gọi và đưa ra 1 giá trị thập phân từ 0.0 đến 1.0. Ở đây thì v8 chuyển đổi số từ xs128 sang double bằng cách bỏ 12 bit cuối, còn 52 bit thì đưa vào phần Mantissa của số double trong chuẩn IEEE754. Sau đó trừ đi 1 và có được giá trị thập phân từ 0.0 đến 1.0.
<img src=https://hackmd.io/_uploads/HyR0w9nFel.png loading=lazy alt=image></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>v8_to_double</span><span class=p>(</span><span class=n>state0</span><span class=p>,</span> <span class=n>debug</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=p>(</span><span class=n>state0</span> <span class=o>&gt;&gt;</span> <span class=mi>12</span><span class=p>)</span> <span class=o>|</span> <span class=mh>0x3ff0000000000000</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>debug</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>r</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s1>&#39;&lt;Q&#39;</span><span class=p>,</span> <span class=n>r</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>next</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>cache_idx</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_refill</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>val</span> <span class=o>=</span> <span class=n>v8_to_double</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>cache</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>cache_idx</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>debug</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>cache_idx</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>val</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=khôi-phục-trạng-thái-từ-một-lượng-giá-trị-ngẫu-nhiên-được-cho>Khôi phục trạng thái từ một lượng giá trị ngẫu nhiên được cho</h3><p><code>Math.random()</code> của V8 sử dụng <code>xs128</code> gồm các biểu thức tuyến tính trong hệ GF(2). Do đó, ta có thể xây dựng một hệ các phương trình tuyến tính trên GF(2) với 1 lượng giá trị ngẫu nhiên cho trước vừa đủ và từ đó, ta được nghiệm của hệ này là hai trạng thái ban đầu (seed) của thuật toán và dự đoán được giá trị ngẫu nhiên tiếp theo.</p><p>Chúng ta sẽ xây dựng hệ như sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>numbers</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.20850633840727073</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.28382289045651743</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.4071416957057805</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.3101367279739642</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.6813711566813534</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.8365880507655776</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.2238039081275922</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.014754643967695324</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.44290438850282876</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.5473214381957232</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.40023560591139606</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.14837298522461473</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.12321774476187275</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.8501766788936596</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.9212308144118708</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.8099337802981195</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.06047989985671265</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.6552969701254443</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.5803218168252511</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.41915921494443964</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.9153038363744563</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.7403989120318095</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.6630141727527132</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.5230661117641415</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Đây là những giá trị ngẫu nhiên cho trước</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gf2bv</span> <span class=kn>import</span> <span class=n>LinearSystem</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lin</span> <span class=o>=</span> <span class=n>LinearSystem</span><span class=p>([</span><span class=mi>64</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>state0</span><span class=p>,</span> <span class=n>state1</span> <span class=o>=</span> <span class=n>lin</span><span class=o>.</span><span class=n>gens</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Random</span> <span class=o>=</span> <span class=n>MathRandom</span><span class=p>(</span><span class=n>state0</span><span class=p>,</span> <span class=n>state1</span><span class=p>,</span> <span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>out</span> <span class=o>=</span> <span class=p>[</span><span class=n>Random</span><span class=o>.</span><span class=n>next</span><span class=p>()</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>numbers</span><span class=p>))]</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>state0, state1</code> là hai <code>symbolic unknown</code> có 64-bit và nằm trong hệ tuyến tính. <code>Random</code> sẽ tạo những biểu thức tuyến tính chính là <code>out</code> với ẩn là <code>state0, state1</code> để xây dựng hệ.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>zeros</span><span class=o>=</span><span class=p>[(</span><span class=n>v8_from_double</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=mi>12</span> <span class=o>|</span> <span class=mh>0x3ff0000000000000</span><span class=p>)</span> <span class=o>^</span> <span class=n>y</span> <span class=k>for</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>numbers</span><span class=p>,</span> <span class=n>out</span><span class=p>)]</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Với mỗi cặp giá trị và phương trình ẩn, ta khôi phục 52 bit mantissa của đầu ra và đưa về chuẩn IEEE754 cho dạng double + 1.0 rồi XOR với biểu thức ẩn đã cho.</li><li>Nếu biểu thức này trùng với giá trị đầu ra thì sau khi XOR sẽ bằng 0. Vậy là ta đã có hệ tuyến tính ẩn <code>state0, state1</code>, giải hệ này và ta nhận được trạng thái ban đầu.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>sol</span> <span class=o>=</span> <span class=n>lin</span><span class=o>.</span><span class=n>solve_one</span><span class=p>(</span><span class=n>zeros</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=3-cc>3. C/C++</h2><p>Bên ngôn ngữ C/C++, hàm rand() xây dựng dựa trên <a class=link href=https://www.mscs.dal.ca/~selinger/random/ target=_blank rel=noopener>GLIBC random number generator</a></p><p>Hàm <code>random()</code> của thư viện GNU C cung cấp các số giả ngẫu nhiên thông qua phương pháp phản hồi cộng tuyến tính. Phản hồi này tuyến tính theo modulo $2^{32}$. Tính phi tuyến tính nhỏ duy nhất xuất hiện trong giai đoạn <code>seeding</code>, do phép này được thực hiện theo modulo $2^{31} - 1$ chứ không phải modulo $2^{31}$ hay $2^{32}$. Điều này có nghĩa là, mặc dù mỗi số ngẫu nhiên được tạo ra phụ thuộc tuyến tính vào các số trước đó trong chuỗi, nhưng toàn bộ các số ngẫu nhiên không phụ thuộc tuyến tính vào <code>seed</code>.</p><h3 id=thuật-toán>Thuật toán</h3><p>Như mô tả ở trên, ta có: $2147483647 = 2^{31} - 1$ và $4294967296 = 2^{32}$</p><p>Với mỗi <code>seed</code> cho trước, 1 <code>initialization vector</code> (iv) $r_0&mldr;r_{33}$ được tính như sau:</p><ul><li>$r_0$ = <code>seed</code></li><li>$r_i\equiv (16807 * r_{i-1}) \mod 2147483647 \ ( i \in [1,30])$</li><li>$r_i=r_{i-31}\ (i\in [31, 33])$</li></ul><p>Sau đó, 1 chuỗi các số ngẫu nhiên $r_{34}&mldr;$ được tạo bằng vòng lặp phản hồi tuyến tính:</p><ul><li>$r_i\equiv r_{i-3}+r_{i-31}\mod 4294967296 \ (i \ge 34)$</li></ul><p>$r_0&mldr;r_{343}$ không được sử dụng mà đầu ra $o_i$ của hàm <code>rand()</code> là: $o_i =r_{i+344} \gg 1$</p><p>Code in C:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define MAX 1000
</span></span></span><span class=line><span class=cl><span class=cp>#define seed 1
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>r</span><span class=p>[</span><span class=n>MAX</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>r</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>seed</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=n>i</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=mi>31</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>16807LL</span> <span class=o>*</span> <span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span> <span class=o>%</span> <span class=mi>2147483647</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>2147483647</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=n>i</span><span class=o>=</span><span class=mi>31</span><span class=p>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=mi>34</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>31</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=n>i</span><span class=o>=</span><span class=mi>34</span><span class=p>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=mi>344</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>31</span><span class=p>]</span> <span class=o>+</span> <span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=n>i</span><span class=o>=</span><span class=mi>344</span><span class=p>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=n>MAX</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>31</span><span class=p>]</span> <span class=o>+</span> <span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=p>((</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=khôi-phục>Khôi phục</h3><p>Phân tích thuật toán trên thì ta thấy rằng:</p><ul><li>Từ $i\ge34$, $r_i\equiv r_{i-3}+r_{i-31}$ là tuyến tính và có nghĩa là khi ta biết được 2 trong 3 giá trị thì sẽ suy ra được giá trị còn lại.</li><li>Với đầu ra $o_i =r_{i+344} \gg 1$, nghĩa là nó có 31 bit và mất bit bên phải ngoài cùng $r_{i+344}$</li><li>Nghĩa là nếu ta có đủ đầu ra liên tiếp thì hoàn toàn có thể lan truyền để khôi phục lại mảng trạng thái ban đầu (iv).</li></ul><p>Các bước để khôi phục iv như sau:</p><ol><li>Đoán bit thấp bị bỏ rồi ghép thành một phần trạng thái:</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>crack</span><span class=p>(</span><span class=n>outputs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>states</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>outputs</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>31</span> <span class=ow>and</span> 
</span></span><span class=line><span class=cl>            <span class=n>outputs</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>      <span class=o>!=</span> <span class=kc>None</span> <span class=ow>and</span>
</span></span><span class=line><span class=cl>            <span class=n>outputs</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>31</span><span class=p>]</span> <span class=o>!=</span> <span class=kc>None</span> <span class=ow>and</span> 
</span></span><span class=line><span class=cl>            <span class=n>outputs</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>3</span><span class=p>]</span>  <span class=o>!=</span> <span class=kc>None</span> <span class=ow>and</span> 
</span></span><span class=line><span class=cl>            <span class=n>outputs</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=p>(</span><span class=n>outputs</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>31</span><span class=p>]</span> <span class=o>+</span> <span class=n>outputs</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>3</span><span class=p>])</span> <span class=n>AND</span> <span class=mh>0x7fffffff</span>
</span></span><span class=line><span class=cl>        <span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>states</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>31</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>outputs</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>31</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>states</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>3</span><span class=p>]</span>  <span class=o>=</span> <span class=p>(</span><span class=n>outputs</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>3</span><span class=p>]</span>  <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>states</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>outputs</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>states</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>states</span>
</span></span></code></pre></td></tr></table></div></div><p>Nếu ta có $o_i, o_{i-31},o_{i-3}$ và chúng không thỏa:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>outputs</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=p>(</span><span class=n>outputs</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>31</span><span class=p>]</span> <span class=o>+</span> <span class=n>outputs</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>3</span><span class=p>])</span> <span class=n>AND</span> <span class=mh>0x7fffffff</span>
</span></span></code></pre></td></tr></table></div></div><p>Đoán trạng thái của nỏ ở dạng:</p>$$
\begin{cases}
s_{i-31} = o_{i-31} << 1 + 1 \\
s_{i-3} = o_{i-3} << 1 + 1 \\
s_i = o_i << 1 + 0
\end{cases}
$$<p>Nếu không, gắn $s_i =$ None vì chưa biết dạng chuẩn.</p><ol start=2><li>Khôi phục trạng thái:</li></ol><p>Chạy ngược công thức cộng để khôi phục các giá trị (nếu có) trong 344 giá trị đầu</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>states</span> <span class=o>=</span> <span class=n>crack</span><span class=p>(</span><span class=n>outputs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>init</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span> <span class=o>*</span> <span class=mi>344</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>343</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s31</span> <span class=o>=</span> <span class=n>states</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>31</span> <span class=o>-</span> <span class=mi>344</span><span class=p>]</span> <span class=k>if</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>31</span> <span class=o>&gt;=</span> <span class=mi>344</span> <span class=k>else</span> <span class=n>init</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>31</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>s28</span> <span class=o>=</span> <span class=n>states</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>28</span> <span class=o>-</span> <span class=mi>344</span><span class=p>]</span> <span class=k>if</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>28</span> <span class=o>&gt;=</span> <span class=mi>344</span> <span class=k>else</span> <span class=n>init</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>28</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>s31</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>s28</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>init</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>s31</span> <span class=o>-</span> <span class=n>s28</span><span class=p>)</span> <span class=o>%</span> <span class=mi>2</span><span class=o>**</span><span class=mi>32</span>
</span></span></code></pre></td></tr></table></div></div><p>Nếu có 1 giá trị trong khoảng 31 giá trị đầu, ta có thể tính tất cả các giá trị còn lại vì tính chất tuyến tính bằng công thức:
$r_i\equiv (16807 * r_{i-1}) \mod 2147483647 \Leftrightarrow r_{i-1}\equiv (16807^{-1} * r_i) \mod 2147483647$</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>base_idx</span> <span class=o>=</span> <span class=nb>next</span><span class=p>((</span><span class=n>i</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>31</span><span class=p>)</span> <span class=k>if</span> <span class=n>init</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>),</span> <span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>base_idx</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>31</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>init</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>init</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=mi>16807</span><span class=p>,</span> <span class=n>i</span> <span class=o>-</span> <span class=n>base_idx</span><span class=p>,</span> <span class=mi>2147483647</span><span class=p>)</span> <span class=o>*</span> <span class=n>init</span><span class=p>[</span><span class=n>base_idx</span><span class=p>]</span> <span class=o>%</span> <span class=mi>2147483647</span>
</span></span></code></pre></td></tr></table></div></div><p>Vì tính chất tuyến tính $r_i \equiv r_{i-3}+r_{i-31}, \forall i \ge 34$ nên nếu ta biết 2 giá trị thì suy ra được giá trị còn lại. Do đó, ta viết hàm lặp đến khi không thể khôi phục giá trị nào nữa để điền tất cả các giá trị còn thiếu.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>self_recover</span><span class=p>(</span><span class=n>states</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>MOD</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>**</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>length</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>states</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>updated</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>34</span><span class=p>,</span> <span class=n>length</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>s_i</span> <span class=o>=</span> <span class=n>states</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>s_31</span> <span class=o>=</span> <span class=n>states</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>31</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>s_3</span> <span class=o>=</span> <span class=n>states</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>s_i</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>s_3</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>s_31</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>states</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>31</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>s_i</span> <span class=o>-</span> <span class=n>s_3</span><span class=p>)</span> <span class=o>%</span> <span class=n>MOD</span>
</span></span><span class=line><span class=cl>                <span class=n>updated</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>s_i</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>s_31</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>s_3</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>states</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>s_i</span> <span class=o>-</span> <span class=n>s_31</span><span class=p>)</span> <span class=o>%</span> <span class=n>MOD</span>
</span></span><span class=line><span class=cl>                <span class=n>updated</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>s_i</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>s_3</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>s_31</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>states</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>s_3</span> <span class=o>+</span> <span class=n>s_31</span><span class=p>)</span> <span class=o>%</span> <span class=n>MOD</span>
</span></span><span class=line><span class=cl>                <span class=n>updated</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>updated</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>             
</span></span><span class=line><span class=cl><span class=n>all_states</span> <span class=o>=</span> <span class=n>init</span> <span class=o>+</span> <span class=n>states</span>
</span></span><span class=line><span class=cl><span class=n>self_recover</span><span class=p>(</span><span class=n>all_states</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Điền 3 giá trị đầu bằng các sao chép từ thứ tự 31 và lấy được <code>seed</code> ban đầu:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>all_states</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>all_states</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>31</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>Full code ở <a class=link href=https://github.com/r1muru2006/Crack_random/blob/main/glibc_random/crack.py target=_blank rel=noopener>đây</a>&mldr;</p><h2 id=4-golang>4. Golang</h2><p>PRNG của Golang xây dựng dựa trên Lagged Fibonacci Generator.</p><h3 id=thuật-toán-1>Thuật toán</h3><p>Hàm tạo <code>seed</code> cho rng: $x_{n+1} = 48271 * x_n \mod (2^{31} - 1)$</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>seedrand</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>A</span> <span class=o>=</span> <span class=mi>48271</span>
</span></span><span class=line><span class=cl>    <span class=n>Q</span> <span class=o>=</span> <span class=mi>44488</span>
</span></span><span class=line><span class=cl>    <span class=n>R</span> <span class=o>=</span> <span class=mi>3399</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>hi</span> <span class=o>=</span> <span class=n>x</span> <span class=o>//</span> <span class=n>Q</span>
</span></span><span class=line><span class=cl>    <span class=n>lo</span> <span class=o>=</span> <span class=n>x</span> <span class=o>%</span> <span class=n>Q</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>A</span> <span class=o>*</span> <span class=n>lo</span> <span class=o>-</span> <span class=n>R</span> <span class=o>*</span> <span class=n>hi</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>+=</span> <span class=n>INT32_MAX</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span>
</span></span></code></pre></td></tr></table></div></div><p>Để tránh tràn số thì code dùng Schrage’s Method (hi = x // Q, lo = x % Q).</p><p>Tiếp theo, ta có class <code>RNGSource</code> là PRNG chính.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>tap</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>feed</span> <span class=o>=</span> <span class=n>RNG_LEN</span> <span class=o>-</span> <span class=n>RNG_TAP</span>   <span class=c1># 607 - 273 = 334</span>
</span></span></code></pre></td></tr></table></div></div><p>Hai con trỏ là <code>tap</code> và <code>feed</code> chạy ngược nhau, thực hiện phép cộng sinh số ngẫu nhiên rồi sau đó lưu trữ trạng thái này vào mảng <code>vec</code>, tổng 607 phần tử 64-bit.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>seed</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>seed</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>tap</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>feed</span> <span class=o>=</span> <span class=n>RNG_LEN</span> <span class=o>-</span> <span class=n>RNG_TAP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>seed</span> <span class=o>%=</span> <span class=n>INT32_MAX</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>seed</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>seed</span> <span class=o>+=</span> <span class=n>INT32_MAX</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>seed</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>seed</span> <span class=o>=</span> <span class=mi>89482311</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>seed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=o>-</span><span class=mi>20</span><span class=p>,</span> <span class=n>RNG_LEN</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>seedrand</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>u</span> <span class=o>=</span> <span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>40</span><span class=p>)</span> <span class=n>AND</span> <span class=mh>0xFFFFFFFFFFFFFFFF</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span> <span class=o>=</span> <span class=n>seedrand</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>u</span> <span class=o>^=</span> <span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>20</span><span class=p>)</span> <span class=n>AND</span> <span class=mh>0xFFFFFFFFFFFFFFFF</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span> <span class=o>=</span> <span class=n>seedrand</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>u</span> <span class=o>^=</span> <span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>u</span> <span class=o>^=</span> <span class=n>rng_cooked</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>vec</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>u</span>
</span></span></code></pre></td></tr></table></div></div><p>Hàm <code>seed()</code> sẽ nhận giá trị <code>seed</code> và tạo ra mảng trạng thái <code>vec</code> như sau:</p><ol><li>x được gọi <code>seedrand()</code> 20 lần để tạo số ngẫu nhiên.</li><li>Ghép 3 giá trị 31-bit thành số 64-bit qua hàm <code>seedrand()</code> với $x &#171; 40, x &#171; 20, x$.</li><li>XOR với 1 giá trị trong bảng <code>rng_cooked[]</code>.</li></ol><p>Tiếp theo, ta sẽ sinh số ngẫu nhiên 64-bit qua <code>vec</code> bằng hàm <code>uint64()</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>uint64</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>tap</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>tap</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>tap</span> <span class=o>+=</span> <span class=n>RNG_LEN</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>feed</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>feed</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>feed</span> <span class=o>+=</span> <span class=n>RNG_LEN</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>vec</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>feed</span><span class=p>]</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>vec</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>tap</span><span class=p>])</span> <span class=n>AND</span> <span class=mh>0xFFFFFFFFFFFFFFFF</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>vec</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>feed</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Hai con trỏ <code>tap</code> và <code>feed</code> đi lùi trong vòng có độ dài 607.</li><li>Theo đó là công thức Additive Lagged-Fibonacci Generator:
$$
vec_{feed}=(vec_{feed} + vec_{tap}) AND 0xFFFFFFFFFFFFFFFF
$$</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>vec</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>feed</span><span class=p>]</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>vec</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>tap</span><span class=p>])</span> <span class=n>AND</span> <span class=mh>0xFFFFFFFFFFFFFFFF</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>vec</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>feed</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=khôi-phục-1>Khôi phục</h3><p>Như ta thấy, trong golang thì từ sau giai đoạn sinh <code>seed</code>, giai đoạn sinh số ngẫu nhiên chỉ gồm phép cộng tuyến tính trên chuỗi <code>seed</code> lấy được. Nghĩa là nếu ta có chuỗi đầu ra đủ dài, ta có thể xây dựng hệ phương trình tuyến tính để tính chuỗi <code>seed</code> ban đầu.</p><p>Để xây dựng được hệ như vậy, mình nghĩ ngay tới z3-solver và sau đây là phần crack:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>rng</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>z3</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>Solver</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>NUM_TEST</span> <span class=o>=</span> <span class=mi>700</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>vec</span> <span class=o>=</span> <span class=p>[</span><span class=n>BitVec</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;vec_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span> <span class=mi>64</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>RNG_LEN</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>rng_equation</span> <span class=o>=</span> <span class=n>RngSource</span><span class=p>(</span><span class=n>vec</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>equations</span> <span class=o>=</span> <span class=p>[</span><span class=n>rng_equation</span><span class=o>.</span><span class=n>uint64</span><span class=p>()</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NUM_TEST</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rng_value</span> <span class=o>=</span> <span class=n>RngSource</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>rng_value</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter seed: &#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>vals</span> <span class=o>=</span> <span class=p>[</span><span class=n>rng_value</span><span class=o>.</span><span class=n>uint64</span><span class=p>()</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NUM_TEST</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NUM_TEST</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>equations</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>vals</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;99%...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>s</span><span class=o>.</span><span class=n>check</span><span class=p>()</span> <span class=o>==</span> <span class=n>sat</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>array_values</span> <span class=o>=</span> <span class=p>[</span><span class=n>model</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>vec</span><span class=p>[</span><span class=n>i</span><span class=p>])</span><span class=o>.</span><span class=n>as_long</span><span class=p>()</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>RNG_LEN</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=n>rng</span> <span class=o>=</span> <span class=n>RngSource</span><span class=p>(</span><span class=n>array_values</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NUM_TEST</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>=</span> <span class=n>rng</span><span class=o>.</span><span class=n>uint64</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>rng</span><span class=o>.</span><span class=n>uint64</span><span class=p>(),</span> <span class=n>rng_value</span><span class=o>.</span><span class=n>uint64</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=5-bash>5. Bash</h2><p>Bash dùng linear congruential generator (LCG) là biến thể của thuật toán Park–Miller “minimal standard” để tạo số ngẫu nhiên 31-bit.</p><h3 id=thuật-toán-2>Thuật toán</h3><p>Hàm <code>next_seed</code> sinh <code>seed</code> mới bằng cách áp dụng công thức Park-Miller LCG:</p>$$
X_{k+1}=(a\times X_k)\mod m
$$<p>với $a = 16807,\ m = 2^{31} - 1$</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>next_seed</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>seed</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>seed</span> <span class=o>=</span> <span class=mi>123459876</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>h</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>seed</span> <span class=o>//</span> <span class=mi>127773</span>
</span></span><span class=line><span class=cl>    <span class=n>l</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>seed</span> <span class=o>-</span> <span class=p>(</span><span class=mi>127773</span> <span class=o>*</span> <span class=n>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=mi>16807</span> <span class=o>*</span> <span class=n>l</span> <span class=o>-</span> <span class=mi>2836</span> <span class=o>*</span> <span class=n>h</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>seed</span> <span class=o>=</span> <span class=p>(</span><span class=n>t</span> <span class=o>+</span> <span class=mh>0x7fffffff</span><span class=p>)</span> <span class=k>if</span> <span class=n>t</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=n>t</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>seed</span>
</span></span></code></pre></td></tr></table></div></div><p>Giống Golang, nhằm tránh bị tràn số thì ta dùng Schrage’s Method để tách h và l.</p><p>Với <code>seed</code> đó, ta sinh giá trị ngẫu nhiên bằng hàm <code>next_16</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>next_16</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>next_seed</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_old</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Bash 5.0 and earlier</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>seed</span> <span class=n>AND</span> <span class=n>BASH_RAND_MAX</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Bash 5.1 and later</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>seed</span> <span class=o>&gt;&gt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>^</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>seed</span> <span class=n>AND</span> <span class=mh>0xffff</span><span class=p>))</span> <span class=n>AND</span> <span class=n>BASH_RAND_MAX</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Skip if same as last</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>result</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>last</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>next_16</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>last</span> <span class=o>=</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span></code></pre></td></tr></table></div></div><p>Có 2 phiên bản khác nhau:</p><ul><li>Từ bản Bash 5.0 trở xuống, ta chỉ lấy 15 bit thấp.</li><li>Bash 5.1 trở lên: XOR 2 giá trị 16 bit cao và 16 bit thấp của <code>seed</code> rồi trả về 15 bit cuối.</li></ul><p>Bên cạnh đó, nếu số mới giống số cũ, ta bỏ qua và tính số mới.</p><h3 id=khôi-phục-2>Khôi phục</h3><p>Vì ở đây, ta không có được trực tiếp $X_n$ mà chỉ lấy được giá trị của nó sau hàm <code>next_16</code> nên không thể truy ngược được Park-Miller LCG. Do đó, kỹ thuật mình có thể sử dụng ở đây để crack là brute-force.</p><p>Mặt khác <code>output</code> chỉ cho 15 bit, trong khi <code>state</code> có 31 bit, thế nên chắc chắn có rất nhiều <code>state</code> cho ra cùng 1 giá trị <code>output</code>. Để lọc được <code>state</code> phù hợp, ta cần nhiều giá trị <code>output</code> liên tiếp để chắc chắn tìm được duy nhất 1 <code>state.</code> Nếu không có nhiều <code>output</code> như vậy, ta có thể tìm những <code>state</code> phù hợp để thử và tìm ra kết quả cuối cùng.</p><p>Do <code>seed</code> có 32 bit, ta nên sử dụng nhiều luồng nhằm chia các khoảng của nó và chạy các task song song để giảm thời gian thực hiện và tối ưu hóa bộ nhớ. Ở đây, mình sử dụng Pool của thư viện multiprocessing trong Python để chia luồng, rồi thực hiện các task duyệt, so sánh với đầu ra cho trước và trả về <code>seed</code> nếu khớp.
Full code ở <a class=link href=https://github.com/R1MURUN0PR0/Crack_random/blob/main/bash_random/crack.py target=_blank rel=noopener>đây</a>&mldr;</p><h2 id=all-code-in-github>All code in Github</h2><p><a class=link href=https://github.com/R1MURUN0PR0/Crack_random/tree/main target=_blank rel=noopener>https://github.com/R1MURUN0PR0/Crack_random/tree/main</a></p><h2 id=tài-liệu>Tài liệu</h2><ol><li><a class=link href=https://soon.haari.me/import-random/ target=_blank rel=noopener>https://soon.haari.me/import-random/</a></li><li><a class=link href=https://rbtree.blog/posts/2021-05-18-breaking-python-random-module/ target=_blank rel=noopener>https://rbtree.blog/posts/2021-05-18-breaking-python-random-module/</a></li><li><a class=link href="https://github.com/JorianWoltjer/BashRandomCracker?tab=readme-ov-file" target=_blank rel=noopener>https://github.com/JorianWoltjer/BashRandomCracker?tab=readme-ov-file</a></li><li><a class=link href=https://en.wikipedia.org/wiki/Xorshift target=_blank rel=noopener>https://en.wikipedia.org/wiki/Xorshift</a></li><li><a class=link href=https://github.com/maple3142/gf2bv target=_blank rel=noopener>https://github.com/maple3142/gf2bv</a></li><li><a class=link href=https://www.mscs.dal.ca/~selinger/random/ target=_blank rel=noopener>https://www.mscs.dal.ca/~selinger/random/</a></li><li><a class=link href=https://github.com/d0nutptr/v8_rand_buster target=_blank rel=noopener>https://github.com/d0nutptr/v8_rand_buster</a></li></ol></section><footer class=article-footer><section class=article-tags><a href=/tags/ctf/>CTF</a>
<a href=/tags/cryptography/>Cryptography</a>
<a href=/tags/research/>Research</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/imaginaryctf-2025/><div class=article-image><img src=/p/imaginaryctf-2025/imaginary.e9de644d192de193f46c90c0d02a4680_hu_3b6bafe821b2d8e6.jpg width=250 height=150 loading=lazy alt="Featured image of post ImaginaryCTF 2025" data-hash="md5-6d5kTRkt4ZP0bJDA0CpGgA=="></div><div class=article-details><h2 class=article-title>ImaginaryCTF 2025</h2></div></a></article><article class=has-image><a href=/p/holactf-2025/><div class=article-image><img src=/p/holactf-2025/holactf.9c863f56f24ea2049dc35dc145a8456b_hu_3189ab400ea0ac9b.jpg width=250 height=150 loading=lazy alt="Featured image of post HOLACTF 2025" data-hash="md5-nIY/VvJOogSdw13BRahFaw=="></div><div class=article-details><h2 class=article-title>HOLACTF 2025</h2></div></a></article><article class=has-image><a href=/p/nahamcon-ctf-2025/><div class=article-image><img src=/p/nahamcon-ctf-2025/Certificate.7f8c046c663f2b1fa34b68d95d010fdf_hu_bba9b22fc0efc29c.png width=250 height=150 loading=lazy alt="Featured image of post NahamCon CTF 2025" data-hash="md5-f4wEbGY/Kx+jS2jZXQEP3w=="></div><div class=article-details><h2 class=article-title>NahamCon CTF 2025</h2></div></a></article><article class=has-image><a href=/p/wannagame-cyber-knight-2025/><div class=article-image><img src=/p/wannagame-cyber-knight-2025/w1cyber.a4069297ed7a29deb08708dacbe2eab2_hu_20105d278e73481c.png width=250 height=150 loading=lazy alt="Featured image of post WannaGame Cyber Knight 2025" data-hash="md5-pAaSl+16Kd6whwjay+Lqsg=="></div><div class=article-details><h2 class=article-title>WannaGame Cyber Knight 2025</h2></div></a></article><article><a href=/p/wannagame-nmlt/><div class=article-details><h2 class=article-title>WannaGame NMLT</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 r1muru</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>