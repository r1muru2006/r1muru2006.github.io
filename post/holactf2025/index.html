<!doctype html><html lang=en-us data-theme-mode=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>HOLACTF 2025 | r1muru</title><meta name=description content="Sau ƒë√¢y l√† nh·ªØng b√†i m√¨nh l√†m ƒë∆∞·ª£c trong th·ªùi gian c·ªßa gi·∫£i v·ªõi t·ªïng l√† 6 b√†i v·ªõi 3 b√†i crypto, 2 b√†i misc v√† 1 b√†i osint."><script>window.siteConfig=JSON.parse('{"anchor_icon":null,"base":"https://r1muru2006.github.io/","clipboard":{"copyright":{"count":50,"enable":false,"license_type":"by-nc-sa"},"fail":{"en":"Copy failed (Ôæü‚äøÔæü)ÔæÇ","ja":"„Ç≥„Éî„ÉºÂ§±Êïó (Ôæü‚äøÔæü)ÔæÇ","pt-br":"Falha ao copiar (Ôæü‚äøÔæü)ÔæÇ","zh-cn":"Â§çÂà∂Â§±Ë¥• (Ôæü‚äøÔæü)ÔæÇ","zh-tw":"Ë§áË£ΩÂ§±Êïó (Ôæü‚äøÔæü)ÔæÇ"},"success":{"en":"Copy successfully (*^‚ñΩ^*)","ja":"„Ç≥„Éî„ÉºÊàêÂäü (*^‚ñΩ^*)","pt-br":"Copiado com sucesso (*^‚ñΩ^*)","zh-cn":"Â§çÂà∂ÊàêÂäü (*^‚ñΩ^*)","zh-tw":"Ë§áË£ΩÊàêÂäü (*^‚ñΩ^*)"}},"code_block":{"expand":true},"icon_font":false,"outdate":{"daysago":180,"enable":false,"message":{"en":"This article was last updated on {time}. Please note that the content may no longer be applicable.","ja":"„Åì„ÅÆË®ò‰∫ã„ÅØÊúÄÁµÇÊõ¥Êñ∞Êó•Ôºö{time}„ÄÇË®òËºâÂÜÖÂÆπ„ÅåÁèæÂú®ÊúâÂäπ„Åß„Å™„ÅÑÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÅÆ„Åß„ÅîÊ≥®ÊÑè„Åè„Å†„Åï„ÅÑ„ÄÇ","pt-br":"Este artigo foi atualizado pela √∫ltima vez em {time}. Observe que o conte√∫do pode n√£o ser mais aplic√°vel.","zh-cn":"Êú¨ÊñáÊúÄÂêéÊõ¥Êñ∞‰∫é {time}ÔºåËØ∑Ê≥®ÊÑèÊñá‰∏≠ÂÜÖÂÆπÂèØËÉΩÂ∑≤‰∏çÈÄÇÁî®„ÄÇ","zh-tw":"Êú¨ÊñáÊúÄÂæåÊõ¥Êñ∞Êñº {time}ÔºåË´ãÊ≥®ÊÑèÊñá‰∏≠ÂÖßÂÆπÂèØËÉΩÂ∑≤‰∏çÈÅ©Áî®„ÄÇ"}}}')</script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=https://npm.webcache.cn/@fortawesome/fontawesome-free@7.1.0/css/regular.min.css integrity=sha384-4qYppzjH8EiA+cGdaubu2vL7Rk8WGiqCSj7oRuP1uwtFWkfKNHD20lPfcrbQc8dU crossorigin=anonymous><link rel=stylesheet href=https://npm.webcache.cn/@fortawesome/fontawesome-free@7.1.0/css/solid.min.css integrity=sha384-wbMWab3UDSPm2kvIgVOn/d9KPTecgPU1+Nb3zoQrm/oVu0EkPL6IaKinjbwW0rum crossorigin=anonymous><link rel=preload as=style href=https://npm.webcache.cn/@fortawesome/fontawesome-free@7.1.0/css/brands.min.css integrity=sha384-KTGeC2hIMzpeQakhsmzB9bZfhCD5xZZCgI1iZH6f/O457SxzlkzTQg/WXFNoi3ih crossorigin=anonymous onload='this.onload=null,this.rel="stylesheet"'><link rel=preload as=style href=https://npm.webcache.cn/@fortawesome/fontawesome-free@7.1.0/css/v5-font-face.min.css integrity=sha384-nJ1ThfldViXoLpJ6jlKcP2beas8BMbYq26SG9Hi8cH89bZi4RZ644v7helMCqJxd crossorigin=anonymous onload='this.onload=null,this.rel="stylesheet"'><link rel=preload as=style href=https://npm.webcache.cn/@fortawesome/fontawesome-free@7.1.0/css/v4-font-face.min.css integrity=sha384-UlkrhOIvZxJFd4MElSUp7ow6/RUeYKi/orfCZIRRiOENFuQPIAA3T3HjYfmBRhNq crossorigin=anonymous onload='this.onload=null,this.rel="stylesheet"'><link rel=stylesheet href=/css/loader.min.ac746e154f756f8220326eeb52a719f142ab038be5a8ddf30ea5ef15ef2356ea.css><meta property="og:type" content="website"><meta property="og:title" content="HOLACTF 2025 | r1muru"><meta property="og:description" content="Sau ƒë√¢y l√† nh·ªØng b√†i m√¨nh l√†m ƒë∆∞·ª£c trong th·ªùi gian c·ªßa gi·∫£i v·ªõi t·ªïng l√† 6 b√†i v·ªõi 3 b√†i crypto, 2 b√†i misc v√† 1 b√†i osint."><meta property="og:url" content="https://r1muru2006.github.io/post/holactf2025/"><meta property="og:site_name" content="r1muru's blog"><meta property="og:image" content="/images/holactf.jpg"><meta property="article:author" content="r1muru"><meta property="article:published_time" content="2025-09-09T08:42:30+07:00"><meta property="article:modified_time" content="2025-09-09T08:42:30+07:00"><meta property="article:tag" content="CTFCryptographyMiscellaneousOsint"><meta name=twitter:card content="summary"><meta name=twitter:image content="/images/holactf.jpg"><link rel="shortcut icon" href=/favicon.ico><link rel=stylesheet href=/css/main.min.fea35ec1dbb9520d5824bd8fcc5533a29acc2b60c759cf3ea9f2c705d51073c8.css><link rel=preload as=style href=https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css integrity=sha384-IfxC36XL/toUyJ939C73PcgMuRzAZuIzZxE38drsmO5p6jD7ei+Zx/1oA/0l8ysE crossorigin=anonymous onload='this.onload=null,this.rel="stylesheet"'><link rel=preload as=style href=https://npm.webcache.cn/katex@0.16.24/dist/katex.min.css integrity=sha384-tTgKLjMYmJr94v8qu2PE5MUGSMbyN2xiH266JUB3gpm8vnnJywd1dWSOEfrFz+YI crossorigin=anonymous onload='this.onload=null,this.rel="stylesheet"'><script src=https://npm.webcache.cn/pace-js@1.2.4/pace.min.js integrity=sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8 crossorigin=anonymous></script><link rel=stylesheet href=https://npm.webcache.cn/@reimujs/aos@0.1.2/dist/aos.css integrity=sha384-GMRP93c6Hkz9JVKGAuRR3nTS7M07RwPgTFenXiosjq2VbVgvdDNcz1g6Mkj8AONa crossorigin=anonymous><link rel=stylesheet href=https://npm.webcache.cn/aplayer@1.10.1/dist/APlayer.min.css integrity=sha384-tLMkTWh2pfXNWGFlUS0w1TFtRG5xZ9lPWFOooj+vDDLIL+xBGQU/voDBY5XE2lVh crossorigin=anonymous></head><body><div id=loader><div class="loading-left-bg loading-bg"></div><div class="loading-right-bg loading-bg"></div><div class=spinner-box><div class="loading-taichi rotate"><img src=/images/loading.svg alt=loading></div><div class=loading-word>Loading...</div></div></div></div><script>var time=null,loaderEl=document.getElementById("loader"),startLoading=()=>{time=Date.now(),loaderEl.classList.remove("loading")},hideLoader=()=>{document.body.style.overflow="auto",loader.classList.add("loading")},endLoading=()=>{time?Date.now()-time>500?(time=null,hideLoader()):(setTimeout(endLoading,500-(Date.now()-time)),time=null):hideLoader()};window.addEventListener("DOMContentLoaded",endLoading),loaderEl.addEventListener("click",endLoading)</script><div id=copy-tooltip></div><div id=lang-tooltip>This article does not have a corresponding language version</div><div id=heatmap-tooltip></div><div id=container><div id=wrap><div id=header-nav><nav id=main-nav aria-label="Primary navigation"><a class=main-nav-link-wrap href=/><div class='main-nav-icon icon'>&#xf015;</div><span class=main-nav-link>Home</span>
</a><a class=main-nav-link-wrap href=/archives><div class='main-nav-icon icon'>&#xf187;</div><span class=main-nav-link>Archives</span>
</a><a class=main-nav-link-wrap href=/about><div class='main-nav-icon icon'>&#xf007;</div><span class=main-nav-link>About</span>
</a><a id=main-nav-toggle class=nav-icon aria-label="Toggle navigation" role=button></a></nav><nav id=sub-nav aria-label="Secondary navigation"><a id=nav-search-btn class="nav-icon popup-trigger" title=Search aria-label=Search></a></nav></div><header id=header aria-label="Site header"><picture></picture>
<img fetchpriority=high src=/images/holactf.jpg alt="HOLACTF 2025"><div id=header-outer><div id=header-title><span id=logo><h1 data-aos=slide-up>HOLACTF 2025</h1></span><h2 id=subtitle-wrap data-aos=slide-down></h2></div></div></header><div id=content aria-label="Page content" class=sidebar-left><aside id=sidebar aria-label=Sidebar><div class="sidebar-wrapper-container sticky"><meting-js theme=var(--color-link) id=8668604226 server=netease type=playlist fixed=false autoplay loop order=list preload=auto volume=0.7 list-folded=false></meting-js><div class=sidebar-wrapper><div class=sidebar-wrap data-aos=fade-up><div class=sidebar-toc-sidebar><h3 class=toc-title>Contents</h3><div class="sidebar-toc-wrapper toc-div-class"><nav id=TableOfContents><ul><li><a href=#crypto>Crypto</a><ul><li><a href=#1-cs2rtrash>1. Cs2RTrash</a></li><li><a href=#2-enigmahardcode>2. EnigmaHardCode</a></li><li><a href=#3-imlosingyou>3. ImLosingYou</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#1-lunadb>1. LunaDB</a></li><li><a href=#2-weird-png>2. Weird PNG</a></li></ul></li><li><a href=#osint>Osint</a><ul><li><a href=#1-ehc-is-my-family>1. EHC is my family</a></li></ul></li></ul></nav></div></div><div class="sidebar-common-sidebar hidden"><div class=sidebar-author><img data-src=/avatar/avatar.png data-sizes=auto alt=r1muru class=lazyload><div class=sidebar-author-name>r1muru</div><div class=sidebar-description>Life is not fair, get used to it</div></div><div class=sidebar-state><div class=sidebar-state-article><div>Posts</div><div class=sidebar-state-number>11</div></div><a class=sidebar-state-category href=/categories/ aria-label=sidebar-state-category-link><div>Categories</div><div class=sidebar-state-number>3</div></a><a class=sidebar-state-tag href=/tags/ aria-label=sidebar-state-tag-link><div>Tags</div><div class=sidebar-state-number>8</div></a></div><div class=sidebar-social><div class="icon-discord sidebar-social-icon"><a href=https://discordapp.com/users/r1muru2006 itemprop=url target=_blank aria-label=discord rel="noopener nofollow noreferrer"></a></div><div class="icon-email sidebar-social-icon"><a href=cuongchu200@gmail.com itemprop=url target=_blank aria-label=email rel="noopener nofollow noreferrer"></a></div><div class="icon-facebook sidebar-social-icon"><a href=https://www.facebook.com/chu.cuong.732399 itemprop=url target=_blank aria-label=facebook rel="noopener nofollow noreferrer"></a></div><div class="icon-github sidebar-social-icon"><a href=https://github.com/r1muru2006 itemprop=url target=_blank aria-label=github rel="noopener nofollow noreferrer"></a></div><div class="icon-instagram sidebar-social-icon"><a href=https://www.instagram.com/r1murun0pr0 itemprop=url target=_blank aria-label=instagram rel="noopener nofollow noreferrer"></a></div></div><div class=sidebar-menu><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/ aria-label=Home></a><div class='sidebar-menu-icon icon'>&#xf015;</div><div class=sidebar-menu-link>Home</div></div><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/archives aria-label=Archives></a><div class='sidebar-menu-icon icon'>&#xf187;</div><div class=sidebar-menu-link>Archives</div></div><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/about aria-label=About></a><div class='sidebar-menu-icon icon'>&#xf007;</div><div class=sidebar-menu-link>About</div></div></div></div><div class=sidebar-btn-wrapper style=position:static><div class="sidebar-toc-btn current"></div><div class=sidebar-common-btn></div></div></div></div><div class=sidebar-widget></div></div></aside><section id=main aria-label="Main content"><article class="h-entry article" itemscope itemtype=https://schema.org/BlogPosting><div class=article-inner data-aos=fade-up><div class=article-meta><div class=article-date><span class="article-date-link icon-calendar" data-aos=zoom-in><time datetime="2025-09-09 08:42:30 +0700 +0700" itemprop=datePublished>2025-09-09</time>
<time style=display:none id=post-update-time>2025-09-09</time></span></div><div class=article-category><a class=article-category-link href=/categories/ctf-write-up data-aos=zoom-in>CTF WRITE-UP</a></div></div><div class=hr-line></div><div class="e-content article-entry" itemprop=articleBody><h2 id=crypto><a class=header-anchor href=#crypto></a>Crypto</h2><h3 id=1-cs2rtrash><a class=header-anchor href=#1-cs2rtrash></a>1. Cs2RTrash</h3><p><img src=https://hackmd.io/_uploads/B16EYV-qgl.png alt=image></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># chall.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>n1</span> <span class=o>=</span> <span class=mi>106274132069853085771962684070654057294853035674691451636354054913790308627721</span>
</span></span><span class=line><span class=cl><span class=n>n2</span> <span class=o>=</span> <span class=mi>73202720518342632558813895439681594395095017145510800999002057461861058762579</span>
</span></span><span class=line><span class=cl><span class=n>n3</span> <span class=o>=</span> <span class=mi>58129476807669651703262865829974447479957080526429581698674448004236654958847</span>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;HOLACTF{...}&#39;</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>c1</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>n1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c2</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>n2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c3</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>n3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;c1: </span><span class=si>{</span><span class=n>c1</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;c2: </span><span class=si>{</span><span class=n>c2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;c3: </span><span class=si>{</span><span class=n>c3</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// output.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nl>c1</span><span class=p>:</span><span class=w> </span><span class=n>40409669713698525444927116587938485167766997176959778633087672968720888190012</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nl>c2</span><span class=p>:</span><span class=w> </span><span class=n>50418608792183022472533104230595523000246213655735834753443442906871618770832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nl>c3</span><span class=p>:</span><span class=w> </span><span class=n>7151799367443802424297049002310776844321501905398348074481144597918413565153</span><span class=w>
</span></span></span></code></pre></div><p>ƒê√¢y ch·ªâ l√† 1 b√†i RSA ƒë∆°n gi·∫£n v√† m√¨nh ƒë·ªÉ √Ω r·∫±ng n1 l√† s·ªë nguy√™n t·ªë n√™n b√†i n√†y c√≥ th·ªÉ ƒë∆∞·ª£c gi·∫£i nh∆∞ sau:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># solution.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n1</span> <span class=o>=</span> <span class=mi>106274132069853085771962684070654057294853035674691451636354054913790308627721</span>
</span></span><span class=line><span class=cl><span class=n>n2</span> <span class=o>=</span> <span class=mi>73202720518342632558813895439681594395095017145510800999002057461861058762579</span>
</span></span><span class=line><span class=cl><span class=n>n3</span> <span class=o>=</span> <span class=mi>58129476807669651703262865829974447479957080526429581698674448004236654958847</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>c1</span> <span class=o>=</span> <span class=mi>40409669713698525444927116587938485167766997176959778633087672968720888190012</span>
</span></span><span class=line><span class=cl><span class=n>c2</span> <span class=o>=</span> <span class=mi>50418608792183022472533104230595523000246213655735834753443442906871618770832</span>
</span></span><span class=line><span class=cl><span class=n>c3</span> <span class=o>=</span> <span class=mi>7151799367443802424297049002310776844321501905398348074481144597918413565153</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>d1</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=n>n1</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c1</span><span class=p>,</span> <span class=n>d1</span><span class=p>,</span> <span class=n>n1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span></span></code></pre></div><pre><code>Flag: HOLACTF{ju5t_a_b4s1c_CRT}
</code></pre><h3 id=2-enigmahardcode><a class=header-anchor href=#2-enigmahardcode></a>2. EnigmaHardCode</h3><p><img src=https://hackmd.io/_uploads/rJ_aqNWcee.png alt=image>
<img src=https://hackmd.io/_uploads/SkGCc4-cge.png alt=image>
<img src=https://hackmd.io/_uploads/r1OJoEW9lx.png alt=image></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// attachment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>SWWSAOL</span><span class=p>{</span><span class=n>CRK_NTX_AGBXRRLNYQC_ANGQBQHR_TY_QNZ_PPLNFBFXX</span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Ban ƒë·∫ßu m√¨nh kh√¥ng bi·∫øt cu·ªôn tr√≤n xu·ªëng l√† c√≥ reflector v·ªõi plugboard n√™n ƒë√£ b·ªè qua :333
Khi ph√°t hi·ªán ra th√¨ m√¨nh li√™n k·∫øt l·∫°i c√°c d·ªØ li·ªáu ƒë√£ c√≥ v√† t√¨m ƒë∆∞·ª£c trang <a href=https://en.wikipedia.org/wiki/Enigma_rotor_details>wiki</a> c√≥ ƒë·ªÉ thi·∫øt l·∫≠p enigma machine
<img src=https://hackmd.io/_uploads/ry14aV-cee.png alt="Screenshot 2025-08-31 101011"></p><p>V√¨ ƒë√£ bi·∫øt rotor order, reflector, ring settings v√† ch·ªâ c√≤n thi·∫øu 1 c·∫∑p plugboard n√™n m√¨nh ƒë√£ brute-force c√°c c·∫∑p c√≤n l·∫°i ƒë·∫øn khi t√¨m ra flag format ph√π h·ª£p nh∆∞ sau:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># solution.py</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span><span class=o>,</span> <span class=nn>re</span><span class=o>,</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>itertools</span> <span class=kn>import</span> <span class=n>combinations</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>multiprocessing</span> <span class=kn>import</span> <span class=n>Pool</span><span class=p>,</span> <span class=n>cpu_count</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ALPHA</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>ascii_uppercase</span>
</span></span><span class=line><span class=cl><span class=n>pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;HOLACTF\{.*\}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Machine parameters (use your exact ones)</span>
</span></span><span class=line><span class=cl><span class=n>ROTOR</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;I&#34;</span><span class=p>:</span> <span class=p>(</span><span class=s2>&#34;EKMFLGDQVZNTOWYHXUSPAIBRCJ&#34;</span><span class=p>,</span> <span class=s2>&#34;Q&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;II&#34;</span><span class=p>:</span> <span class=p>(</span><span class=s2>&#34;AJDKSIRUXBLHWTMCQGZNPYFVOE&#34;</span><span class=p>,</span> <span class=s2>&#34;E&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;III&#34;</span><span class=p>:</span> <span class=p>(</span><span class=s2>&#34;BDFHJLCPRTXVZNYEIWGAKMUSQO&#34;</span><span class=p>,</span> <span class=s2>&#34;V&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>REFLECTOR_C</span> <span class=o>=</span> <span class=s2>&#34;FVPJIAOYEDRZXWGCTKUQSBNMHL&#34;</span>
</span></span><span class=line><span class=cl><span class=n>ORDER</span> <span class=o>=</span> <span class=p>(</span><span class=s2>&#34;II&#34;</span><span class=p>,</span> <span class=s2>&#34;III&#34;</span><span class=p>,</span> <span class=s2>&#34;I&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>RING</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;II&#34;</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span> <span class=s2>&#34;III&#34;</span><span class=p>:</span> <span class=mi>7</span><span class=p>,</span> <span class=s2>&#34;I&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>}</span>  <span class=c1># use exactly what you intend</span>
</span></span><span class=line><span class=cl><span class=n>PLUG_KNOWN</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;AO&#34;</span><span class=p>,</span> <span class=s2>&#34;DP&#34;</span><span class=p>,</span> <span class=s2>&#34;ER&#34;</span><span class=p>,</span> <span class=s2>&#34;FT&#34;</span><span class=p>,</span> <span class=s2>&#34;IU&#34;</span><span class=p>,</span> <span class=s2>&#34;JW&#34;</span><span class=p>,</span> <span class=s2>&#34;KZ&#34;</span><span class=p>,</span> <span class=s2>&#34;MX&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>MISSING_POOL</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=s2>&#34;BCGHLNQSVY&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>CIPH</span> <span class=o>=</span> <span class=s2>&#34;SWWSAOL</span><span class=si>{CRK_NTX_AGBXRRLNYQC_ANGQBQHR_TY_QNZ_PPLNFBFXX}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Precompute rotor inverse maps</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>inv_map</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;?&#34;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>26</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>w</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=p>[</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=o>-</span> <span class=mi>65</span><span class=p>]</span> <span class=o>=</span> <span class=n>ALPHA</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>L</span><span class=p>,</span> <span class=n>M</span><span class=p>,</span> <span class=n>R</span> <span class=o>=</span> <span class=n>ORDER</span>
</span></span><span class=line><span class=cl><span class=n>LW</span><span class=p>,</span> <span class=n>Lnot</span> <span class=o>=</span> <span class=n>ROTOR</span><span class=p>[</span><span class=n>L</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>MW</span><span class=p>,</span> <span class=n>Mnot</span> <span class=o>=</span> <span class=n>ROTOR</span><span class=p>[</span><span class=n>M</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>RW</span><span class=p>,</span> <span class=n>Rnot</span> <span class=o>=</span> <span class=n>ROTOR</span><span class=p>[</span><span class=n>R</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>LI</span> <span class=o>=</span> <span class=n>inv_map</span><span class=p>(</span><span class=n>LW</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>MI</span> <span class=o>=</span> <span class=n>inv_map</span><span class=p>(</span><span class=n>MW</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>RI</span> <span class=o>=</span> <span class=n>inv_map</span><span class=p>(</span><span class=n>RW</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rL</span><span class=p>,</span> <span class=n>rM</span><span class=p>,</span> <span class=n>rR</span> <span class=o>=</span> <span class=n>RING</span><span class=p>[</span><span class=n>L</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>RING</span><span class=p>[</span><span class=n>M</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>RING</span><span class=p>[</span><span class=n>R</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># fast decrypt function for one pos/pair</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decrypt_with</span><span class=p>(</span><span class=n>pos</span><span class=p>,</span> <span class=n>extra_pair</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Build plug mapping as a list for fast int ops</span>
</span></span><span class=line><span class=cl>    <span class=n>pmap</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>26</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>pair</span> <span class=ow>in</span> <span class=n>PLUG_KNOWN</span> <span class=o>+</span> <span class=p>([</span><span class=n>extra_pair</span><span class=p>]</span> <span class=k>if</span> <span class=n>extra_pair</span> <span class=k>else</span> <span class=p>[]):</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span> <span class=o>=</span> <span class=n>pair</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=n>pair</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>ai</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=o>-</span> <span class=mi>65</span>
</span></span><span class=line><span class=cl>        <span class=n>bi</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>b</span><span class=p>)</span> <span class=o>-</span> <span class=mi>65</span>
</span></span><span class=line><span class=cl>        <span class=n>pmap</span><span class=p>[</span><span class=n>ai</span><span class=p>]</span> <span class=o>=</span> <span class=n>bi</span>
</span></span><span class=line><span class=cl>        <span class=n>pmap</span><span class=p>[</span><span class=n>bi</span><span class=p>]</span> <span class=o>=</span> <span class=n>ai</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>pL</span><span class=p>,</span> <span class=n>pM</span><span class=p>,</span> <span class=n>pR</span> <span class=o>=</span> <span class=p>[</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=o>-</span> <span class=mi>65</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>pos</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>out_chars</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>ch</span> <span class=ow>in</span> <span class=n>CIPH</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>ch</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>ALPHA</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>out_chars</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>ch</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># stepping (double-step behavior)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>ALPHA</span><span class=p>[</span><span class=n>pM</span><span class=p>]</span> <span class=o>==</span> <span class=n>Mnot</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>pM</span> <span class=o>=</span> <span class=p>(</span><span class=n>pM</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span>
</span></span><span class=line><span class=cl>            <span class=n>pL</span> <span class=o>=</span> <span class=p>(</span><span class=n>pL</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>ALPHA</span><span class=p>[</span><span class=n>pR</span><span class=p>]</span> <span class=o>==</span> <span class=n>Rnot</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>pM</span> <span class=o>=</span> <span class=p>(</span><span class=n>pM</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span>
</span></span><span class=line><span class=cl>        <span class=n>pR</span> <span class=o>=</span> <span class=p>(</span><span class=n>pR</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># plugboard in</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>pmap</span><span class=p>[</span><span class=nb>ord</span><span class=p>(</span><span class=n>ch</span><span class=p>)</span> <span class=o>-</span> <span class=mi>65</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># forward through right, mid, left (account ringoffsets)</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>r</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>idx</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>p</span> <span class=o>-</span> <span class=n>r</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>w</span><span class=p>[</span><span class=n>idx</span><span class=p>])</span> <span class=o>-</span> <span class=mi>65</span> <span class=o>-</span> <span class=n>p</span> <span class=o>+</span> <span class=n>r</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>forward</span><span class=p>(</span><span class=n>RW</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>pR</span><span class=p>,</span> <span class=n>rR</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>forward</span><span class=p>(</span><span class=n>MW</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>pM</span><span class=p>,</span> <span class=n>rM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>forward</span><span class=p>(</span><span class=n>LW</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>pL</span><span class=p>,</span> <span class=n>rL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># reflector</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>REFLECTOR_C</span><span class=p>[</span><span class=n>x</span><span class=p>])</span> <span class=o>-</span> <span class=mi>65</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># back through left,middle,right (inverse maps)</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>back</span><span class=p>(</span><span class=n>iw</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>r</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>idx</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>p</span> <span class=o>-</span> <span class=n>r</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>iw</span><span class=p>[</span><span class=n>idx</span><span class=p>])</span> <span class=o>-</span> <span class=mi>65</span> <span class=o>-</span> <span class=n>p</span> <span class=o>+</span> <span class=n>r</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>back</span><span class=p>(</span><span class=n>LI</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>pL</span><span class=p>,</span> <span class=n>rL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>back</span><span class=p>(</span><span class=n>MI</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>pM</span><span class=p>,</span> <span class=n>rM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>back</span><span class=p>(</span><span class=n>RI</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>pR</span><span class=p>,</span> <span class=n>rR</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># plugboard out</span>
</span></span><span class=line><span class=cl>        <span class=n>out_chars</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>pmap</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>+</span> <span class=mi>65</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>out_chars</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Worker: given a pair (like &#34;BC&#34;), test all positions and return any matches</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>worker_for_pair</span><span class=p>(</span><span class=n>pair</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>found</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>pair</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>pair</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>ALPHA</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>ALPHA</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>ALPHA</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>pos</span> <span class=o>=</span> <span class=n>a</span> <span class=o>+</span> <span class=n>b</span> <span class=o>+</span> <span class=n>c</span>
</span></span><span class=line><span class=cl>                <span class=n>pt</span> <span class=o>=</span> <span class=n>decrypt_with</span><span class=p>(</span><span class=n>pos</span><span class=p>,</span> <span class=n>pair</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>pattern</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>pt</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=n>found</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>pair</span><span class=p>,</span> <span class=n>pos</span><span class=p>,</span> <span class=n>pt</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>found</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>pairs</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>combinations</span><span class=p>(</span><span class=n>MISSING_POOL</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Total pairs:&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>pairs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>nproc</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>cpu_count</span><span class=p>()</span> <span class=o>-</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Using processes:&#34;</span><span class=p>,</span> <span class=n>nproc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>Pool</span><span class=p>(</span><span class=n>nproc</span><span class=p>)</span> <span class=k>as</span> <span class=n>pool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># map worker across pairs; each worker tests all 26^3 positions for that pair</span>
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=n>pool</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>worker_for_pair</span><span class=p>,</span> <span class=n>pairs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>elapsed</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
</span></span><span class=line><span class=cl>    <span class=n>matches</span> <span class=o>=</span> <span class=p>[</span><span class=n>m</span> <span class=k>for</span> <span class=n>sub</span> <span class=ow>in</span> <span class=n>results</span> <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>sub</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Elapsed:&#34;</span><span class=p>,</span> <span class=n>elapsed</span><span class=p>,</span> <span class=s2>&#34;seconds&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Matches found:&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>matches</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>pair</span><span class=p>,</span> <span class=n>pos</span><span class=p>,</span> <span class=n>pt</span> <span class=ow>in</span> <span class=n>matches</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;pair&#34;</span><span class=p>,</span> <span class=n>pair</span><span class=p>,</span> <span class=s2>&#34;pos&#34;</span><span class=p>,</span> <span class=n>pos</span><span class=p>,</span> <span class=s2>&#34;-&gt;&#34;</span><span class=p>,</span> <span class=n>pt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div><p>K·∫øt qu·∫£ tr·∫£ v·ªÅ:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Total pairs: 45
</span></span><span class=line><span class=cl>Using processes: 12
</span></span><span class=line><span class=cl>Elapsed: 7.59969425201416 seconds
</span></span><span class=line><span class=cl>Matches found: 1
</span></span><span class=line><span class=cl>pair CV pos ULW -&gt; HOLACTF{WAR_DIE_GEHEIMHISSE_WIRKLICH_SO_GUT_VERSTECKP}
</span></span></code></pre></div><p>Tuy nhi√™n, flag n√†y v·∫´n ch∆∞a ch√≠nh x√°c n√™n m√¨nh ƒë√£ h·ªèi chatGPT th·ª≠ th√¨ nh·∫≠n ƒë∆∞·ª£c prompt:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Check adjacent starting positions:
</span></span><span class=line><span class=cl>Often the crib falls into place if the initial rotor position is shifted by 1‚Äì2 steps. Try decrypting again with positions just before and after ULW (e.g., ULV, ULX, UKW, etc.).
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Double-check ring settings vs. rotor positions:
</span></span><span class=line><span class=cl>Sometimes code mixes up Ringstellung (internal offset) with Grundstellung (daily key start). If those were off, letters will be slightly wrong throughout.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Test all 45 possible plugboard completions again but only around ULW neighborhood (like ¬±5 positions). That should be much faster.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Language filter: Since the plaintext is clearly German, you can filter candidates through a simple dictionary check (look for &#34;GEHEIMNISSE&#34; and &#34;VERSTECKT&#34;).
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>üëâ I think the true flag should be:
</span></span><span class=line><span class=cl>HOLACTF{WAR_DIE_GEHEIMNISSE_WIRKLICH_SO_GUT_VERSTECKT}
</span></span></code></pre></div><p>Submit th·ª≠ th√¨ nh·∫≠n ƒë∆∞·ª£c k·∫øt qu·∫£ tr·∫£ v·ªÅ ƒë√∫ng.</p><pre><code>Flag: HOLACTF{WAR_DIE_GEHEIMNISSE_WIRKLICH_SO_GUT_VERSTECKT}
</code></pre><h3 id=3-imlosingyou><a class=header-anchor href=#3-imlosingyou></a>3. ImLosingYou</h3><p><img src=https://hackmd.io/_uploads/HydG1B-5gl.png alt=image></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># encrypt.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>random</span> <span class=kn>import</span> <span class=n>getrandbits</span><span class=p>,</span> <span class=n>FLAG</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>256</span><span class=p>)</span> <span class=o>*</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>256</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=n>FLAG</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mod_m</span> <span class=o>=</span> <span class=n>m</span> <span class=o>-</span> <span class=n>getrandbits</span><span class=p>(</span><span class=mi>80</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;n = </span><span class=si>{</span><span class=n>n</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;c = </span><span class=si>{</span><span class=n>c</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;mod_m = </span><span class=si>{</span><span class=n>mod_m</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>5655306554322573090396099186606396534230961323765470852969315242956396512318053585607579359989407371627321079880719083136343885009234351073645372666488587</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>249064480176144876250402041707185886135379496538171928784862949393878232927200977890895568473400681389529997203697206006850790029940405682934025</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>mod_m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>499063603337435213780295973826237775412685978121823376141602090122856806</span><span class=w>
</span></span></span></code></pre></div><p>M√¨nh gi·∫£ s·ª≠ <code>FLAG</code> c√≥ ƒë·ªô d√†i ng·∫Øn v√† th·ª≠ l·∫•y cƒÉn c·ªßa <code>c</code> th√¨ ƒë√∫ng l√† nh∆∞ v·∫≠y:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># solution.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>5655306554322573090396099186606396534230961323765470852969315242956396512318053585607579359989407371627321079880719083136343885009234351073645372666488587</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=mi>249064480176144876250402041707185886135379496538171928784862949393878232927200977890895568473400681389529997203697206006850790029940405682934025</span>
</span></span><span class=line><span class=cl><span class=n>mod_m</span> <span class=o>=</span> <span class=mi>499063603337435213780295973826237775412685978121823376141602090122856806</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pt</span> <span class=o>=</span> <span class=n>iroot</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=mi>2</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>pt</span><span class=p>))</span>
</span></span></code></pre></div><pre><code>Flag: HOLACTF{f33ls_l1k3_l0s1ng_h3r}
</code></pre><h2 id=misc><a class=header-anchor href=#misc></a>Misc</h2><h3 id=1-lunadb><a class=header-anchor href=#1-lunadb></a>1. LunaDB</h3><p><img src=https://hackmd.io/_uploads/S1XYxSWclg.png alt=image></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>//</span> <span class=n>main</span><span class=o>.</span><span class=n>rs</span>
</span></span><span class=line><span class=cl><span class=n>use</span> <span class=n>std</span><span class=p>::</span><span class=n>fs</span><span class=p>::{</span><span class=ne>File</span><span class=p>,</span> <span class=n>OpenOptions</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>use</span> <span class=n>std</span><span class=p>::</span><span class=n>io</span><span class=p>::{</span><span class=bp>self</span><span class=p>,</span> <span class=n>Read</span><span class=p>,</span> <span class=n>Write</span><span class=p>,</span> <span class=n>BufRead</span><span class=p>,</span> <span class=n>Cursor</span><span class=p>,</span> <span class=n>Seek</span><span class=p>,</span> <span class=n>SeekFrom</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>use</span> <span class=n>std</span><span class=p>::</span><span class=n>path</span><span class=p>::</span><span class=ne>Path</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>use</span> <span class=n>std</span><span class=p>::</span><span class=n>env</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>use</span> <span class=n>std</span><span class=p>::</span><span class=n>process</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>use</span> <span class=n>std</span><span class=p>::</span><span class=n>time</span><span class=p>::{</span><span class=n>SystemTime</span><span class=p>,</span> <span class=n>UNIX_EPOCH</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>use</span> <span class=n>rand</span><span class=p>::{</span><span class=n>Rng</span><span class=p>,</span> <span class=n>thread_rng</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>use</span> <span class=n>rand</span><span class=p>::</span><span class=n>distributions</span><span class=p>::</span><span class=n>Alphanumeric</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>use</span> <span class=n>openssl</span><span class=p>::</span><span class=n>symm</span><span class=p>::{</span><span class=n>Cipher</span><span class=p>,</span> <span class=n>Crypter</span><span class=p>,</span> <span class=n>Mode</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>use</span> <span class=n>hex_literal</span><span class=p>::</span><span class=n>hex</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>use</span> <span class=n>byteorder</span><span class=p>::{</span><span class=n>LittleEndian</span><span class=p>,</span> <span class=n>ReadBytesExt</span><span class=p>,</span> <span class=n>WriteBytesExt</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>use</span> <span class=n>leb128</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>H_START</span><span class=p>:</span> <span class=p>[</span><span class=n>u8</span><span class=p>;</span> <span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=n>hex</span><span class=o>!</span><span class=p>(</span><span class=s2>&#34;FF1337FF&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>H_END</span><span class=p>:</span>   <span class=p>[</span><span class=n>u8</span><span class=p>;</span> <span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=n>hex</span><span class=o>!</span><span class=p>(</span><span class=s2>&#34;FFCAFEFF&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>D_START</span><span class=p>:</span>   <span class=p>[</span><span class=n>u8</span><span class=p>;</span> <span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=n>hex</span><span class=o>!</span><span class=p>(</span><span class=s2>&#34;FF7270FF&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>D_END</span><span class=p>:</span>     <span class=p>[</span><span class=n>u8</span><span class=p>;</span> <span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=n>hex</span><span class=o>!</span><span class=p>(</span><span class=s2>&#34;FFEDEDFF&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>F_START</span><span class=p>:</span> <span class=p>[</span><span class=n>u8</span><span class=p>;</span> <span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=n>hex</span><span class=o>!</span><span class=p>(</span><span class=s2>&#34;FFDEADFF&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>F_END</span><span class=p>:</span>   <span class=p>[</span><span class=n>u8</span><span class=p>;</span> <span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=n>hex</span><span class=o>!</span><span class=p>(</span><span class=s2>&#34;FFBEEFFF&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>SIG</span><span class=p>:</span>    <span class=p>[</span><span class=n>u8</span><span class=p>;</span> <span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=n>hex</span><span class=o>!</span><span class=p>(</span><span class=s2>&#34;4C554E41&#34;</span><span class=p>);</span> 
</span></span><span class=line><span class=cl><span class=k>enum</span> <span class=n>DbMode</span><span class=o>&lt;</span><span class=s1>&#39;a&gt; {</span>
</span></span><span class=line><span class=cl>    <span class=n>Append</span> <span class=p>{</span> <span class=n>existing</span><span class=p>:</span> <span class=o>&amp;</span><span class=s1>&#39;a [[u8; 8]] },</span>
</span></span><span class=line><span class=cl>    <span class=n>Create</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>fn</span> <span class=n>find_pattern</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=o>&amp;</span><span class=p>[</span><span class=n>u8</span><span class=p>],</span> <span class=n>pattern</span><span class=p>:</span> <span class=o>&amp;</span><span class=p>[</span><span class=n>u8</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Option</span><span class=o>&lt;</span><span class=n>usize</span><span class=o>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span><span class=o>.</span><span class=n>windows</span><span class=p>(</span><span class=n>pattern</span><span class=o>.</span><span class=n>len</span><span class=p>())</span><span class=o>.</span><span class=n>position</span><span class=p>(</span><span class=o>|</span><span class=n>w</span><span class=o>|</span> <span class=n>w</span> <span class=o>==</span> <span class=n>pattern</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>fn</span> <span class=n>get_input</span><span class=p>(</span><span class=n>prompt_text</span><span class=p>:</span> <span class=o>&amp;</span><span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>io</span><span class=p>::</span><span class=n>Result</span><span class=o>&lt;</span><span class=ne>String</span><span class=o>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=o>!</span><span class=p>(</span><span class=s2>&#34;{}&#34;</span><span class=p>,</span> <span class=n>prompt_text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=p>::</span><span class=n>stdout</span><span class=p>()</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span><span class=err>?</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>let</span> <span class=n>stdin</span> <span class=o>=</span> <span class=n>io</span><span class=p>::</span><span class=n>stdin</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>let</span> <span class=n>mut</span> <span class=n>line</span> <span class=o>=</span> <span class=ne>String</span><span class=p>::</span><span class=n>new</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>stdin</span><span class=o>.</span><span class=n>lock</span><span class=p>()</span><span class=o>.</span><span class=n>read_line</span><span class=p>(</span><span class=o>&amp;</span><span class=n>mut</span> <span class=n>line</span><span class=p>)</span><span class=err>?</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Ok</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>trim</span><span class=p>()</span><span class=o>.</span><span class=n>to_string</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fn</span> <span class=n>main</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=n>io</span><span class=p>::</span><span class=n>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>let</span> <span class=n>args</span><span class=p>:</span> <span class=n>Vec</span><span class=o>&lt;</span><span class=ne>String</span><span class=o>&gt;</span> <span class=o>=</span> <span class=n>env</span><span class=p>::</span><span class=n>args</span><span class=p>()</span><span class=o>.</span><span class=n>collect</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>len</span><span class=p>()</span> <span class=o>!=</span> <span class=mi>2</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>eprintln</span><span class=o>!</span><span class=p>(</span><span class=s2>&#34;Usage: {} &lt;lunadb_file&gt;&#34;</span><span class=p>,</span> <span class=n>args</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=n>process</span><span class=p>::</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>let</span> <span class=n>db_path</span> <span class=o>=</span> <span class=ne>Path</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=o>&amp;</span><span class=n>args</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=n>let</span> <span class=n>num_notes_to_create</span><span class=p>:</span> <span class=n>usize</span> <span class=o>=</span> <span class=n>loop</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>match</span> <span class=n>get_input</span><span class=p>(</span><span class=s2>&#34;How many notes do you want to create? &#34;</span><span class=p>)</span><span class=err>?</span><span class=o>.</span><span class=n>parse</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Ok</span><span class=p>(</span><span class=n>n</span><span class=p>)</span> <span class=k>if</span> <span class=n>n</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>=&gt;</span> <span class=k>break</span> <span class=n>n</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>_</span> <span class=o>=&gt;</span> <span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s2>&#34;Please enter a valid positive number.&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>db_path</span><span class=o>.</span><span class=n>exists</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>let</span> <span class=n>mut</span> <span class=n>f</span> <span class=o>=</span> <span class=n>Vec</span><span class=p>::</span><span class=n>new</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=ne>File</span><span class=p>::</span><span class=n>open</span><span class=p>(</span><span class=o>&amp;</span><span class=n>db_path</span><span class=p>)</span><span class=err>?</span><span class=o>.</span><span class=n>read_to_end</span><span class=p>(</span><span class=o>&amp;</span><span class=n>mut</span> <span class=n>f</span><span class=p>)</span><span class=err>?</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>let</span> <span class=n>keys</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>let</span> <span class=n>start</span> <span class=o>=</span> <span class=n>find_pattern</span><span class=p>(</span><span class=o>&amp;</span><span class=n>f</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>F_START</span><span class=p>)</span><span class=o>.</span><span class=n>unwrap</span><span class=p>()</span> <span class=o>+</span> <span class=n>F_START</span><span class=o>.</span><span class=n>len</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>let</span> <span class=n>end</span>   <span class=o>=</span> <span class=n>find_pattern</span><span class=p>(</span><span class=o>&amp;</span><span class=n>f</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>F_END</span><span class=p>)</span><span class=o>.</span><span class=n>unwrap</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=o>&amp;</span><span class=n>f</span><span class=p>[</span><span class=n>start</span><span class=o>..</span><span class=n>end</span><span class=p>])</span><span class=o>.</span><span class=n>chunks_exact</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                         <span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=o>|</span><span class=n>c</span><span class=o>|</span> <span class=n>c</span><span class=o>.</span><span class=n>try_into</span><span class=p>()</span><span class=o>.</span><span class=n>unwrap</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                          <span class=o>.</span><span class=n>collect</span><span class=p>::</span><span class=o>&lt;</span><span class=n>Vec</span><span class=o>&lt;</span><span class=p>[</span><span class=n>u8</span><span class=p>;</span><span class=mi>8</span><span class=p>]</span><span class=o>&gt;&gt;</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=n>let</span> <span class=n>next_id</span> <span class=o>=</span> <span class=n>get_next_id</span><span class=p>(</span><span class=o>&amp;</span><span class=n>f</span><span class=p>)</span><span class=err>?</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>let</span> <span class=p>(</span><span class=n>notes</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span><span class=p>)</span> <span class=o>=</span> <span class=n>build</span><span class=p>(</span><span class=n>DbMode</span><span class=p>::</span><span class=n>Append</span> <span class=p>{</span> <span class=n>existing</span><span class=p>:</span> <span class=o>&amp;</span><span class=n>keys</span> <span class=p>},</span> <span class=n>num_notes_to_create</span><span class=p>,</span> <span class=n>next_id</span><span class=p>)</span><span class=err>?</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>write_db</span><span class=p>(</span><span class=o>&amp;</span><span class=n>db_path</span><span class=p>,</span> <span class=n>None</span><span class=p>,</span> <span class=n>Some</span><span class=p>(</span><span class=o>&amp;</span><span class=n>f</span><span class=p>),</span> <span class=o>&amp;</span><span class=n>notes</span><span class=p>,</span> <span class=o>&amp;</span><span class=p>[])</span><span class=err>?</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s2>&#34;Appended {} notes&#34;</span><span class=p>,</span> <span class=n>num_notes_to_create</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>let</span> <span class=n>header</span> <span class=o>=</span> <span class=n>Header</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>db_name</span><span class=p>:</span>  <span class=n>get_input</span><span class=p>(</span><span class=s2>&#34;Database Name: &#34;</span><span class=p>)</span><span class=err>?</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>reg_name</span><span class=p>:</span> <span class=n>get_input</span><span class=p>(</span><span class=s2>&#34;Registered Name: &#34;</span><span class=p>)</span><span class=err>?</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>license_key</span><span class=p>:</span> <span class=n>get_input</span><span class=p>(</span><span class=s2>&#34;License Key: &#34;</span><span class=p>)</span><span class=err>?</span><span class=o>.</span><span class=n>into_bytes</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=n>let</span> <span class=p>(</span><span class=n>notes</span><span class=p>,</span> <span class=n>keys</span><span class=p>,</span> <span class=n>_</span><span class=p>)</span> <span class=o>=</span> <span class=n>build</span><span class=p>(</span><span class=n>DbMode</span><span class=p>::</span><span class=n>Create</span><span class=p>,</span> <span class=n>num_notes_to_create</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span><span class=err>?</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>write_db</span><span class=p>(</span><span class=o>&amp;</span><span class=n>db_path</span><span class=p>,</span> <span class=n>Some</span><span class=p>(</span><span class=n>header</span><span class=p>),</span> <span class=n>None</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>notes</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>keys</span><span class=p>)</span><span class=err>?</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s2>&#34;Created new DB with {} notes&#34;</span><span class=p>,</span> <span class=n>num_notes_to_create</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>Ok</span><span class=p>(())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>ƒê·ªÅ cho ta hai t·ªáp <code>main.rs</code> v√† <code>secret.lunadb</code>, v·ªõi y√™u c·∫ßu ƒë·ªçc t·ªáp secret.
T·ª´ <code>main.rs</code> th√¨ m√¨nh bi·∫øt ƒë∆∞·ª£c r·∫±ng:</p><ul><li>Ghi ch√∫ ƒë∆∞·ª£c m√£ h√≥a b·∫±ng DES-ECB</li><li>Key ƒë∆∞·ª£c l∆∞u tr·ªØ trong ph·∫ßn <code>F_START..F_END</code> (kh·ªëi 8-bytes)</li><li>M·ªói ghi ch√∫ c√≥ m·ªôt <code>key_index_field</code>.</li><li>M·∫£ng string/byte s·ª≠ d·ª•ng t√πy ch·ªânh <code>tag + LEB128 length + data format</code>.</li></ul><p>Sau ƒë√≥, m√¨nh nh·ªù chatGPT t·∫°o ra 1 c√°i decryptor th·ªèa m√£n v√† d·ª´ng khi th·∫•y flag format:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># solution.py</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>io</span> <span class=kn>import</span> <span class=n>BytesIO</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>DES</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ---- Constants (magic markers) ----</span>
</span></span><span class=line><span class=cl><span class=n>H_START</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s2>&#34;FF1337FF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>H_END</span>   <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s2>&#34;FFCAFEFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>D_START</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s2>&#34;FF7270FF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>D_END</span>   <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s2>&#34;FFEDEDFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>F_START</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s2>&#34;FFDEADFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>F_END</span>   <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s2>&#34;FFBEEFFF&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>SIG</span>     <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;LUNA&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ---- Helpers ----</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>find_pattern</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>pattern</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Find pattern inside data and return its position.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>pos</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>pattern</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>pos</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Pattern </span><span class=si>{</span><span class=n>pattern</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=si>}</span><span class=s2> not found&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>pos</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>read_uleb128</span><span class=p>(</span><span class=n>f</span><span class=p>:</span> <span class=n>BytesIO</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Read unsigned LEB128 integer.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span><span class=p>,</span> <span class=n>shift</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>b</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>EOFError</span><span class=p>(</span><span class=s2>&#34;Unexpected EOF in LEB128&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>|=</span> <span class=p>(</span><span class=n>b</span> <span class=o>&amp;</span> <span class=mh>0x7F</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=n>shift</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>b</span> <span class=o>&amp;</span> <span class=mh>0x80</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=n>shift</span> <span class=o>+=</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>read_string</span><span class=p>(</span><span class=n>f</span><span class=p>:</span> <span class=n>BytesIO</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Read custom encoded string (flag + LEB128 + data).&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>flag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>EOFError</span><span class=p>(</span><span class=s2>&#34;Unexpected EOF reading string&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>flag</span> <span class=o>==</span> <span class=mh>0x00</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>flag</span> <span class=o>==</span> <span class=mh>0x0b</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>length</span> <span class=o>=</span> <span class=n>read_uleb128</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>length</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s2>&#34;replace&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>flag</span> <span class=o>==</span> <span class=mh>0x0c</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>length</span> <span class=o>=</span> <span class=n>read_uleb128</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>length</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s2>&#34;replace&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Invalid string flag </span><span class=si>{</span><span class=n>flag</span><span class=si>:</span><span class=s2>#x</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>read_bytes</span><span class=p>(</span><span class=n>f</span><span class=p>:</span> <span class=n>BytesIO</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Read custom encoded byte string.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>flag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>EOFError</span><span class=p>(</span><span class=s2>&#34;Unexpected EOF reading bytes&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>flag</span> <span class=o>==</span> <span class=mh>0x00</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>flag</span> <span class=o>==</span> <span class=mh>0x0c</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>length</span> <span class=o>=</span> <span class=n>read_uleb128</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>flag</span> <span class=o>==</span> <span class=mh>0x0b</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>length</span> <span class=o>=</span> <span class=n>read_uleb128</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Invalid byte flag </span><span class=si>{</span><span class=n>flag</span><span class=si>:</span><span class=s2>#x</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>des_decrypt</span><span class=p>(</span><span class=n>key</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Decrypt DES-ECB with padding removal.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>cipher</span> <span class=o>=</span> <span class=n>DES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>DES</span><span class=o>.</span><span class=n>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pt</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>padlen</span> <span class=o>=</span> <span class=n>pt</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=mi>1</span> <span class=o>&lt;=</span> <span class=n>padlen</span> <span class=o>&lt;=</span> <span class=mi>8</span> <span class=ow>and</span> <span class=n>pt</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=nb>bytes</span><span class=p>([</span><span class=n>padlen</span><span class=p>])</span><span class=o>*</span><span class=n>padlen</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>pt</span> <span class=o>=</span> <span class=n>pt</span><span class=p>[:</span><span class=o>-</span><span class=n>padlen</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>pt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ---- Main LunaDB Parser ----</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>parse_lunadb</span><span class=p>(</span><span class=n>filename</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Validate</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>data</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=n>SIG</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Not a valid LunaDB file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Extract sections</span>
</span></span><span class=line><span class=cl>    <span class=n>d_start</span> <span class=o>=</span> <span class=n>find_pattern</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>D_START</span><span class=p>)</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=n>D_START</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>d_end</span>   <span class=o>=</span> <span class=n>find_pattern</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>D_END</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>f_start</span> <span class=o>=</span> <span class=n>find_pattern</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>F_START</span><span class=p>)</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=n>F_START</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>f_end</span>   <span class=o>=</span> <span class=n>find_pattern</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>F_END</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>notes_section</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>d_start</span><span class=p>:</span><span class=n>d_end</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>keys_section</span>  <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>f_start</span><span class=p>:</span><span class=n>f_end</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Parse keys</span>
</span></span><span class=line><span class=cl>    <span class=n>keys</span> <span class=o>=</span> <span class=p>[</span><span class=n>keys_section</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>8</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>keys_section</span><span class=p>),</span> <span class=mi>8</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Parse notes</span>
</span></span><span class=line><span class=cl>    <span class=n>fnotes</span> <span class=o>=</span> <span class=n>BytesIO</span><span class=p>(</span><span class=n>notes_section</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>notes</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>fnotes</span><span class=o>.</span><span class=n>tell</span><span class=p>()</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>notes_section</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>note_id</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s2>&#34;&lt;H&#34;</span><span class=p>,</span> <span class=n>fnotes</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>2</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>access_token</span> <span class=o>=</span> <span class=n>read_string</span><span class=p>(</span><span class=n>fnotes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>first_name</span>   <span class=o>=</span> <span class=n>read_string</span><span class=p>(</span><span class=n>fnotes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>last_name</span>    <span class=o>=</span> <span class=n>read_string</span><span class=p>(</span><span class=n>fnotes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>email</span>        <span class=o>=</span> <span class=n>read_string</span><span class=p>(</span><span class=n>fnotes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>title</span>        <span class=o>=</span> <span class=n>read_string</span><span class=p>(</span><span class=n>fnotes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>key_index_field</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s2>&#34;&lt;Q&#34;</span><span class=p>,</span> <span class=n>fnotes</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>8</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>encrypted_content</span> <span class=o>=</span> <span class=n>read_bytes</span><span class=p>(</span><span class=n>fnotes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>creation_date</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s2>&#34;&lt;Q&#34;</span><span class=p>,</span> <span class=n>fnotes</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>8</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>modification_date</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s2>&#34;&lt;Q&#34;</span><span class=p>,</span> <span class=n>fnotes</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>8</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>suspended</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s2>&#34;&lt;B&#34;</span><span class=p>,</span> <span class=n>fnotes</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>1</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Which key was used?</span>
</span></span><span class=line><span class=cl>        <span class=n>plaintext</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>key_index_field</span> <span class=o>!=</span> <span class=mh>0xFFFFFFFFFFFFFFFF</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>idx</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>64</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>key_index_field</span> <span class=o>&amp;</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>idx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>idx</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>keys</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                            <span class=n>plaintext</span> <span class=o>=</span> <span class=n>des_decrypt</span><span class=p>(</span><span class=n>keys</span><span class=p>[</span><span class=n>idx</span><span class=p>],</span> <span class=n>encrypted_content</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s2>&#34;replace&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                            <span class=n>plaintext</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&lt;decrypt error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&gt;&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>plaintext</span> <span class=o>=</span> <span class=s2>&#34;&lt;no content&gt;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>notes</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=n>note_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;title&#34;</span><span class=p>:</span> <span class=n>title</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;author&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>first_name</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>last_name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;email&#34;</span><span class=p>:</span> <span class=n>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>plaintext</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;suspended&#34;</span><span class=p>:</span> <span class=n>suspended</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;access_token&#34;</span><span class=p>:</span> <span class=n>access_token</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>notes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ---- Run ----</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=kn>import</span> <span class=nn>sys</span><span class=o>,</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Usage: </span><span class=si>{</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2> &lt;lunadb_file&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>notes</span> <span class=o>=</span> <span class=n>parse_lunadb</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>notes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=&#34;</span><span class=o>*</span><span class=mi>40</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Note ID: </span><span class=si>{</span><span class=n>n</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Title: </span><span class=si>{</span><span class=n>n</span><span class=p>[</span><span class=s1>&#39;title&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Author: </span><span class=si>{</span><span class=n>n</span><span class=p>[</span><span class=s1>&#39;author&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> &lt;</span><span class=si>{</span><span class=n>n</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Access Token: </span><span class=si>{</span><span class=n>n</span><span class=p>[</span><span class=s1>&#39;access_token&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Suspended: </span><span class=si>{</span><span class=n>n</span><span class=p>[</span><span class=s1>&#39;suspended&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Content:</span><span class=se>\n</span><span class=si>{</span><span class=n>n</span><span class=p>[</span><span class=s1>&#39;content&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;HOLACTF{&#34;</span> <span class=ow>in</span> <span class=n>n</span><span class=p>[</span><span class=s1>&#39;content&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span></code></pre></div><p>K·∫øt qu·∫£ tr·∫£ v·ªÅ:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Note</span><span class=w> </span><span class=n>ID</span><span class=p>:</span><span class=w> </span><span class=n>2976</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nl>Title</span><span class=p>:</span><span class=w> </span><span class=n>coding</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nl>Author</span><span class=p>:</span><span class=w> </span><span class=n>Candice</span><span class=w> </span><span class=n>Debroux</span><span class=w> </span><span class=o>&lt;</span><span class=n>Candice_Debroux</span><span class=nd>@gmx.com</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Access</span><span class=w> </span><span class=n>Token</span><span class=p>:</span><span class=w> </span><span class=n>7zVjVolwo0ZOXwnbexQEx7YsxyelEekQ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nl>Suspended</span><span class=p>:</span><span class=w> </span><span class=n>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nl>Content</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Programming</span><span class=w> </span><span class=n>today</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>race</span><span class=w> </span><span class=n>between</span><span class=w> </span><span class=n>software</span><span class=w> </span><span class=n>engineers</span><span class=w> </span><span class=n>striving</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>build</span><span class=w> </span><span class=n>bigger</span><span class=w> </span><span class=n>and</span><span class=w> </span><span class=n>better</span><span class=w> </span><span class=n>idiot</span><span class=o>-</span><span class=n>proof</span><span class=w> </span><span class=n>programs</span><span class=w> </span><span class=n>and</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>Universe</span><span class=w> </span><span class=n>trying</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>produce</span><span class=w> </span><span class=n>bigger</span><span class=w> </span><span class=n>and</span><span class=w> </span><span class=n>better</span><span class=w> </span><span class=n>idiots</span><span class=p>.</span><span class=w> </span><span class=n>So</span><span class=w> </span><span class=n>far</span><span class=p>,</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>Universe</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>winning</span><span class=p>.</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>========================================</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Note</span><span class=w> </span><span class=n>ID</span><span class=p>:</span><span class=w> </span><span class=n>7272</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nl>Title</span><span class=p>:</span><span class=w> </span><span class=n>This</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>real</span><span class=w> </span><span class=n>flag</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nl>Author</span><span class=p>:</span><span class=w> </span><span class=n>lunaere</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>secret</span><span class=w> </span><span class=n>agent</span><span class=w> </span><span class=o>&lt;</span><span class=n>luna</span><span class=nd>@osu.me</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Access</span><span class=w> </span><span class=n>Token</span><span class=p>:</span><span class=w> </span><span class=n>ZEBD9aJy8iMuGBqUaa1yUKoXvddvGLra</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nl>Suspended</span><span class=p>:</span><span class=w> </span><span class=n>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nl>Content</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>HOLACTF</span><span class=p>{</span><span class=n>4_c0Ol_Cu5t0m_f1lE_5truC7</span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><pre><code>Flag: HOLACTF{4_c0Ol_Cu5t0m_f1lE_5truC7}
</code></pre><h3 id=2-weird-png><a class=header-anchor href=#2-weird-png></a>2. Weird PNG</h3><p><img src=https://hackmd.io/_uploads/Bkx6VSb5eg.png alt=image></p><p>ƒê·ªÅ cho ta m·ªôt file <code>weird.png</code> v√† khi ph√¢n t√≠ch, ta ƒë∆∞·ª£c:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=err>‚ûú</span>  <span class=nx>build</span> <span class=nx>git</span><span class=o>:</span><span class=p>(</span><span class=nx>master</span><span class=p>)</span> <span class=err>‚úó</span> <span class=nx>xxd</span> <span class=nx>weird</span><span class=p>.</span><span class=nx>png</span>
</span></span><span class=line><span class=cl><span class=mi>00000000</span><span class=o>:</span> <span class=mi>8950</span> <span class=mf>4e47</span> <span class=mi>0</span><span class=nx>d0a</span> <span class=mi>1</span><span class=nx>a0a</span> <span class=mi>0000</span> <span class=mi>000</span><span class=nx>d</span> <span class=mi>4948</span> <span class=mi>4452</span>  <span class=p>.</span><span class=nx>PNG</span><span class=p>........</span><span class=nx>IHDR</span>
</span></span><span class=line><span class=cl><span class=mi>00000010</span><span class=o>:</span> <span class=mi>0000</span> <span class=mi>00</span><span class=nx>ff</span> <span class=mi>0000</span> <span class=mi>00</span><span class=nx>ff</span> <span class=mi>0802</span> <span class=mi>0000</span> <span class=mi>0000</span> <span class=mi>0000</span>  <span class=p>................</span>
</span></span><span class=line><span class=cl><span class=mi>00000020</span><span class=o>:</span> <span class=mi>008</span><span class=nx>c</span> <span class=nx>c88e</span> <span class=nx>d88e</span> <span class=nx>c0b8</span> <span class=nx>c007</span> <span class=mi>8</span><span class=nx>ed0</span> <span class=nx>bc00</span> <span class=mi>7</span><span class=nx>c83</span>  <span class=p>..............</span><span class=o>|</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=mi>00000030</span><span class=o>:</span> <span class=nx>ec01</span> <span class=mf>89e5</span> <span class=nx>c646</span> <span class=mi>0000</span> <span class=nx>b85f</span> <span class=mi>7</span><span class=nx>d50</span> <span class=nx>b832</span> <span class=mi>3750</span>  <span class=p>.....</span><span class=nx>F</span><span class=p>...</span><span class=nx>_</span><span class=p>}</span><span class=nx>P</span><span class=p>.</span><span class=mi>27</span><span class=nx>P</span>
</span></span><span class=line><span class=cl><span class=mi>00000040</span><span class=o>:</span> <span class=nx>b85f</span> <span class=mi>3750</span> <span class=nx>b821</span> <span class=mi>4035</span> <span class=mi>1212</span> <span class=mi>50</span><span class=nx>b8</span> <span class=nx>bccc</span> <span class=mi>3588</span>  <span class=p>.</span><span class=nx>_7P</span><span class=p>.</span><span class=o>!</span><span class=err>@</span><span class=mf>5.</span><span class=p>.</span><span class=nx>P</span><span class=p>...</span><span class=mf>5.</span>
</span></span><span class=line><span class=cl><span class=mi>00000050</span><span class=o>:</span> <span class=mi>8850</span> <span class=nx>b8a8</span> <span class=nx>a935</span> <span class=mi>9999</span> <span class=mi>50</span><span class=nx>b8</span> <span class=mi>5</span><span class=nx>b78</span> <span class=mi>350</span><span class=nx>f</span> <span class=mi>2750</span>  <span class=p>.</span><span class=nx>P</span><span class=p>...</span><span class=mf>5.</span><span class=p>.</span><span class=nx>P</span><span class=p>.[</span><span class=nx>x5</span><span class=p>.</span><span class=err>&#39;</span><span class=nx>P</span>
</span></span><span class=line><span class=cl><span class=mi>00000060</span><span class=o>:</span> <span class=nx>b807</span> <span class=mi>5</span><span class=nx>c35</span> <span class=mi>3713</span> <span class=mi>50</span><span class=nx>b8</span> <span class=mi>2815</span> <span class=mi>3577</span> <span class=mi>7750</span> <span class=nx>b85c</span>  <span class=p>..</span><span class=err>\</span><span class=mf>57.</span><span class=nx>P</span><span class=p>.(.</span><span class=mi>5</span><span class=nx>wwP</span><span class=p>.</span><span class=o>\</span>
</span></span><span class=line><span class=cl><span class=mi>00000070</span><span class=o>:</span> <span class=mi>3035</span> <span class=mi>6969</span> <span class=mi>50</span><span class=nx>b8</span> <span class=mi>5348</span> <span class=mi>3560</span> <span class=mi>0950</span> <span class=nx>b864</span> <span class=mi>5935</span>  <span class=mi>05</span><span class=nx>iiP</span><span class=p>.</span><span class=nx>SH5</span><span class=sb>`.P.dY5
</span></span></span><span class=line><span class=cl><span class=sb>00000080: 2222 50b8 5245 3511 1150 b86d 0235 2143  &#34;&#34;P.RE5..P.m.5!C
</span></span></span><span class=line><span class=cl><span class=sb>00000090: 50b8 7c5d 3534 1250 89e5 8a46 0045 08c0  P.|]54.P...F.E..
</span></span></span><span class=line><span class=cl><span class=sb>000000a0: 740a b40e b700 b307 cd10 ebee ebfe 0000  t...............
</span></span></span><span class=line><span class=cl><span class=sb>000000b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>...
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>000001f0: 0000 0000 0000 0000 0000 0000 0000 55aa  ..............U.
</span></span></span></code></pre></div><p>·ªû ƒë√¢y, sau IHDR ƒë√°ng ra ph·∫£i c√≥ CRC r·ªìi t·ªõi c√°c chunk nh∆∞ IDAT, IEND. Tuy nhi√™n, ta l·∫°i th·∫•y byte nh∆∞ m√£ m√°y x86 v√† khi h·ªèi chatGPT th√¨ ƒë∆∞·ª£c tr·∫£ l·ªùi l√†: File kh√¥ng ph·∫£i PNG th·∫≠t, m√† l√† MBR boot sector 512 bytes ƒë∆∞·ª£c b·ªçc ƒë·∫ßu PNG h·ª£p l·ªá.
V√¨ v·∫≠y m√¨nh ƒë√£ l·∫•y chu·ªói ƒë∆∞·ª£c in ra v√† nh·ªù AI t·∫°o script python gi·∫£i m√£:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;8c c8 8e d8 8e c0 b8 c0 07 8e d0 bc 00 7c 83 ec 01 89 e5 c6 46 00 00 &#34;</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;b8 5f 7d 50 b8 32 37 50 b8 5f 37 50 b8 21 40 35 12 12 50 b8 bc cc 35 &#34;</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;88 88 50 b8 a8 a9 35 99 99 50 b8 5b 78 35 0f 27 50 b8 07 5c 35 37 13 &#34;</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;50 b8 28 15 35 77 77 50 b8 5c 30 35 69 69 50 b8 53 48 35 60 09 50 b8 &#34;</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;64 59 35 22 22 50 b8 52 45 35 11 11 50 b8 6d 02 35 21 43 50 b8 7c 5d &#34;</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;35 34 12 50 89 e5 8a 46 00 45 08 c0 74 0a b4 0e b4 00 b3 07 cd 10 eb ee eb fe&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>ax</span><span class=o>=</span><span class=kc>None</span><span class=p>;</span> <span class=n>words</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span><span class=o>=</span><span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>b</span><span class=o>==</span><span class=mh>0xB8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ax</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span> <span class=o>|</span> <span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span><span class=o>&lt;&lt;</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span><span class=o>+=</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>b</span><span class=o>==</span><span class=mh>0x35</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>imm</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span> <span class=o>|</span> <span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span><span class=o>&lt;&lt;</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>ax</span> <span class=o>=</span> <span class=p>(</span><span class=n>ax</span> <span class=o>^</span> <span class=n>imm</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xffff</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span><span class=o>+=</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>b</span><span class=o>==</span><span class=mh>0x50</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>words</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>ax</span> <span class=o>&amp;</span> <span class=mh>0xffff</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># gh√©p theo th·ª© t·ª± pop (ƒë·∫£o)</span>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(((</span><span class=n>w</span> <span class=o>&amp;</span> <span class=mh>0xff</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=p>((</span><span class=n>w</span><span class=o>&gt;&gt;</span><span class=mi>8</span><span class=p>)</span><span class=o>&amp;</span><span class=mh>0xff</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;little&#39;</span><span class=p>))</span> <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=nb>reversed</span><span class=p>(</span><span class=n>words</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>s</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;latin1&#39;</span><span class=p>))</span>
</span></span></code></pre></div><pre><code>Flag: HOLACTF{3A5Y_b0OT_104D3R_727_}
</code></pre><h2 id=osint><a class=header-anchor href=#osint></a>Osint</h2><h3 id=1-ehc-is-my-family><a class=header-anchor href=#1-ehc-is-my-family></a>1. EHC is my family</h3><p><img src=https://hackmd.io/_uploads/Sy8IUr-qxe.png alt=image>
<img src=https://hackmd.io/_uploads/rknuIB-5gl.jpg alt=danang_ehc></p><p>ƒê·ªÉ √Ω b√™n tr√°i m√¨nh th·∫•y c√≥ logo c·ªßa tr∆∞·ªùng VKU, n√™n bi·∫øt ngay ƒë√≥ l√† Tr∆∞·ªùng ƒê·∫°i h·ªçc C√¥ng ngh·ªá Th√¥ng tin v√† Truy·ªÅn th√¥ng Vi·ªát H√†n.</p><pre><code>Flag: HOLACTF{truong_dai_hoc_cong_nghe_thong_tin_va_truyen_thong_viet_han}
</code></pre></div><footer class=article-footer><blockquote class=article-copyright><p><strong><span class="icon-user icon"></span>Author: </strong>r1muru</p><p><strong><span class="icon-link icon"></span>Permalink: </strong><a href=https://r1muru2006.github.io/post/holactf2025/>https://r1muru2006.github.io/post/holactf2025/</a></p><p><strong><span class="icon-copyright icon"></span>License: </strong>All articles on this blog are licensed under the <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh rel="noopener nofollow noreferrer" target=_blank><span class=icon-creative-commons></span>BY-NC-SA</a> license agreement unless otherwise stated. Please indicate the source when reprinting!</p><span class="icon-creative-commons article-copyright-bg"></span></blockquote><ul class=article-tag-list itemprop=keywords><li class=article-tag-list-item data-aos=zoom-in><a class=article-tag-list-link href=/tags/ctf rel=tag>CTF</a></li><li class=article-tag-list-item data-aos=zoom-in><a class=article-tag-list-link href=/tags/cryptography rel=tag>CRYPTOGRAPHY</a></li><li class=article-tag-list-item data-aos=zoom-in><a class=article-tag-list-link href=/tags/miscellaneous rel=tag>MISCELLANEOUS</a></li><li class=article-tag-list-item data-aos=zoom-in><a class=article-tag-list-link href=/tags/osint rel=tag>OSINT</a></li></ul></footer></div><nav id=article-nav aria-label="Article navigation" data-aos=fade-up><div class="article-nav-link-wrap left"><img data-src=/images/Certificate.png data-sizes=auto alt="NahamCon CTF 2025" class=lazyload><a href=/post/nahamconctf2025/ aria-label="Prev:NahamCon CTF 2025" title="Prev:NahamCon CTF 2025"></a><div class=article-nav-caption>Prev</div><h3 class=article-nav-title>NahamCon CTF 2025</h3></div><div class="article-nav-link-wrap right"><img data-src=/images/imaginary.jpg data-sizes=auto alt="ImaginaryCTF 2025" class=lazyload><a href=/post/imaginaryctf2025/ aria-label="Next:ImaginaryCTF 2025" title="Next:ImaginaryCTF 2025"></a><div class=article-nav-caption>Next</div><h3 class=article-nav-title>ImaginaryCTF 2025</h3></div></nav></article></section></div><footer id=footer aria-label="Site footer"><div style=width:100%;overflow:hidden><div class=footer-line></div></div><div id=footer-info><div><span class=icon-copyright></span>2024-2025<span class="footer-info-sep rotate"></span>
r1muru</div><div>Powered by&nbsp;<a href=https://gohugo.io/ target=_blank rel="noopener nofollow noreferrer">Hugo</a>&nbsp; Theme.<a href=https://github.com/D-Sketon/hugo-theme-reimu target=_blank rel="noopener nofollow noreferrer">Reimu</a></div><div><span class=icon-brush>&nbsp;30.4k</span>
&nbsp;|&nbsp;
<span class=icon-coffee>&nbsp;02:29</span></div><div><span class=icon-eye></span>
<span id=busuanzi_container_site_pv>Number of visits&nbsp;<span id=busuanzi_value_site_pv></span></span>
&nbsp;|&nbsp;
<span class=icon-user></span>
<span id=busuanzi_container_site_uv>Number of visitors&nbsp;<span id=busuanzi_value_site_uv></span></span></div></div></footer><div class=sidebar-top><div class="sidebar-top-taichi rotate"></div><div class=arrow-up></div></div><div id=mask class=hide></div></div><nav id=mobile-nav aria-label="Mobile navigation"><div class=sidebar-wrap><div class=sidebar-toc-sidebar><h3 class=toc-title>Contents</h3><div class="sidebar-toc-wrapper toc-div-class"><nav id=TableOfContents><ul><li><a href=#crypto>Crypto</a><ul><li><a href=#1-cs2rtrash>1. Cs2RTrash</a></li><li><a href=#2-enigmahardcode>2. EnigmaHardCode</a></li><li><a href=#3-imlosingyou>3. ImLosingYou</a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#1-lunadb>1. LunaDB</a></li><li><a href=#2-weird-png>2. Weird PNG</a></li></ul></li><li><a href=#osint>Osint</a><ul><li><a href=#1-ehc-is-my-family>1. EHC is my family</a></li></ul></li></ul></nav></div></div><div class="sidebar-common-sidebar hidden"><div class=sidebar-author><img data-src=/avatar/avatar.png data-sizes=auto alt=r1muru class=lazyload><div class=sidebar-author-name>r1muru</div><div class=sidebar-description>Life is not fair, get used to it</div></div><div class=sidebar-state><div class=sidebar-state-article><div>Posts</div><div class=sidebar-state-number>11</div></div><a class=sidebar-state-category href=/categories/ aria-label=sidebar-state-category-link><div>Categories</div><div class=sidebar-state-number>3</div></a><a class=sidebar-state-tag href=/tags/ aria-label=sidebar-state-tag-link><div>Tags</div><div class=sidebar-state-number>8</div></a></div><div class=sidebar-social><div class="icon-discord sidebar-social-icon"><a href=https://discordapp.com/users/r1muru2006 itemprop=url target=_blank aria-label=discord rel="noopener nofollow noreferrer"></a></div><div class="icon-email sidebar-social-icon"><a href=cuongchu200@gmail.com itemprop=url target=_blank aria-label=email rel="noopener nofollow noreferrer"></a></div><div class="icon-facebook sidebar-social-icon"><a href=https://www.facebook.com/chu.cuong.732399 itemprop=url target=_blank aria-label=facebook rel="noopener nofollow noreferrer"></a></div><div class="icon-github sidebar-social-icon"><a href=https://github.com/r1muru2006 itemprop=url target=_blank aria-label=github rel="noopener nofollow noreferrer"></a></div><div class="icon-instagram sidebar-social-icon"><a href=https://www.instagram.com/r1murun0pr0 itemprop=url target=_blank aria-label=instagram rel="noopener nofollow noreferrer"></a></div></div><div class=sidebar-menu><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/ aria-label=Home></a><div class='sidebar-menu-icon icon'>&#xf015;</div><div class=sidebar-menu-link>Home</div></div><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/archives aria-label=Archives></a><div class='sidebar-menu-icon icon'>&#xf187;</div><div class=sidebar-menu-link>Archives</div></div><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/about aria-label=About></a><div class='sidebar-menu-icon icon'>&#xf007;</div><div class=sidebar-menu-link>About</div></div></div></div></div><div class=sidebar-btn-wrapper><div class="sidebar-toc-btn current"></div><div class=sidebar-common-btn></div></div></nav></div><div class=site-search><div class="reimu-popup popup"><div class=reimu-search><div class=reimu-search-input-icon></div><div id=reimu-search-input></div><div class=popup-btn-close></div></div><div class=reimu-results><div id=reimu-stats></div><div id=reimu-hits></div><div id=reimu-pagination class=reimu-pagination></div></div><img class=reimu-bg src=/images/reimu.png></div></div><script src=https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js integrity=sha384-3gT/vsepWkfz/ff7PpWNUeMzeWoH3cDhm/A8jM7ouoAK0/fP/9bcHHR5kHq2nf+e crossorigin=anonymous></script><script src=https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js integrity=sha384-J08i8An/QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q crossorigin=anonymous></script><script src=/js/main.js integrity crossorigin=anonymous></script><script src=/js/aos.js integrity crossorigin=anonymous></script><script>var aosInit=()=>{AOS.init({duration:1e3,easing:"ease",once:!0,offset:50})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",aosInit):aosInit()</script><script src=/js/pjax_main.js integrity crossorigin=anonymous data-pjax></script><script>var ALGOLIA_CONFIG={logo:"/images/algolia_logo.svg",algolia:{applicationID:"RAY96S32HW",apiKey:"53e71efc7b6ca695cdb630e780aeae50",indexName:"my-blog",hits:{per_page:parseInt("10")},labels:{input_placeholder:"Search.....",hits_empty:"No results found for „Äå${query}„Äç",hits_stats:"Found ${hits} results (in ${time} ms)"}}}</script><script src=https://npm.webcache.cn/algoliasearch@4.17.1/dist/algoliasearch-lite.umd.js deferintegrity=sha384-xvLS0jfKuoREs7pqkRI/OI8GcqohO5S+jQz7ZBtQXnsXmD+9jDOOY4cL6dCPzlrk crossorigin=anonymous></script><script src=https://npm.webcache.cn/@reimujs/instantsearch.js@4.57.0-beta.1/dist/instantsearch.production.min.js deferintegrity=sha384-aagKMe8nkqaP2DYQc8kkYOL5l+M5Q2WH/Uhr4teOh0Ybp0RZj0kUSDm45qPikMjK crossorigin=anonymous></script><script src=/js/algolia_search.js integrity crossorigin=anonymous></script><script src=https://npm.webcache.cn/mouse-firework@0.1.1/dist/index.umd.js integrity=sha384-8LyaidD9GPxQQgLJO/WRw/O2h3BoNq/ApI/ecpvM6RsrCz2qP2ppBXUKihP4V/2d crossorigin=anonymous></script><script>if((!!1||!window.matchMedia("(max-width: 768px)").matches)&&window.firework){const e=JSON.parse('{"excludeelements":["a","button"],"particles":[{"colors":["var(--red-1)","var(--red-2)","var(--red-3)","var(--red-4)"],"duration":[1200,1800],"easing":"easeOutExpo","move":["emit"],"number":20,"shape":"circle","shapeOptions":{"alpha":[0.3,0.5],"radius":[16,32]}},{"colors":["var(--red-0)"],"duration":[1200,1800],"easing":"easeOutExpo","move":["diffuse"],"number":1,"shape":"circle","shapeOptions":{"alpha":[0.2,0.5],"lineWidth":6,"radius":20}}]}');e.excludeElements=e.excludeelements,delete e.excludeelements,window.firework(e)}</script><script src=https://npm.webcache.cn/theme-shokax-pjax@0.0.3/dist/index.umd.js integrity=sha384-xneY1WY8hOfUzswrE4CrYq35N4BdVcxqxwHPr9zawE/jMSCxD+jAPU55x/jj3wlf crossorigin=anonymous></script><script src=/js/pjax.js integrity crossorigin=anonymous></script><div id=lazy-script><div><script data-pjax>window.REIMU_POST={author:"r1muru",title:"HOLACTF 2025",url:"https://r1muru2006.github.io/post/holactf2025/",description:"Sau ƒë√¢y l√† nh·ªØng b√†i m√¨nh l√†m ƒë∆∞·ª£c trong th·ªùi gian c·ªßa gi·∫£i v·ªõi t·ªïng l√† 6 b√†i v·ªõi 3 b√†i crypto, 2 b√†i misc v√† 1 b√†i osint.",cover:"https://r1muru2006.github.io/images/holactf.jpg"}</script><script src=/js/insert_highlight.js integrity crossorigin=anonymous data-pjax></script><script src=/js/tabs.js integrity crossorigin=anonymous data-pjax></script><script type=module data-pjax>const PhotoSwipeLightbox = (await safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe-lightbox.esm.min.js", "sha384-DiL6M\/gG\u002bwmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF\/N6lrZi\/")).default;const initPswp = (gallery, children) => {
          if (_$$(`${gallery} ${children}`).length > 0) {
            new PhotoSwipeLightbox({
              gallery,
              children,pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")}).init();
          }
        }
        const pswp = () => {
          initPswp('.article-entry', 'a.article-gallery-item');
          initPswp('.article-gallery', 'a.article-gallery-item');
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script><script src=https://npm.webcache.cn/katex@0.16.24/dist/katex.min.js data-pjaxintegrity=sha384-MWNUH0WmtsYGhn2cbH6ELRCbf9LG3QDqCC+gqPB3IBNO35xjZK3Ejb6oONRpDbPg crossorigin=anonymous></script><script src=https://npm.webcache.cn/katex@0.16.24/dist/contrib/auto-render.min.js data-pjaxintegrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous></script><script data-pjax>var renderMath=()=>{if(!window.renderMathInElement)return;window.renderMathInElement(_$("article"),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",renderMath,{once:!0}):renderMath()</script></div></div><script src=https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js asyncintegrity=sha384-0M75wtSkhjIInv4coYlaJU83+OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id+S crossorigin=anonymous></script><script>"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(e=>{for(let t of e)t.unregister()})</script><script>const reimuCopyright=String.raw`
   ______     ______     __     __    __     __  __    
  /\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
  \ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
   \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
    \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                    
  `;console.log(String.raw`%c ${reimuCopyright}`,"color: #ff5252;"),console.log("%c Theme.Reimu %c https://github.com/D-Sketon/hugo-theme-reimu ","color: white; background: #ff5252; padding:5px 0;","padding:4px;border:1px solid #ff5252;")</script><script src=https://npm.webcache.cn/aplayer@1.10.1/dist/APlayer.min.js integrity=sha384-gdGYZwHnfJM54evoZhpO0s6ZF5BQiybkiyW7VXr+h5UfruuRL/aORyw+5+HZoU6e crossorigin=anonymous></script><script>if(!!1||!window.matchMedia("(max-width: 768px)").matches){if(window.matchMedia("(max-width: 959px)").matches){const e=_$("meting-js");if(e){e.setAttribute("fixed","true");const t=e.parentNode?.parentNode;t?.tagName==="ASIDE"&&(e.parentNode.removeChild(e),document.body.appendChild(e))}}const e=document.createElement("script");e.src="https://npm.webcache.cn/meting@2.0.1/dist/Meting.min.js",e.integrity="sha384-ASVlpKF80A22OXTK3tfEjZm1EL6uFMKIC4p8+0maanw1S/IyB+Y4JG+ZDU7GpKE8",e.crossOrigin="anonymous",document.body.appendChild(e)}</script></body></html>