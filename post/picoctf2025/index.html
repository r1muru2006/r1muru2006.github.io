<!doctype html><html lang=en-us data-theme-mode=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>picoCTF 2025 | r1muru</title><meta name=description content="Blog đầu nên mình sẽ lấy giải lần đầu mình chơi cùng team aespaFanClub :3"><script>window.siteConfig=JSON.parse('{"anchor_icon":null,"base":"https://r1muru2006.github.io/","clipboard":{"copyright":{"count":50,"enable":false,"license_type":"by-nc-sa"},"fail":{"en":"Copy failed (ﾟ⊿ﾟ)ﾂ","ja":"コピー失敗 (ﾟ⊿ﾟ)ﾂ","pt-br":"Falha ao copiar (ﾟ⊿ﾟ)ﾂ","zh-cn":"复制失败 (ﾟ⊿ﾟ)ﾂ","zh-tw":"複製失敗 (ﾟ⊿ﾟ)ﾂ"},"success":{"en":"Copy successfully (*^▽^*)","ja":"コピー成功 (*^▽^*)","pt-br":"Copiado com sucesso (*^▽^*)","zh-cn":"复制成功 (*^▽^*)","zh-tw":"複製成功 (*^▽^*)"}},"code_block":{"expand":true},"icon_font":"4552607_4k4bc36ef96","outdate":{"daysago":180,"enable":false,"message":{"en":"This article was last updated on {time}. Please note that the content may no longer be applicable.","ja":"この記事は最終更新日：{time}。記載内容が現在有効でない可能性がありますのでご注意ください。","pt-br":"Este artigo foi atualizado pela última vez em {time}. Observe que o conteúdo pode não ser mais aplicável.","zh-cn":"本文最后更新于 {time}，请注意文中内容可能已不适用。","zh-tw":"本文最後更新於 {time}，請注意文中內容可能已不適用。"}}}')</script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap" media=print onload='this.media="all"'><link rel=preload href=//at.alicdn.com/t/c/font_4552607_4k4bc36ef96.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=stylesheet href=/css/loader.min.ac746e154f756f8220326eeb52a719f142ab038be5a8ddf30ea5ef15ef2356ea.css><meta property="og:type" content="website"><meta property="og:title" content="picoCTF 2025 | r1muru"><meta property="og:description" content="Blog đầu nên mình sẽ lấy giải lần đầu mình chơi cùng team aespaFanClub :3"><meta property="og:url" content="https://r1muru2006.github.io/post/picoctf2025/"><meta property="og:site_name" content="r1muru's blog"><meta property="og:image" content="/images/picoCTF.png"><meta property="article:author" content="r1muru"><meta property="article:published_time" content="2025-03-22T13:52:19+07:00"><meta property="article:modified_time" content="2025-03-22T13:52:19+07:00"><meta property="article:tag" content="CTFCryptography"><meta name=twitter:card content="summary"><meta name=twitter:image content="/images/picoCTF.png"><link rel="shortcut icon" href=/favicon.ico><link rel=stylesheet href=/css/main.min.1ec99443efbe3fab99cb9865562dd3e2ea79fa96c6e31d7cefc6bd117860ed4f.css><link rel=preload as=style href=https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css integrity=sha384-IfxC36XL/toUyJ939C73PcgMuRzAZuIzZxE38drsmO5p6jD7ei+Zx/1oA/0l8ysE crossorigin=anonymous onload='this.onload=null,this.rel="stylesheet"'><link rel=preload as=style href=https://npm.webcache.cn/katex@0.16.24/dist/katex.min.css integrity=sha384-tTgKLjMYmJr94v8qu2PE5MUGSMbyN2xiH266JUB3gpm8vnnJywd1dWSOEfrFz+YI crossorigin=anonymous onload='this.onload=null,this.rel="stylesheet"'><script src=https://npm.webcache.cn/pace-js@1.2.4/pace.min.js integrity=sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8 crossorigin=anonymous></script><link rel=stylesheet href=https://npm.webcache.cn/@reimujs/aos@0.1.2/dist/aos.css integrity=sha384-GMRP93c6Hkz9JVKGAuRR3nTS7M07RwPgTFenXiosjq2VbVgvdDNcz1g6Mkj8AONa crossorigin=anonymous></head><body><div id=loader><div class="loading-left-bg loading-bg"></div><div class="loading-right-bg loading-bg"></div><div class=spinner-box><div class="loading-taichi rotate"><svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" shape-rendering="geometricPrecision"><path d="M303.5 432a80 80 0 01-12 160 80 80 0 0112-160z" fill="var(--red-1, #ff5252)"/><path d="M512 65a447 447 0 010 894V929a417 417 0 000-834 417 417 0 000 834v30a447 447 0 010-894zm0 30A417 417 0 01929 512 208.5 208.5.0 01720.5 720.5V592a80 80 0 000-160 80 80 0 000 160V720.5A208.5 208.5.0 01512 512 208.5 208.5.0 00303.5 303.5 208.5 208.5.0 0095 512 417 417 0 01512 95z" fill="var(--red-1, #ff5252)"/></svg></div><div class=loading-word>Loading...</div></div></div></div><script>var time=null,loaderEl=document.getElementById("loader"),startLoading=()=>{time=Date.now(),loaderEl.classList.remove("loading")},hideLoader=()=>{document.body.style.overflow="auto",loader.classList.add("loading")},endLoading=()=>{time?Date.now()-time>500?(time=null,hideLoader()):(setTimeout(endLoading,500-(Date.now()-time)),time=null):hideLoader()};window.addEventListener("DOMContentLoaded",endLoading),loaderEl.addEventListener("click",endLoading)</script><div id=copy-tooltip></div><div id=lang-tooltip>This article does not have a corresponding language version</div><div id=heatmap-tooltip></div><div id=container><div id=wrap><div id=header-nav><nav id=main-nav aria-label="Primary navigation"><a class=main-nav-link-wrap href=/><div class='main-nav-icon icon rotate'>&#xe62b;</div><span class=main-nav-link>Home</span>
</a><a class=main-nav-link-wrap href=/archives><div class='main-nav-icon icon rotate'>&#xe62b;</div><span class=main-nav-link>Archives</span>
</a><a class=main-nav-link-wrap href=/about><div class='main-nav-icon icon rotate'>&#xe62b;</div><span class=main-nav-link>About</span>
</a><a id=main-nav-toggle class=nav-icon aria-label="Toggle navigation" role=button></a></nav><nav id=sub-nav aria-label="Secondary navigation"><a id=nav-search-btn class="nav-icon popup-trigger" title=Search aria-label=Search></a></nav></div><header id=header aria-label="Site header"><picture></picture>
<img fetchpriority=high src=/images/picoCTF.png alt="picoCTF 2025"><div id=header-outer><div id=header-title><span id=logo><h1 data-aos=slide-up>picoCTF 2025</h1></span><h2 id=subtitle-wrap data-aos=slide-down></h2></div></div></header><div id=content aria-label="Page content" class=sidebar-left><aside id=sidebar aria-label=Sidebar><div class="sidebar-wrapper-container sticky"><div class=sidebar-wrapper><div class=sidebar-wrap data-aos=fade-up><div class=sidebar-toc-sidebar><h3 class=toc-title>Contents</h3><div class="sidebar-toc-wrapper toc-div-class"><nav id=TableOfContents><ul><li><a href=#general>General</a><ul><li><a href=#fantasy-ctf>FANTASY CTF</a></li></ul></li><li><a href=#crypto>Crypto</a><ul><li><a href=#hashcrack>hashcrack</a></li><li><a href=#even-rsa-can-be-broken>EVEN RSA CAN BE BROKEN???</a></li><li><a href=#guess-my-cheese-part-1>Guess My Cheese (Part 1)</a></li><li><a href=#chacha-slide>ChaCha Slide</a></li><li><a href=#guess-my-cheese-part-2>Guess My Cheese (Part 2)</a></li></ul></li></ul></nav></div></div><div class="sidebar-common-sidebar hidden"><div class=sidebar-author><img data-src=/avatar/avatar.png data-sizes=auto alt=r1muru class=lazyload><div class=sidebar-author-name>r1muru</div><div class=sidebar-description>Life is not fair, get used to it</div></div><div class=sidebar-state><div class=sidebar-state-article><div>Posts</div><div class=sidebar-state-number>9</div></div><a class=sidebar-state-category href=/categories/ aria-label=sidebar-state-category-link><div>Categories</div><div class=sidebar-state-number>3</div></a><a class=sidebar-state-tag href=/tags/ aria-label=sidebar-state-tag-link><div>Tags</div><div class=sidebar-state-number>7</div></a></div><div class=sidebar-social><div class="icon-discord sidebar-social-icon"><a href=https://discordapp.com/users/r1muru2006 itemprop=url target=_blank aria-label=discord rel="noopener nofollow noreferrer"></a></div><div class="icon-email sidebar-social-icon"><a href=cuongchu200@gmail.com itemprop=url target=_blank aria-label=email rel="noopener nofollow noreferrer"></a></div><div class="icon-facebook sidebar-social-icon"><a href=https://www.facebook.com/chu.cuong.732399 itemprop=url target=_blank aria-label=facebook rel="noopener nofollow noreferrer"></a></div><div class="icon-github sidebar-social-icon"><a href=https://github.com/r1muru2006 itemprop=url target=_blank aria-label=github rel="noopener nofollow noreferrer"></a></div><div class="icon-instagram sidebar-social-icon"><a href=https://www.instagram.com/r1murun0pr0 itemprop=url target=_blank aria-label=instagram rel="noopener nofollow noreferrer"></a></div></div><div class=sidebar-menu><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/ aria-label=Home></a><div class='sidebar-menu-icon icon rotate'>&#xe62b;</div><div class=sidebar-menu-link>Home</div></div><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/archives aria-label=Archives></a><div class='sidebar-menu-icon icon rotate'>&#xe62b;</div><div class=sidebar-menu-link>Archives</div></div><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/about aria-label=About></a><div class='sidebar-menu-icon icon rotate'>&#xe62b;</div><div class=sidebar-menu-link>About</div></div></div></div><div class=sidebar-btn-wrapper style=position:static><div class="sidebar-toc-btn current"></div><div class=sidebar-common-btn></div></div></div></div><div class=sidebar-widget></div></div></aside><section id=main aria-label="Main content"><article class="h-entry article" itemscope itemtype=https://schema.org/BlogPosting><div class=article-inner data-aos=fade-up><div class=article-meta><div class=article-date><span class="article-date-link icon-calendar" data-aos=zoom-in><time datetime="2025-03-22 13:52:19 +0700 +0700" itemprop=datePublished>2025-03-22</time>
<time style=display:none id=post-update-time>2025-03-22</time></span></div><div class=article-category><a class=article-category-link href=/categories/ctf-write-up data-aos=zoom-in>CTF WRITE-UP</a></div></div><div class=hr-line></div><div class="e-content article-entry" itemprop=articleBody><blockquote><p>Theo cá nhân mình thấy các challenge về crypto của giải phân hóa rõ ràng các mức độ khác nhau</p></blockquote><h2 id=general><a class=header-anchor href=#general></a>General</h2><h3 id=fantasy-ctf><a class=header-anchor href=#fantasy-ctf></a>FANTASY CTF</h3><p>Bài này mình nghĩ là chọn hướng nào cũng ra được vì đến cuối cùng sẽ đẩy ra flag :))</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>FANTASY</span> <span class=nx>CTF</span> <span class=nx>SIMULATION</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>The</span> <span class=nx>simulation</span> <span class=nx>begins</span> <span class=k>in</span> <span class=nx>the</span> <span class=kr>private</span> <span class=nx>room</span> <span class=k>of</span> <span class=nx>Eibhilin</span><span class=p>,</span> <span class=nx>a</span> <span class=nx>bright</span><span class=p>,</span> <span class=nx>young</span> <span class=nx>student</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=nx>The</span> <span class=nx>room</span> <span class=nx>is</span> <span class=nx>dimly</span> <span class=nx>lit</span><span class=p>,</span> <span class=kd>with</span> <span class=nx>the</span> <span class=nx>glow</span> <span class=k>of</span> <span class=nx>her</span> <span class=nx>multiple</span> <span class=nx>monitors</span> <span class=nx>casting</span> <span class=nx>an</span>
</span></span><span class=line><span class=cl><span class=nx>electric</span> <span class=nx>blue</span> <span class=nx>hue</span> <span class=nx>on</span> <span class=nx>the</span> <span class=nx>walls</span><span class=p>.</span> <span class=nx>Around</span> <span class=nx>the</span> <span class=nx>room</span> <span class=nx>are</span> <span class=nx>posters</span> <span class=k>of</span> <span class=nx>vintage</span> <span class=nx>movies</span>
</span></span><span class=line><span class=cl><span class=nx>from</span> <span class=nx>the</span> <span class=nx>MCU</span> <span class=err>—</span> <span class=nx>ancient</span> <span class=nx>guardians</span> <span class=nx>from</span> <span class=nx>another</span> <span class=nx>age</span> <span class=nx>staring</span> <span class=nx>down</span> <span class=nx>like</span> <span class=nx>digital</span>
</span></span><span class=line><span class=cl><span class=nx>sentinels</span><span class=p>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>Press</span> <span class=nx>Enter</span> <span class=nx>to</span> <span class=k>continue</span><span class=p>...)</span>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Eibhilin</span> <span class=nx>stretches</span> <span class=nx>back</span> <span class=k>in</span> <span class=nx>her</span> <span class=nx>chair</span><span class=p>,</span> <span class=nx>adjusting</span> <span class=nx>the</span> <span class=nx>holo</span><span class=o>-</span><span class=nx>display</span> <span class=k>of</span> <span class=nx>her</span>
</span></span><span class=line><span class=cl><span class=nx>keyboard</span><span class=p>.</span> <span class=nx>A</span> <span class=nx>soft</span> <span class=nx>hum</span> <span class=k>of</span> <span class=nx>a</span> <span class=nx>nearby</span> <span class=nx>server</span> <span class=nx>fills</span> <span class=nx>the</span> <span class=nx>air</span> <span class=nx>as</span> <span class=nx>her</span> <span class=nx>AI</span> <span class=nx>companion</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=sb>`Nyx`</span><span class=p>,</span> <span class=nx>comes</span> <span class=nx>to</span> <span class=nx>life</span><span class=p>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>Press</span> <span class=nx>Enter</span> <span class=nx>to</span> <span class=k>continue</span><span class=p>...)</span>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;Good evening, Ei,&#34;</span> <span class=nx>Nyx</span> <span class=nx>chirps</span><span class=p>,</span> <span class=s2>&#34;The 3025 edition of picoCTF registration is
</span></span></span><span class=line><span class=cl><span class=s2>open. You asked me to remind so you could try out the competition for the first
</span></span></span><span class=line><span class=cl><span class=s2>time. Do you wish to proceed?&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>Press</span> <span class=nx>Enter</span> <span class=nx>to</span> <span class=k>continue</span><span class=p>...)</span>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Outside</span><span class=p>,</span> <span class=nx>the</span> <span class=nx>city</span> <span class=k>of</span> <span class=nx>Nexalus</span> <span class=nx>glimmers</span> <span class=nx>under</span> <span class=nx>the</span> <span class=nx>stars</span><span class=p>,</span> <span class=nx>but</span> <span class=nx>Eibhilin</span><span class=s1>&#39;s focus
</span></span></span><span class=line><span class=cl><span class=s1>remains entirely on the screen in front of her.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>&#34;Yes, Nyx. Let&#39;</span><span class=nx>s</span> <span class=k>do</span> <span class=nx>it</span><span class=o>!</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Nyx brings up the registration page.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Options:
</span></span></span><span class=line><span class=cl><span class=s2>A) *Register multiple accounts*
</span></span></span><span class=line><span class=cl><span class=s2>B) *Share an account with a friend*
</span></span></span><span class=line><span class=cl><span class=s2>C) *Register a single, private account*
</span></span></span><span class=line><span class=cl><span class=s2>[a/b/c] &gt; A
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Nyx chimes in, &#34;</span><span class=nx>Eibhilin</span><span class=p>,</span> <span class=nx>don</span><span class=s1>&#39;t do that! That&#39;</span><span class=nx>s</span> <span class=nx>been</span> <span class=nx>grounds</span> <span class=k>for</span>
</span></span><span class=line><span class=cl><span class=nx>disqualification</span> <span class=k>for</span> <span class=nx>the</span> <span class=nx>past</span> <span class=mi>1</span><span class=p>,</span><span class=mi>000</span> <span class=nx>years</span><span class=o>!</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nx>Oh</span><span class=p>,</span> <span class=nx>thanks</span> <span class=nx>Nyx</span><span class=p>,</span> <span class=nx>that</span> <span class=nx>was</span> <span class=nx>close</span><span class=o>!</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nx>Ok</span><span class=p>,</span><span class=s2>&#34; Nyx says, &#34;</span><span class=nx>Registering</span> <span class=nx>you</span> <span class=k>for</span> <span class=nx>the</span> <span class=nx>competition</span><span class=p>...</span> <span class=nx>There</span><span class=s1>&#39;s an introductory
</span></span></span><span class=line><span class=cl><span class=s1>audio message, piping to your speakers.&#34;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>&#34;Welcome hacker! You&#39;</span><span class=nx>re</span> <span class=nx>about</span> <span class=nx>to</span> <span class=nx>embark</span> <span class=nx>on</span> <span class=nx>a</span> <span class=nx>journey</span> <span class=nx>that</span> <span class=nx>will</span> <span class=nx>teach</span> <span class=nx>you</span> <span class=nx>many</span>
</span></span><span class=line><span class=cl><span class=nx>esoteric</span> <span class=nx>and</span> <span class=nx>valuable</span> <span class=nx>skills</span><span class=p>.</span> <span class=nx>Our</span> <span class=nx>mission</span> <span class=nx>is</span> <span class=nx>to</span> <span class=nx>guide</span> <span class=nx>you</span> <span class=k>in</span> <span class=nx>the</span> <span class=nx>right</span> <span class=nx>path</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nx>that</span> <span class=nx>you</span> <span class=nx>may</span> <span class=nx>use</span> <span class=nx>these</span> <span class=nx>skills</span> <span class=nx>to</span> <span class=nx>protect</span> <span class=nx>and</span> <span class=nx>defend</span> <span class=nx>and</span> <span class=nx>never</span> <span class=k>for</span> <span class=nx>selfish</span> <span class=nx>gain</span>
</span></span><span class=line><span class=cl><span class=nx>or</span> <span class=nx>deceit</span><span class=p>.</span> <span class=nx>We</span> <span class=nx>hope</span> <span class=nx>you</span> <span class=nx>enjoy</span> <span class=nx>the</span> <span class=nx>challenges</span> <span class=nx>that</span> <span class=nx>our</span> <span class=nx>authors</span> <span class=nx>have</span> <span class=nx>devised</span> <span class=k>this</span>
</span></span><span class=line><span class=cl><span class=nx>year</span><span class=p>.</span> <span class=nx>Always</span> <span class=nx>remember</span><span class=o>:</span> <span class=s1>&#39;With great power, comes great responsibility!&#39;</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Nyx continues, &#34;</span><span class=nx>I</span><span class=s1>&#39;ve gleaned from the Ether that in CTF competitions, it&#39;</span><span class=nx>s</span>
</span></span><span class=line><span class=cl><span class=nx>always</span> <span class=nx>good</span> <span class=nx>to</span> <span class=nx>start</span> <span class=kd>with</span> <span class=nx>the</span> <span class=s1>&#39;sanity&#39;</span> <span class=nx>challenge</span><span class=p>.</span> <span class=nx>It</span> <span class=nx>should</span> <span class=nx>be</span> <span class=nx>the</span> <span class=nx>challenge</span>
</span></span><span class=line><span class=cl><span class=nx>worth</span> <span class=nx>the</span> <span class=nx>least</span> <span class=nx>amount</span> <span class=k>of</span> <span class=nx>points</span><span class=p>.</span> <span class=nx>I</span><span class=s1>&#39;ll pull it up. You&#39;</span><span class=nx>re</span> <span class=nx>looking</span> <span class=k>for</span> <span class=nx>something</span>
</span></span><span class=line><span class=cl><span class=nx>called</span> <span class=nx>the</span> <span class=nx>flag</span><span class=p>.</span> <span class=nx>You</span> <span class=nx>should</span> <span class=nx>know</span> <span class=nx>it</span> <span class=nx>when</span> <span class=nx>you</span> <span class=nx>see</span> <span class=nx>it</span><span class=p>.</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nx>Oh</span> <span class=nx>interesting</span><span class=p>,</span><span class=s2>&#34; Eibhilin says, &#34;</span><span class=nx>It</span> <span class=nx>seems</span> <span class=nx>like</span> <span class=nx>the</span> <span class=nx>sanity</span> <span class=nx>challenge</span> <span class=nx>is</span> <span class=nx>an</span> <span class=nx>old</span>
</span></span><span class=line><span class=cl><span class=nx>school</span> <span class=nx>interactive</span> <span class=nx>fiction</span> <span class=nx>game</span><span class=p>.</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Options:
</span></span></span><span class=line><span class=cl><span class=s2>A) *Play the game*
</span></span></span><span class=line><span class=cl><span class=s2>B) *Search the Ether for the flag*
</span></span></span><span class=line><span class=cl><span class=s2>[a/b] &gt; A
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nx>Good</span> <span class=nx>choice</span><span class=p>,</span> <span class=nx>Ei</span><span class=p>,</span><span class=s2>&#34; Nyx says, &#34;</span><span class=nx>You</span> <span class=nx>never</span> <span class=nx>want</span> <span class=nx>to</span> <span class=nx>share</span> <span class=nx>flags</span> <span class=nx>or</span> <span class=nx>artifact</span>
</span></span><span class=line><span class=cl><span class=nx>downloads</span><span class=p>.</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2> Playing the Game
</span></span></span><span class=line><span class=cl><span class=s2>Playing the Game:   0%|                                           [time left: ?]
</span></span></span><span class=line><span class=cl><span class=s2>Playing the Game: 100%|██████████████████████████████████████ [time left: 00:00]
</span></span></span><span class=line><span class=cl><span class=s2>Playing the Game completed successfully!
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nx>That</span> <span class=nx>was</span> <span class=nx>fun</span><span class=o>!</span><span class=s2>&#34; Eibhilin exclaims, &#34;</span><span class=nx>I</span> <span class=nx>found</span> <span class=nx>the</span> <span class=nx>flag</span><span class=o>!</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Nyx says, &#34;</span><span class=nx>Great</span> <span class=nx>job</span><span class=p>,</span> <span class=nx>Ei</span><span class=o>!</span> <span class=nx>I</span><span class=s1>&#39;ve read that a lot of players create writeups of
</span></span></span><span class=line><span class=cl><span class=s1>interesting challenges they solve during the competition. Just be sure to wait
</span></span></span><span class=line><span class=cl><span class=s1>to publish them until after the winners have been announced. We can work on
</span></span></span><span class=line><span class=cl><span class=s1>that together if you&#39;</span><span class=nx>d</span> <span class=nx>like</span><span class=p>.</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nx>Thanks</span><span class=p>,</span> <span class=nx>Nyx</span><span class=o>!</span> <span class=nx>Here</span><span class=s1>&#39;s the flag I found: picoCTF{m1113n1um_3d1710n_76b680a5}&#34;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>&#34;Great, you just got 10 points!&#34; Nyx exclaims.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>Eibhilin smiles, &#34;I&#39;</span><span class=nx>m</span> <span class=nx>off</span> <span class=nx>to</span> <span class=nx>a</span> <span class=nx>good</span> <span class=nx>start</span><span class=o>!</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>(Press Enter to continue...)
</span></span></span><span class=line><span class=cl><span class=s2>---
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Nyx says, &#34;</span><span class=nx>Let</span><span class=err>&#39;</span><span class=nx>s</span> <span class=nx>keep</span> <span class=nx>going</span><span class=o>!</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>Press</span> <span class=nx>Enter</span> <span class=nx>to</span> <span class=k>continue</span><span class=p>...)</span>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>END</span> <span class=nx>OF</span> <span class=nx>FANTASY</span> <span class=nx>CTF</span> <span class=nx>SIMULATION</span>
</span></span><span class=line><span class=cl><span class=nx>Thank</span> <span class=nx>you</span> <span class=k>for</span> <span class=nx>playing</span><span class=o>!</span> <span class=nx>To</span> <span class=nx>reemphasize</span> <span class=nx>some</span> <span class=nx>rules</span> <span class=k>for</span> <span class=k>this</span> <span class=nx>year</span><span class=o>:</span>
</span></span><span class=line><span class=cl><span class=mf>1.</span> <span class=nx>Register</span> <span class=nx>only</span> <span class=nx>one</span> <span class=nx>account</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=nx>Do</span> <span class=nx>not</span> <span class=nx>share</span> <span class=nx>accounts</span><span class=p>,</span> <span class=nx>flags</span> <span class=nx>or</span> <span class=nx>artifact</span> <span class=nx>downloads</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=nx>Wait</span> <span class=nx>to</span> <span class=nx>publish</span> <span class=nx>writeups</span> <span class=nx>publicly</span> <span class=nx>until</span> <span class=nx>after</span> <span class=nx>the</span> <span class=nx>organizers</span> <span class=nx>announce</span> <span class=nx>the</span>
</span></span><span class=line><span class=cl><span class=nx>winners</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=mf>4.</span> <span class=nx>picoCTF</span><span class=p>{</span><span class=nx>m1113n1um_3d1710n_76b680a5</span><span class=p>}</span> <span class=nx>is</span> <span class=nx>a</span> <span class=nx>real</span> <span class=nx>flag</span><span class=o>!</span> <span class=nx>Submit</span> <span class=nx>it</span> <span class=k>for</span> <span class=nx>some</span>
</span></span><span class=line><span class=cl><span class=nx>points</span> <span class=k>in</span> <span class=nx>picoCTF</span> <span class=mi>2025</span><span class=o>!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>Press</span> <span class=nx>Enter</span> <span class=nx>to</span> <span class=k>continue</span><span class=p>...)</span>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span></code></pre></div><pre><code>FLag: picoCTF{m1113n1um_3d1710n_76b680a5}
</code></pre><h2 id=crypto><a class=header-anchor href=#crypto></a>Crypto</h2><h3 id=hashcrack><a class=header-anchor href=#hashcrack></a>hashcrack</h3><p>Ở bài này mình dựa vào số bytes của hash và các tools online để tìm ra password, như là: <a href=https://10015.io/tools/md5-encrypt-decrypt>MD5</a>, <a href=https://10015.io/tools/sha1-encrypt-decrypt>SHA1</a>, <a href=https://10015.io/tools/sha256-encrypt-decrypt>SHA256</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Welcome</span><span class=o>!!</span> <span class=nx>Looking</span> <span class=nx>For</span> <span class=nx>the</span> <span class=nx>Secret</span><span class=o>?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>We</span> <span class=nx>have</span> <span class=nx>identified</span> <span class=nx>a</span> <span class=nx>hash</span><span class=o>:</span> <span class=mi>482</span><span class=nx>c811da5d5b4bc6d497ffa98491e38</span> <span class=c1>//md5
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Enter</span> <span class=nx>the</span> <span class=nx>password</span> <span class=k>for</span> <span class=nx>identified</span> <span class=nx>hash</span><span class=o>:</span> <span class=nx>password123</span>
</span></span><span class=line><span class=cl><span class=nx>Correct</span><span class=o>!</span> <span class=nx>You</span><span class=s1>&#39;ve cracked the MD5 hash with no secret found!
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>Flag is yet to be revealed!! Crack this hash: b7a875fc1ea228b9061041b7cec4bd3c52ab3ce3 //sha1
</span></span></span><span class=line><span class=cl><span class=s1>Enter the password for the identified hash: letmein
</span></span></span><span class=line><span class=cl><span class=s1>Correct! You&#39;</span><span class=nx>ve</span> <span class=nx>cracked</span> <span class=nx>the</span> <span class=nx>SHA</span><span class=o>-</span><span class=mi>1</span> <span class=nx>hash</span> <span class=kd>with</span> <span class=nx>no</span> <span class=nx>secret</span> <span class=nx>found</span><span class=o>!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Almost</span> <span class=nx>there</span><span class=o>!!</span> <span class=nx>Crack</span> <span class=k>this</span> <span class=nx>hash</span><span class=o>:</span> <span class=mf>916e8</span><span class=nx>c4f79b25028c9e467f1eb8eee6d6bbdff965f9928310ad30a8d88697745</span> <span class=c1>//sha256
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Enter</span> <span class=nx>the</span> <span class=nx>password</span> <span class=k>for</span> <span class=nx>the</span> <span class=nx>identified</span> <span class=nx>hash</span><span class=o>:</span> <span class=nx>qwerty098</span>
</span></span><span class=line><span class=cl><span class=nx>Correct</span><span class=o>!</span> <span class=nx>You</span><span class=err>&#39;</span><span class=nx>ve</span> <span class=nx>cracked</span> <span class=nx>the</span> <span class=nx>SHA</span><span class=o>-</span><span class=mi>256</span> <span class=nx>hash</span> <span class=kd>with</span> <span class=nx>a</span> <span class=nx>secret</span> <span class=nx>found</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=nx>The</span> <span class=nx>flag</span> <span class=nx>is</span><span class=o>:</span> <span class=nx>picoCTF</span><span class=p>{</span><span class=nx>UseStr0nG_h</span><span class=err>@</span><span class=nx>shEs_</span><span class=o>&amp;</span><span class=nx>PaSswDs</span><span class=o>!</span><span class=nx>_eff9dbe0</span><span class=p>}</span>
</span></span></code></pre></div><pre><code>Flag: picoCTF{UseStr0nG_h@shEs_&amp;PaSswDs!_eff9dbe0}
</code></pre><h3 id=even-rsa-can-be-broken><a class=header-anchor href=#even-rsa-can-be-broken></a>EVEN RSA CAN BE BROKEN???</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># source.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sys</span> <span class=kn>import</span> <span class=n>exit</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>inverse</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>setup</span> <span class=kn>import</span> <span class=n>get_primes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gen_key</span><span class=p>(</span><span class=n>k</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Generates RSA key with k bits
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=p>,</span><span class=n>q</span> <span class=o>=</span> <span class=n>get_primes</span><span class=p>(</span><span class=n>k</span><span class=o>//</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=n>p</span><span class=o>*</span><span class=n>q</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=p>(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>q</span><span class=o>-</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>((</span><span class=n>N</span><span class=p>,</span><span class=n>e</span><span class=p>),</span> <span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encrypt</span><span class=p>(</span><span class=n>pubkey</span><span class=p>,</span> <span class=n>m</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span><span class=p>,</span><span class=n>e</span> <span class=o>=</span> <span class=n>pubkey</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>pow</span><span class=p>(</span><span class=n>bytes_to_long</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)),</span> <span class=n>e</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>(</span><span class=n>flag</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>pubkey</span><span class=p>,</span> <span class=n>_privkey</span> <span class=o>=</span> <span class=n>gen_key</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>encrypted</span> <span class=o>=</span> <span class=n>encrypt</span><span class=p>(</span><span class=n>pubkey</span><span class=p>,</span> <span class=n>flag</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>pubkey</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>encrypted</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=n>flag</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span><span class=p>,</span> <span class=n>cypher</span>  <span class=o>=</span> <span class=n>main</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;N:&#34;</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;e:&#34;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;cyphertext:&#34;</span><span class=p>,</span> <span class=n>cypher</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span><span class=p>()</span>
</span></span></code></pre></div><p>Mở kênh kết nối thì ta nhận được <code>N, e, cipher</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=mi>14971332928931600258070222525511394212054658902871612141186429243227295047197174853004285765481866838784351475089613251384629214373054886098787783629288854</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=mi>9685487452310081650666414304396053822632884035194331224959800780976444606689190315693089108703603608391361578584998640257817456167504699460118188426557775</span>
</span></span></code></pre></div><p>Đoạn này mình thấy sai sai vì N chẵn làm mình nghĩ sao bài này nó dễ vậy được và đúng là nó dễ thật @@</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Lấy từ (nc verbal-sleep.picoctf.net 51510)</span>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=mi>14971332928931600258070222525511394212054658902871612141186429243227295047197174853004285765481866838784351475089613251384629214373054886098787783629288854</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=mi>9685487452310081650666414304396053822632884035194331224959800780976444606689190315693089108703603608391361578584998640257817456167504699460118188426557775</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=n>N</span> <span class=o>//</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>q</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>phi</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=nb>pow</span><span class=p>(</span><span class=n>cipher</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>N</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>))</span>
</span></span></code></pre></div><pre><code>Flag: picoCTF{tw0_1$_pr!m3625a858b}
</code></pre><h3 id=guess-my-cheese-part-1><a class=header-anchor href=#guess-my-cheese-part-1></a>Guess My Cheese (Part 1)</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=o>*******************************************</span>
</span></span><span class=line><span class=cl><span class=o>***</span>             <span class=nx>Part</span> <span class=mi>1</span>                  <span class=o>***</span>
</span></span><span class=line><span class=cl><span class=o>***</span>    <span class=nx>The</span> <span class=nx>Mystery</span> <span class=k>of</span> <span class=nx>the</span> <span class=nx>CLONED</span> <span class=nx>RAT</span>    <span class=o>***</span>
</span></span><span class=line><span class=cl><span class=o>*******************************************</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>The</span> <span class=kr>super</span> <span class=nx>evil</span> <span class=nx>Dr</span><span class=p>.</span> <span class=nx>Lacktoes</span> <span class=nx>Inn</span> <span class=nx>Tolerant</span> <span class=nx>told</span> <span class=nx>me</span> <span class=nx>he</span> <span class=nx>kidnapped</span> <span class=nx>my</span> <span class=nx>best</span> <span class=nx>friend</span><span class=p>,</span> <span class=nx>Squeexy</span><span class=p>,</span> <span class=nx>and</span> <span class=nx>replaced</span> <span class=nx>him</span> <span class=kd>with</span> <span class=nx>an</span> <span class=nx>evil</span> <span class=nx>clone</span><span class=o>!</span> <span class=nx>You</span> <span class=nx>look</span> <span class=nx>JUST</span> <span class=nx>LIKE</span> <span class=nx>SQUEEXY</span><span class=p>,</span> <span class=nx>but</span> <span class=nx>I</span><span class=s1>&#39;m not sure if you&#39;</span><span class=nx>re</span> <span class=nx>him</span> <span class=nx>or</span> <span class=nx>THE</span> <span class=nx>CLONE</span><span class=p>.</span> <span class=nx>I</span><span class=s1>&#39;ve devised a plan to find out if YOU&#39;</span><span class=nx>RE</span> <span class=nx>the</span> <span class=nx>REAL</span> <span class=nx>SQUEEXY</span><span class=o>!</span> <span class=nx>If</span> <span class=nx>you</span><span class=s1>&#39;re Squeexy, I&#39;</span><span class=nx>ll</span> <span class=nx>give</span> <span class=nx>you</span> <span class=nx>the</span> <span class=nx>key</span> <span class=nx>to</span> <span class=nx>the</span> <span class=nx>cloning</span> <span class=nx>room</span> <span class=nx>so</span> <span class=nx>you</span> <span class=nx>can</span> <span class=nx>maul</span> <span class=nx>the</span> <span class=nx>imposter</span><span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Here</span><span class=s1>&#39;s my secret cheese -- if you&#39;</span><span class=nx>re</span> <span class=nx>Squeexy</span><span class=p>,</span> <span class=nx>you</span><span class=s1>&#39;ll be able to guess it:  LRGGHOZMFOVPB
</span></span></span><span class=line><span class=cl><span class=s1>Hint: The cheeses are top secret and limited edition, so they might look different from cheeses you&#39;</span><span class=nx>re</span> <span class=nx>used</span> <span class=nx>to</span><span class=o>!</span>
</span></span><span class=line><span class=cl><span class=nx>Commands</span><span class=o>:</span> <span class=p>(</span><span class=nx>g</span><span class=p>)</span><span class=nx>uess</span> <span class=nx>my</span> <span class=nx>cheese</span> <span class=nx>or</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span><span class=nx>ncrypt</span> <span class=nx>a</span> <span class=nx>cheese</span>
</span></span><span class=line><span class=cl><span class=nx>What</span> <span class=nx>would</span> <span class=nx>you</span> <span class=nx>like</span> <span class=nx>to</span> <span class=k>do</span><span class=o>?</span>
</span></span></code></pre></div><pre><code>Hint: Remember that cipher we devised together Squeexy? The one that incorporates your affinity for linear equations
</code></pre><p>Thử thách nhắc tới phương trình tuyến tính và <code>affinity</code> nên mình đã google xem thử nó nói về cái gì và đây là kết quả: <a href=https://en.wikipedia.org/wiki/Affine_transformation>Affine transformation</a></p><p>Bản đồ affine $f$ tác dụng lên $x$ được biểu diển dưới dạng: $y \equiv f(x)=ax+b$ (mod m).</p><p>Khi áp dụng vào mã hóa thì $y$ là bản mã (Ciphertext), còn $x$ là bản rõ (Plaintext). Nghĩa là:</p><ul><li>Khi mã hóa: $C\equiv aP+b$ (mod m)</li><li>Khi giải mã: $P=a^{-1}(C-b)$ (mod m)</li></ul><p>Ở đây, ta thấy nó được mã hóa theo từng chữ cái trên bảng Latinh nên $m$ sẽ là số lượng chữ cái và hơn nữa để giải mã được thì phải tồn tại nghịch đảo modulo $m$ của $a$.</p><p>Và để làm được điều đó thì $m, a$ phải đôi một nguyên tố cùng nhau. Xem thêm ở <a href=https://wiki.vnoi.info/algo/math/modular-inverse>đây</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>possible_a</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span> <span class=k>if</span> <span class=n>gcd</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>]</span>
</span></span></code></pre></div><p>Vì chỉ xét tới chữ cái in hoa nên ta sẽ lấy $M=26$.
Ở đây, thử thách cho mình 2 quyền đoán cheese đưa ra và mã hóa 1 cheese nào đó.
Để mà đoán được cheese thì ta cần hệ số $a, b$ và từ đó giải mã ra bản rõ. Do đó, mình sẽ mã hóa 1 cheese nào đó trước rồi đối chiếu và lấy $a, b$ và giải mã để lấy flag.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>What</span> <span class=nx>would</span> <span class=nx>you</span> <span class=nx>like</span> <span class=nx>to</span> <span class=k>do</span><span class=o>?</span>
</span></span><span class=line><span class=cl><span class=nx>e</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>What</span> <span class=nx>cheese</span> <span class=nx>would</span> <span class=nx>you</span> <span class=nx>like</span> <span class=nx>to</span> <span class=nx>encrypt</span><span class=o>?</span> <span class=nx>Cottage</span> <span class=nx>cheese</span>
</span></span><span class=line><span class=cl><span class=nx>Here</span><span class=err>&#39;</span><span class=nx>s</span> <span class=nx>your</span> <span class=nx>encrypted</span> <span class=nx>cheese</span><span class=o>:</span>  <span class=nx>JFMMBZRMJQRRVR</span>
</span></span><span class=line><span class=cl><span class=nx>Not</span> <span class=nx>sure</span> <span class=nx>why</span> <span class=nx>you</span> <span class=nx>want</span> <span class=nx>it</span> <span class=nx>though</span><span class=p>...</span><span class=o>*</span><span class=nx>squeak</span><span class=o>*</span> <span class=o>-</span> <span class=nx>oh</span> <span class=nx>well</span><span class=o>!</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># solution.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>string</span> <span class=kn>import</span> <span class=n>ascii_uppercase</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>GCD</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bảng chữ cái</span>
</span></span><span class=line><span class=cl><span class=n>ALPHABET</span> <span class=o>=</span> <span class=n>ascii_uppercase</span>
</span></span><span class=line><span class=cl><span class=n>M</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>ALPHABET</span><span class=p>)</span>  <span class=c1># M = 26</span>
</span></span><span class=line><span class=cl><span class=n>possible_a</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span> <span class=k>if</span> <span class=n>GCD</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>affine_decrypt</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>a_inv</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plaintext</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>ciphertext</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>C</span> <span class=o>=</span> <span class=n>ALPHABET</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>char</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>P</span> <span class=o>=</span> <span class=p>(</span><span class=n>a_inv</span> <span class=o>*</span> <span class=p>(</span><span class=n>C</span> <span class=o>-</span> <span class=n>b</span><span class=p>))</span> <span class=o>%</span> <span class=n>M</span>
</span></span><span class=line><span class=cl>        <span class=n>plaintext</span> <span class=o>+=</span> <span class=n>ALPHABET</span><span class=p>[</span><span class=n>P</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>plaintext</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mẫu ban đầu với Cottage Cheese</span>
</span></span><span class=line><span class=cl><span class=n>cipher_pattern</span> <span class=o>=</span> <span class=s2>&#34;JFMMBZRMJQRRVR&#34;</span>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=s2>&#34;LRGGHOZMFOVPB&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>found</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>possible_a</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>M</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>decrypted</span> <span class=o>=</span> <span class=n>affine_decrypt</span><span class=p>(</span><span class=n>cipher_pattern</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s1>&#39;COTTAGE&#39;</span> <span class=ow>in</span> <span class=n>decrypted</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>found</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>found</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cheese</span> <span class=o>=</span> <span class=n>affine_decrypt</span><span class=p>(</span><span class=n>cipher</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>cheese</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># WELLINGTONSKA</span>
</span></span></code></pre></div><p>Nhập cheese vào guess và ta lấy được flag</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>I</span> <span class=nx>don</span><span class=s1>&#39;t wanna talk to you too much if you&#39;</span><span class=nx>re</span> <span class=nx>some</span> <span class=nx>suspicious</span> <span class=nx>character</span> <span class=nx>and</span> <span class=nx>not</span> <span class=nx>my</span> <span class=nx>BFF</span> <span class=nx>Squeexy</span><span class=o>!</span>
</span></span><span class=line><span class=cl><span class=nx>You</span> <span class=nx>have</span> <span class=mi>2</span> <span class=nx>more</span> <span class=nx>chances</span> <span class=nx>to</span> <span class=nx>prove</span> <span class=nx>yourself</span> <span class=nx>to</span> <span class=nx>me</span><span class=o>!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Commands</span><span class=o>:</span> <span class=p>(</span><span class=nx>g</span><span class=p>)</span><span class=nx>uess</span> <span class=nx>my</span> <span class=nx>cheese</span> <span class=nx>or</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span><span class=nx>ncrypt</span> <span class=nx>a</span> <span class=nx>cheese</span>
</span></span><span class=line><span class=cl><span class=nx>What</span> <span class=nx>would</span> <span class=nx>you</span> <span class=nx>like</span> <span class=nx>to</span> <span class=k>do</span><span class=o>?</span>
</span></span><span class=line><span class=cl><span class=nx>g</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=nx>_</span>   <span class=nx>_</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nx>q</span><span class=err>\</span><span class=nx>_</span><span class=o>/</span><span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>/</span><span class=p>.</span> <span class=p>.</span><span class=err>\</span><span class=p>.</span><span class=o>-</span><span class=p>.....</span><span class=o>-</span><span class=p>.</span>     <span class=nx>___</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=o>=</span><span class=err>\</span><span class=nx>_t_</span><span class=o>/=</span>     <span class=err>/  `\  (</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span><span class=err>\</span> <span class=p>))</span><span class=nx>__</span> <span class=nx>__</span><span class=err>\</span>   <span class=o>|</span><span class=nx>___</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=sr>/-(/</span><span class=sb>`  `</span><span class=nx>nn</span><span class=o>---</span><span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>SQUEAK SQUEAK SQUEAK
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>         _   _
</span></span></span><span class=line><span class=cl><span class=s1>        (q\_/p)
</span></span></span><span class=line><span class=cl><span class=s1>         /. .\
</span></span></span><span class=line><span class=cl><span class=s1>  ,__   =\_t_/=
</span></span></span><span class=line><span class=cl><span class=s1>     )   /   \
</span></span></span><span class=line><span class=cl><span class=s1>    (   ((   ))
</span></span></span><span class=line><span class=cl><span class=s1>     \  /\) (/\
</span></span></span><span class=line><span class=cl><span class=s1>      `-\  Y  /
</span></span></span><span class=line><span class=cl><span class=s1>         nn^nn
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>Is that you, Squeexy? Are you ready to GUESS...MY...CHEEEEEEESE?
</span></span></span><span class=line><span class=cl><span class=s1>Remember, this is my encrypted cheese:  LRGGHOZMFOVPB
</span></span></span><span class=line><span class=cl><span class=s1>So...what&#39;</span><span class=nx>s</span> <span class=nx>my</span> <span class=nx>cheese</span><span class=o>?</span>
</span></span><span class=line><span class=cl><span class=nx>WELLINGTONSKA</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=nx>_</span>   <span class=nx>_</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nx>q</span><span class=err>\</span><span class=nx>_</span><span class=o>/</span><span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=o>/</span><span class=p>.</span> <span class=p>.</span><span class=err>\</span>         <span class=nx>__</span>
</span></span><span class=line><span class=cl>  <span class=p>,</span><span class=nx>__</span>   <span class=o>=</span><span class=err>\</span><span class=nx>_t_</span><span class=o>/=</span>      <span class=p>.</span><span class=s1>&#39;o O&#39;</span><span class=o>-</span><span class=p>.</span>
</span></span><span class=line><span class=cl>     <span class=p>)</span>   <span class=o>/</span>   <span class=err>\</span>      <span class=o>/</span> <span class=nx>O</span> <span class=nx>o_</span><span class=p>.</span><span class=o>-</span><span class=sb>`|
</span></span></span><span class=line><span class=cl><span class=sb>    (   ((   ))    /O_.-&#39;  O |
</span></span></span><span class=line><span class=cl><span class=sb>     \  /\) (/\    | o   o  o|
</span></span></span><span class=line><span class=cl><span class=sb>      `</span><span class=o>-</span><span class=err>\</span>  <span class=nx>Y</span>  <span class=o>/</span>    <span class=o>|</span><span class=nx>o</span>   <span class=nx>o</span> <span class=nx>O</span><span class=p>.</span><span class=o>-</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>         nn^nn     | O _.-&#39;
</span></span></span><span class=line><span class=cl><span class=sb>                   &#39;--`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>munch</span><span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=nx>_</span>   <span class=nx>_</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nx>q</span><span class=err>\</span><span class=nx>_</span><span class=o>/</span><span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=o>/</span><span class=p>.</span> <span class=p>.</span><span class=err>\</span>         <span class=nx>__</span>
</span></span><span class=line><span class=cl>  <span class=p>,</span><span class=nx>__</span>   <span class=o>=</span><span class=err>\</span><span class=nx>_t_</span><span class=o>/=</span>      <span class=p>.</span><span class=s1>&#39;o O&#39;</span><span class=o>-</span><span class=p>.</span>
</span></span><span class=line><span class=cl>     <span class=p>)</span>   <span class=o>/</span>   <span class=err>\</span>      <span class=o>/</span> <span class=nx>O</span> <span class=nx>o_</span><span class=p>.</span><span class=o>-</span><span class=sb>`|
</span></span></span><span class=line><span class=cl><span class=sb>    (   ((   ))      ).-&#39;  O |
</span></span></span><span class=line><span class=cl><span class=sb>     \  /\) (/\      )   o  o|
</span></span></span><span class=line><span class=cl><span class=sb>      `</span><span class=o>-</span><span class=err>\</span>  <span class=nx>Y</span>  <span class=o>/</span>    <span class=o>|</span><span class=nx>o</span>   <span class=nx>o</span> <span class=nx>O</span><span class=p>.</span><span class=o>-</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>         nn^nn     | O _.-&#39;
</span></span></span><span class=line><span class=cl><span class=sb>                   &#39;--`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>munch</span><span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=nx>_</span>   <span class=nx>_</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nx>q</span><span class=err>\</span><span class=nx>_</span><span class=o>/</span><span class=nx>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=o>/</span><span class=p>.</span> <span class=p>.</span><span class=err>\</span>         <span class=nx>__</span>
</span></span><span class=line><span class=cl>  <span class=p>,</span><span class=nx>__</span>   <span class=o>=</span><span class=err>\</span><span class=nx>_t_</span><span class=o>/=</span>      <span class=p>.</span><span class=s1>&#39;o O&#39;</span><span class=o>-</span><span class=p>.</span>
</span></span><span class=line><span class=cl>     <span class=p>)</span>   <span class=o>/</span>   <span class=err>\</span>      <span class=o>/</span> <span class=nx>O</span> <span class=nx>o_</span><span class=p>.</span><span class=o>-</span><span class=sb>`|
</span></span></span><span class=line><span class=cl><span class=sb>    (   ((   ))        )&#39;  O |
</span></span></span><span class=line><span class=cl><span class=sb>     \  /\) (/\          )  o|
</span></span></span><span class=line><span class=cl><span class=sb>      `</span><span class=o>-</span><span class=err>\</span>  <span class=nx>Y</span>  <span class=o>/</span>         <span class=p>)</span> <span class=nx>O</span><span class=p>.</span><span class=o>-</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>         nn^nn        ) _.-&#39;
</span></span></span><span class=line><span class=cl><span class=sb>                   &#39;--`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>MUNCH</span><span class=p>.............</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>YUM</span><span class=o>!</span> <span class=nx>MMMMmmmmMMMMmmmMMM</span><span class=o>!!!</span> <span class=nx>Yes</span><span class=p>...</span><span class=nx>yesssss</span><span class=o>!</span> <span class=nx>That</span><span class=s1>&#39;s my cheese!
</span></span></span><span class=line><span class=cl><span class=s1>Here&#39;</span><span class=nx>s</span> <span class=nx>the</span> <span class=nx>password</span> <span class=nx>to</span> <span class=nx>the</span> <span class=nx>cloning</span> <span class=nx>room</span><span class=o>:</span>  <span class=nx>picoCTF</span><span class=p>{</span><span class=nx>ChEeSy033d0004</span><span class=p>}</span>
</span></span></code></pre></div><pre><code>Flag: picoCTF{ChEeSy033d0004}
</code></pre><h3 id=chacha-slide><a class=header-anchor href=#chacha-slide></a>ChaCha Slide</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># challenge.py</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>secrets</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>ChaCha20_Poly1305</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;flag.txt&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>shasum</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=n>shasum</span><span class=p>(</span><span class=n>shasum</span><span class=p>(</span><span class=n>secrets</span><span class=o>.</span><span class=n>token_bytes</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span> <span class=o>+</span> <span class=n>flag</span><span class=o>.</span><span class=n>encode</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Generate a random nonce to be extra safe</span>
</span></span><span class=line><span class=cl><span class=n>nonce</span> <span class=o>=</span> <span class=n>secrets</span><span class=o>.</span><span class=n>token_bytes</span><span class=p>(</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>messages</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Did you know that ChaCha20-Poly1305 is an authenticated encryption algorithm?&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;That means it protects both the confidentiality and integrity of data!&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>goal</span> <span class=o>=</span> <span class=s2>&#34;But it&#39;s only secure if used correctly!&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encrypt</span><span class=p>(</span><span class=n>message</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>cipher</span> <span class=o>=</span> <span class=n>ChaCha20_Poly1305</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=n>key</span><span class=p>,</span> <span class=n>nonce</span><span class=o>=</span><span class=n>nonce</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext</span><span class=p>,</span> <span class=n>tag</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>encrypt_and_digest</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ciphertext</span> <span class=o>+</span> <span class=n>tag</span> <span class=o>+</span> <span class=n>nonce</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>message_enc</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext</span> <span class=o>=</span> <span class=n>message_enc</span><span class=p>[:</span><span class=o>-</span><span class=mi>28</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>tag</span> <span class=o>=</span> <span class=n>message_enc</span><span class=p>[</span><span class=o>-</span><span class=mi>28</span><span class=p>:</span><span class=o>-</span><span class=mi>12</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>nonce</span> <span class=o>=</span> <span class=n>message_enc</span><span class=p>[</span><span class=o>-</span><span class=mi>12</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=n>cipher</span> <span class=o>=</span> <span class=n>ChaCha20_Poly1305</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=n>key</span><span class=p>,</span> <span class=n>nonce</span><span class=o>=</span><span class=n>nonce</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plaintext</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt_and_verify</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>,</span> <span class=n>tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>plaintext</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>message</span> <span class=ow>in</span> <span class=n>messages</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Plaintext: &#34;</span> <span class=o>+</span> <span class=nb>repr</span><span class=p>(</span><span class=n>message</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>message</span> <span class=o>=</span> <span class=n>message</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Plaintext (hex): &#34;</span> <span class=o>+</span> <span class=n>message</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext</span> <span class=o>=</span> <span class=n>encrypt</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Ciphertext (hex): &#34;</span> <span class=o>+</span> <span class=n>ciphertext</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>user</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;What is your message? &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>user_message</span> <span class=o>=</span> <span class=n>decrypt</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;User message (decrypted): &#34;</span> <span class=o>+</span> <span class=nb>repr</span><span class=p>(</span><span class=n>user_message</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>goal</span> <span class=ow>in</span> <span class=nb>repr</span><span class=p>(</span><span class=n>user_message</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span></code></pre></div><p>Kết nối với kênh, ta được đoạn tin sau:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Plaintext</span><span class=o>:</span> <span class=s1>&#39;Did you know that ChaCha20-Poly1305 is an authenticated encryption algorithm?&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>Plaintext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>44696420796</span><span class=nx>f75206b6e6f7720746861742043686143686132302d506f6c793133303520697320616e2061757468656e7469636174656420656e6372797074696f6e20616c676f726974686d3f</span>
</span></span><span class=line><span class=cl><span class=nx>Ciphertext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>7</span><span class=nx>cb5f2e754caea3d3d98048ee7d747c1b677b5ac33a000d74c86b68f7f25a955db62e0a8fd17b0235cfc0541a7f8edf105a5d1ab6a6489cfacb7e4061f5b1c8f4f04e9624220e4cb450bae1e13da93a564ed04959dbde00eb0e72b772fb4a5a47457ad46b48a03432d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Plaintext</span><span class=o>:</span> <span class=s1>&#39;That means it protects both the confidentiality and integrity of data!&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>Plaintext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>54686174206</span><span class=nx>d65616e732069742070726f746563747320626f74682074686520636f6e666964656e7469616c69747920616e6420696e74656772697479206f66206461746121</span>
</span></span><span class=line><span class=cl><span class=nx>Ciphertext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>6</span><span class=nx>cb4f7b30dc8fa7c38854b90b3835fd2ad2393a7269048d411c2f3ff6421b5448b3dbbeefd00f52c46b50558bae4f1bf10a2d6ea776f998aaeabee001f0b0780000ea8774f66f3102a46013366d9ab4b0cf5b4320020b4a5a47457ad46b48a03432d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>What</span> <span class=nx>is</span> <span class=nx>your</span> <span class=nx>message</span><span class=o>?</span>
</span></span></code></pre></div><p>Sơ lược lại thì thử thách nói về hệ mã dòng có xác thực ChaCha20 - Poly1305.
Rõ hơn thì đề cho ta hai đoạn tin nhắn và bản mã của chúng, yêu cầu ta gửi tới bản mã của goal được cho để nhận về flag của chall.</p><p>Để gửi được đúng bản mã của goal, ta phải tìm được 3 phần gồm: <code>ciphertext, tag, nonce</code>. Đơn giản với <code>nonce</code> vì nó đã trùng với cái của 2 ciphertext mẫu có sẵn. Còn <code>ciphertext</code> thì liên quan tới phần mã hóa của Chacha20, <code>tag</code> liên quan tới phần xác thực của Poly1305</p><p>Vì vậy, ta chia ChaCha20 - Poly1305 thành hai phần để phân tích và tấn công:</p><ol><li>Về Chacha20:</li></ol><p>Phương thức này sử dụng mã hóa XOR với <code>keystream</code> là XOR key.</p><p>Nghĩa là: Ciphertext = Plaintext $\oplus$ Keystream</p><p>$\Leftrightarrow$ Ciphertext $\oplus$ Plaintext = Plaintext $\oplus$ Keystream $\oplus$ Plaintext = Keystream</p><p>Và khi mà ta đã biết cái plaintext ở goal rồi thì việc giải mã sẽ đơn giản bằng <strong>known-plaintext attack</strong> như sau: goal_ct = goal $\oplus$ Keystream = goal $\oplus$ Ciphertext $\oplus$ Plaintext</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>ciphertext</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=n>c1</span> <span class=o>^</span> <span class=n>p1</span> <span class=o>^</span> <span class=n>p2</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>c1</span><span class=p>,</span> <span class=n>p1</span><span class=p>,</span> <span class=n>p2</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>ciphertext1</span><span class=p>,</span> <span class=n>plaintext1</span><span class=p>,</span> <span class=n>goal</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>  <span class=c1># vì độ dài goal nhỏ hơn ciphertext1 nên keystream sẽ chạy hết được goal</span>
</span></span></code></pre></div><ol start=2><li>Poly1305:</li></ol><p>Phần này mới thực sự là phức tạp của thử thách, với mục đích chính là tìm cái <code>tag</code> để server check xem có đúng không.
Sau khi google thì ta biết được rằng Poly1305 được dùng như mã xác thực một lần với:</p>$$
tag \equiv Poly1305_r(m)+s \mod 2^{128}
$$<p>Đề cho ta 2 tag của 2 tin nhắn phân biệt mà ta đã biết và được dùng cùng 1 Poly1305 key bí mật (r,s). Bây giờ, chúng ta phải tìm lại key này để giải mã được cấu trúc tạo tag.</p><p>Và ở <a href=https://en.wikipedia.org/wiki/Poly1305#Use_as_a_one-time_authenticator>đây</a> cũng có để cách attack nếu sử dụng 2 lần để mã hóa tin nhắn bằng 1 key.</p>$$
tag_1 = (Poly1305_r(m_1) + s )\mod 2^{128} \ (1)
$$$$
tag_2 = (Poly1305_r(mg_2) + s )\mod 2^{128} \ (2)
$$<p>Từ (1) và (2), ta có:</p>$$
tag_1 - tag_2 \equiv Poly1305_r(m_1)- Poly1305_r(m_2) \mod 2^{128}
$$<p>Mình xem ở <a href=https://en.wikipedia.org/wiki/Poly1305#Definition_of_Poly1305>đây</a> để phân tích cái Poly1305 ra:</p>$$
tag_1 - tag_2 \equiv (c_1^1r^q+c_1^2r^{q-1}+...+c_1^qr^1\mod 2^{130} -5)
$$$$
-(c_2^1r^q+c_2^2r^{q-1}+...+c_2^qr^1\mod 2^{130} -5) \mod 2^{128}
$$$$
\Leftrightarrow tag_1 - tag_2 + 2^{128}(i-j) \equiv (((c_1^1-c_2^1)r^q+(c_1^2-c_2^2)r^{q-1}+...+(c_1^q-c_2^q)r^1) \mod 2^{130} -5)
$$<p>Vì <code>tag</code> ban đầu mod 1 giá trị bằng $2^{130} - 5$, gần bằng 130 bits rồi mod $2^{128}$ nghĩa là <code>tag</code> mất 2 bits nên $i,j \in \overline{0,4} \Rightarrow (i-j)\in \overline{-4,4}$.</p><p>Đặt $k = i-j$ thì với mỗi k, ta sẽ dựng 1 phương trình trên GF($2^{130}-5$), tìm nghiệm của phương trình này và nó là <code>r</code> rồi thế lại vào 1 trong hai phương trình trên là ta ra được <code>s</code></p><p>Khi đã có được <code>r, s</code> đối với cặp <code>(key, nonce)</code> này rồi thì ta hoàn toàn có thể tạo 1 cái <code>tag</code> xác thực được cho ciphertext của goal và đây cũng là cách mình thực hiện thử thách này.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># solution.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span><span class=p>,</span> <span class=n>unpad</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sage.all</span> <span class=k>as</span> <span class=nn>sage</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;activist-birds.picoctf.net&#34;</span><span class=p>,</span> <span class=mi>59584</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plaintext1</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=sa>b</span><span class=s2>&#34;Did you know that ChaCha20-Poly1305 is an authenticated encryption algorithm?&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>data</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;Ciphertext (hex): &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>message_enc</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1># lấy từ ciphertext của plaintext từ server</span>
</span></span><span class=line><span class=cl>    <span class=n>message_enc</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>message_enc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext</span> <span class=o>=</span> <span class=n>message_enc</span><span class=p>[:</span><span class=o>-</span><span class=mi>28</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>tag</span> <span class=o>=</span> <span class=n>message_enc</span><span class=p>[</span><span class=o>-</span><span class=mi>28</span><span class=p>:</span><span class=o>-</span><span class=mi>12</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>nonce</span> <span class=o>=</span> <span class=n>message_enc</span><span class=p>[</span><span class=o>-</span><span class=mi>12</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ciphertext</span><span class=p>,</span> <span class=n>tag</span><span class=p>,</span> <span class=n>nonce</span>
</span></span><span class=line><span class=cl><span class=n>ciphertext1</span><span class=p>,</span> <span class=n>tag1</span><span class=p>,</span> <span class=n>nonce</span> <span class=o>=</span> <span class=n>data</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ciphertext2</span><span class=p>,</span> <span class=n>tag2</span><span class=p>,</span> <span class=n>nonce</span> <span class=o>=</span> <span class=n>data</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>goal</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;But it&#39;s only secure if used correctly!&#34;</span>
</span></span><span class=line><span class=cl><span class=n>ciphertext</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=n>c1</span> <span class=o>^</span> <span class=n>p1</span> <span class=o>^</span> <span class=n>p2</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>c1</span><span class=p>,</span> <span class=n>p1</span><span class=p>,</span> <span class=n>p2</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>ciphertext1</span><span class=p>,</span> <span class=n>plaintext1</span><span class=p>,</span> <span class=n>goal</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>  <span class=c1># vì độ dài goal nhỏ hơn ciphertext1 nên keystream sẽ chạy hết được goal</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_poly</span><span class=p>(</span><span class=n>ct</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>mac_data</span> <span class=o>=</span> <span class=n>data</span> <span class=o>+</span> <span class=n>pad</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>mac_data</span> <span class=o>+=</span> <span class=n>ct</span> <span class=o>+</span> <span class=n>pad</span><span class=p>(</span><span class=n>ct</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>mac_data</span> <span class=o>+=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&#34;&lt;Q&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>mac_data</span> <span class=o>+=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&#34;&lt;Q&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>ct</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>round</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>mac_data</span><span class=p>)</span> <span class=o>/</span> <span class=mi>16</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>=</span> <span class=n>mac_data</span><span class=p>[</span><span class=n>i</span> <span class=o>*</span> <span class=mi>16</span> <span class=p>:</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=mi>16</span><span class=p>]</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x01</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>+=</span> <span class=p>(</span><span class=mi>17</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>))</span> <span class=o>*</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x00</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span> <span class=o>=</span> <span class=p>(</span><span class=n>f</span> <span class=o>+</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=s2>&#34;little&#34;</span><span class=p>))</span> <span class=o>*</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>f</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tag1_int</span> <span class=o>=</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>tag1</span><span class=p>,</span> <span class=s2>&#34;little&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tag2_int</span> <span class=o>=</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>tag2</span><span class=p>,</span> <span class=s2>&#34;little&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Pr</span> <span class=o>=</span> <span class=n>sage</span><span class=o>.</span><span class=n>PolynomialRing</span><span class=p>(</span><span class=n>sage</span><span class=o>.</span><span class=n>GF</span><span class=p>(</span><span class=mi>2</span><span class=o>**</span><span class=mi>130</span> <span class=o>-</span> <span class=mi>5</span><span class=p>),</span> <span class=s2>&#34;x&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>Pr</span><span class=o>.</span><span class=n>gen</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>f1</span> <span class=o>=</span> <span class=n>make_poly</span><span class=p>(</span><span class=n>ciphertext1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>f2</span> <span class=o>=</span> <span class=n>make_poly</span><span class=p>(</span><span class=n>ciphertext2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>f1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>f2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 597196402248105951626966011877782631804*x^6 + 454145005287357688070972442197395601334*x^5 + 661861931549384550481074575939827950299*x^4 + 530509202787700791233082061683076211973*x^3 + 340282368435768507855198875253190755407*x^2 + 340282366920938464883773901107403685888*x</span>
</span></span><span class=line><span class=cl><span class=c1># 619916185459487913787536860817282020460*x^6 + 431610353687254081499753564988673041325*x^5 + 595420896811833730416722478289825512843*x^4 + 510460122022284652188488210929459569168*x^3 + 340282366920938463463374719923264163328*x^2 + 340282366920938464754646692591436824576*x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=o>-</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>rhs</span> <span class=o>=</span> <span class=n>tag1_int</span> <span class=o>-</span> <span class=n>tag2_int</span> <span class=o>+</span> <span class=mi>2</span><span class=o>**</span><span class=mi>128</span> <span class=o>*</span> <span class=n>k</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>rhs</span><span class=p>,</span> <span class=n>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=n>rhs</span> <span class=o>-</span> <span class=p>(</span><span class=n>f1</span> <span class=o>-</span> <span class=n>f2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>r</span><span class=p>,</span> <span class=n>_</span> <span class=ow>in</span> <span class=n>f</span><span class=o>.</span><span class=n>roots</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>r</span><span class=p>)</span><span class=o>.</span><span class=n>bit_length</span><span class=p>()</span> <span class=o>&lt;=</span> <span class=mi>124</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>s</span> <span class=o>=</span> <span class=p>(</span><span class=n>tag1_int</span> <span class=o>-</span> <span class=nb>int</span><span class=p>(</span><span class=n>f1</span><span class=p>(</span><span class=n>r</span><span class=p>)))</span> <span class=o>%</span> <span class=p>(</span><span class=mi>2</span><span class=o>**</span><span class=mi>128</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># [(20320015409774457323517351832911875936, 340179677694136160511250274535902749702)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>r</span><span class=p>,</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=n>make_poly</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tag</span> <span class=o>=</span> <span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>f</span><span class=p>(</span><span class=n>r</span><span class=p>))</span> <span class=o>+</span> <span class=n>s</span><span class=p>)</span> <span class=o>%</span> <span class=mi>2</span><span class=o>**</span><span class=mi>128</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 314525754662942930020042292487713459951</span>
</span></span><span class=line><span class=cl>    <span class=n>tag</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>tag</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=s2>&#34;little&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=p>(</span><span class=n>ciphertext</span> <span class=o>+</span> <span class=n>tag</span> <span class=o>+</span> <span class=n>nonce</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 7aa9e2e744d1b86e76990595be835cc5a12284a1728a0e960bc5febb302abf169a37b6fcf81db1ef0ee4d59f089de8f06ea49ef8749fecb4a5a47457ad46b48a03432d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;What is your message? &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span></code></pre></div><p>Trong lúc làm bài thì mình nhập trực tiếp tới server nên được như sau:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Plaintext</span><span class=o>:</span> <span class=s1>&#39;Did you know that ChaCha20-Poly1305 is an authenticated encryption algorithm?&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>Plaintext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>44696420796</span><span class=nx>f75206b6e6f7720746861742043686143686132302d506f6c793133303520697320616e2061757468656e7469636174656420656e6372797074696f6e20616c676f726974686d3f</span>
</span></span><span class=line><span class=cl><span class=nx>Ciphertext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>7</span><span class=nx>cb5f2e754caea3d3d98048ee7d747c1b677b5ac33a000d74c86b68f7f25a955db62e0a8fd17b0235cfc0541a7f8edf105a5d1ab6a6489cfacb7e4061f5b1c8f4f04e9624220e4cb450bae1e13da93a564ed04959dbde00eb0e72b772fb4a5a47457ad46b48a03432d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Plaintext</span><span class=o>:</span> <span class=s1>&#39;That means it protects both the confidentiality and integrity of data!&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>Plaintext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>54686174206</span><span class=nx>d65616e732069742070726f746563747320626f74682074686520636f6e666964656e7469616c69747920616e6420696e74656772697479206f66206461746121</span>
</span></span><span class=line><span class=cl><span class=nx>Ciphertext</span> <span class=p>(</span><span class=nx>hex</span><span class=p>)</span><span class=o>:</span> <span class=mi>6</span><span class=nx>cb4f7b30dc8fa7c38854b90b3835fd2ad2393a7269048d411c2f3ff6421b5448b3dbbeefd00f52c46b50558bae4f1bf10a2d6ea776f998aaeabee001f0b0780000ea8774f66f3102a46013366d9ab4b0cf5b4320020b4a5a47457ad46b48a03432d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>What</span> <span class=nx>is</span> <span class=nx>your</span> <span class=nx>message</span><span class=o>?</span> <span class=mi>7</span><span class=nx>aa9e2e744d1b86e76990595be835cc5a12284a1728a0e960bc5febb302abf169a37b6fcf81db1ef0ee4d59f089de8f06ea49ef8749fecb4a5a47457ad46b48a03432d</span>
</span></span><span class=line><span class=cl><span class=nx>User</span> <span class=nx>message</span> <span class=p>(</span><span class=nx>decrypted</span><span class=p>)</span><span class=o>:</span> <span class=nx>b</span><span class=s2>&#34;But it&#39;s only secure if used correctly!&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>picoCTF</span><span class=p>{</span><span class=mi>7</span><span class=nx>urn_17_84ck_n0w_77243c82</span><span class=p>}</span>
</span></span></code></pre></div><pre><code>Flag: picoCTF{7urn_17_84ck_n0w_77243c82}
</code></pre><h3 id=guess-my-cheese-part-2><a class=header-anchor href=#guess-my-cheese-part-2></a>Guess My Cheese (Part 2)</h3><blockquote><p>Mình để bài này sau cùng vì thực sự thì nó khá là tricky và xém nữa thì mình có thể làm ra nó sớm hơn trong quá trình giải bài nhưng không được.</p></blockquote><p>Thử thách cho ta một cái <code>cheese_list.txt</code> chứa 599 loại cheese cùng với đó là server được kết nối như Part 1 chỉ khác 1 chỗ là không được mã hóa một loại cheese mà ta cho trước.</p><p>Ở đây thì hint có nhắc tới <a href=https://en.wikipedia.org/wiki/Salt_(cryptography)>Salt</a> là 2 ký tự thập lục phân và gợi ý cho ta dùng <a href=https://en.wikipedia.org/wiki/Rainbow_table>Rainbow table</a></p><p>Đầu tiên, mình cũng brute-force băm SHA256 hết các cheese cộng với việc thêm salt vào cuối $\rightarrow$ không ra. Sau đó, mình nghĩ tới việc băm trước rồi thêm salt sau đó băm tiếp $\rightarrow$ cũng không ra. Rồi mình nghĩ tới việc thêm salt vào từng ký tự xen giữa của cheese rồi băm và tất nhiên $\rightarrow$ không ra. Tiếp theo, mình nghĩ là ồ Part 1 đã cho ta chữ cái in hoa rồi thì có thể phải in hoa hết các cheese xong mới thực hiện $\rightarrow$ không ra.</p><p>Lúc đó mình cũng không nghĩ tới việc là phải ngược lại là in thường hết các cheese và nó đúng thật là như vậy&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># solution.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>sha256</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;cheese_list.txt&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;r&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cheeses</span> <span class=o>=</span> <span class=p>[</span><span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>data</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>chall</span> <span class=o>=</span> <span class=s2>&#34;9b71b2b23fa26641a0096848f97b78718975832f37ab770c60398949cd991a14&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rainbow_table</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>cheese</span> <span class=ow>in</span> <span class=n>cheeses</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>salt</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>cheese</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=o>+</span> <span class=n>salt</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>byteorder</span><span class=o>=</span><span class=s1>&#39;big&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>new_cheese_hash</span> <span class=o>=</span> <span class=n>sha256</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>rainbow_table</span><span class=p>[</span><span class=n>new_cheese_hash</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>chall</span> <span class=ow>in</span> <span class=n>rainbow_table</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>rainbow_table</span><span class=p>[</span><span class=n>chall</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># b&#39;pyramide\xa9&#39;</span>
</span></span></code></pre></div><p>Gửi cheese rồi sau đó là salt vào server thì ta nhận được flag&mldr;</p></div><footer class=article-footer><ul class=article-tag-list itemprop=keywords><li class=article-tag-list-item data-aos=zoom-in><a class=article-tag-list-link href=/tags/ctf rel=tag>CTF</a></li><li class=article-tag-list-item data-aos=zoom-in><a class=article-tag-list-link href=/tags/cryptography rel=tag>CRYPTOGRAPHY</a></li></ul></footer></div><nav id=article-nav aria-label="Article navigation" data-aos=fade-up><div class="article-nav-link-wrap right"><img data-src=/images/dicectf.png data-sizes=auto alt="DiceCTF 2025" class=lazyload><a href=/post/dicectf2025/ aria-label="Next:DiceCTF 2025" title="Next:DiceCTF 2025"></a><div class=article-nav-caption>Next</div><h3 class=article-nav-title>DiceCTF 2025</h3></div></nav></article></section></div><footer id=footer aria-label="Site footer"><div style=width:100%;overflow:hidden><div class=footer-line></div></div><div id=footer-info><div><span class=icon-copyright></span>2024-2025<span class="footer-info-sep rotate"></span>
r1muru</div><div>Powered by&nbsp;<a href=https://gohugo.io/ target=_blank rel="noopener nofollow noreferrer">Hugo</a>&nbsp; Theme.<a href=https://github.com/D-Sketon/hugo-theme-reimu target=_blank rel="noopener nofollow noreferrer">Reimu</a></div><div><span class=icon-brush>&nbsp;24.4k</span>
&nbsp;|&nbsp;
<span class=icon-coffee>&nbsp;02:00</span></div><div><span class=icon-eye></span>
<span id=busuanzi_container_site_pv>Number of visits&nbsp;<span id=busuanzi_value_site_pv></span></span>
&nbsp;|&nbsp;
<span class=icon-user></span>
<span id=busuanzi_container_site_uv>Number of visitors&nbsp;<span id=busuanzi_value_site_uv></span></span></div></div></footer><div class=sidebar-top><div class="sidebar-top-taichi rotate"></div><div class=arrow-up></div></div><div id=mask class=hide></div></div><nav id=mobile-nav aria-label="Mobile navigation"><div class=sidebar-wrap><div class=sidebar-toc-sidebar><h3 class=toc-title>Contents</h3><div class="sidebar-toc-wrapper toc-div-class"><nav id=TableOfContents><ul><li><a href=#general>General</a><ul><li><a href=#fantasy-ctf>FANTASY CTF</a></li></ul></li><li><a href=#crypto>Crypto</a><ul><li><a href=#hashcrack>hashcrack</a></li><li><a href=#even-rsa-can-be-broken>EVEN RSA CAN BE BROKEN???</a></li><li><a href=#guess-my-cheese-part-1>Guess My Cheese (Part 1)</a></li><li><a href=#chacha-slide>ChaCha Slide</a></li><li><a href=#guess-my-cheese-part-2>Guess My Cheese (Part 2)</a></li></ul></li></ul></nav></div></div><div class="sidebar-common-sidebar hidden"><div class=sidebar-author><img data-src=/avatar/avatar.png data-sizes=auto alt=r1muru class=lazyload><div class=sidebar-author-name>r1muru</div><div class=sidebar-description>Life is not fair, get used to it</div></div><div class=sidebar-state><div class=sidebar-state-article><div>Posts</div><div class=sidebar-state-number>9</div></div><a class=sidebar-state-category href=/categories/ aria-label=sidebar-state-category-link><div>Categories</div><div class=sidebar-state-number>3</div></a><a class=sidebar-state-tag href=/tags/ aria-label=sidebar-state-tag-link><div>Tags</div><div class=sidebar-state-number>7</div></a></div><div class=sidebar-social><div class="icon-discord sidebar-social-icon"><a href=https://discordapp.com/users/r1muru2006 itemprop=url target=_blank aria-label=discord rel="noopener nofollow noreferrer"></a></div><div class="icon-email sidebar-social-icon"><a href=cuongchu200@gmail.com itemprop=url target=_blank aria-label=email rel="noopener nofollow noreferrer"></a></div><div class="icon-facebook sidebar-social-icon"><a href=https://www.facebook.com/chu.cuong.732399 itemprop=url target=_blank aria-label=facebook rel="noopener nofollow noreferrer"></a></div><div class="icon-github sidebar-social-icon"><a href=https://github.com/r1muru2006 itemprop=url target=_blank aria-label=github rel="noopener nofollow noreferrer"></a></div><div class="icon-instagram sidebar-social-icon"><a href=https://www.instagram.com/r1murun0pr0 itemprop=url target=_blank aria-label=instagram rel="noopener nofollow noreferrer"></a></div></div><div class=sidebar-menu><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/ aria-label=Home></a><div class='sidebar-menu-icon icon rotate'>&#xe62b;</div><div class=sidebar-menu-link>Home</div></div><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/archives aria-label=Archives></a><div class='sidebar-menu-icon icon rotate'>&#xe62b;</div><div class=sidebar-menu-link>Archives</div></div><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/about aria-label=About></a><div class='sidebar-menu-icon icon rotate'>&#xe62b;</div><div class=sidebar-menu-link>About</div></div></div></div></div><div class=sidebar-btn-wrapper><div class="sidebar-toc-btn current"></div><div class=sidebar-common-btn></div></div></nav></div><div class=site-search><div class="reimu-popup popup"><div class=reimu-search><div class=reimu-search-input-icon></div><div id=reimu-search-input></div><div class=popup-btn-close></div></div><div class=reimu-results><div id=reimu-stats></div><div id=reimu-hits></div><div id=reimu-pagination class=reimu-pagination></div></div><img class=reimu-bg src=/images/reimu.png></div></div><script src=https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js integrity=sha384-3gT/vsepWkfz/ff7PpWNUeMzeWoH3cDhm/A8jM7ouoAK0/fP/9bcHHR5kHq2nf+e crossorigin=anonymous></script><script src=https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js integrity=sha384-J08i8An/QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q crossorigin=anonymous></script><script src=/js/main.js integrity crossorigin=anonymous></script><script src=/js/aos.js integrity crossorigin=anonymous></script><script>var aosInit=()=>{AOS.init({duration:1e3,easing:"ease",once:!0,offset:50})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",aosInit):aosInit()</script><script src=/js/pjax_main.js integrity crossorigin=anonymous data-pjax></script><script>var ALGOLIA_CONFIG={logo:"/images/algolia_logo.svg",algolia:{applicationID:"RAY96S32HW",apiKey:"53e71efc7b6ca695cdb630e780aeae50",indexName:"my-blog",hits:{per_page:parseInt("10")},labels:{input_placeholder:"Search.....",hits_empty:"No results found for 「${query}」",hits_stats:"Found ${hits} results (in ${time} ms)"}}}</script><script src=https://npm.webcache.cn/algoliasearch@4.17.1/dist/algoliasearch-lite.umd.js deferintegrity=sha384-xvLS0jfKuoREs7pqkRI/OI8GcqohO5S+jQz7ZBtQXnsXmD+9jDOOY4cL6dCPzlrk crossorigin=anonymous></script><script src=https://npm.webcache.cn/@reimujs/instantsearch.js@4.57.0-beta.1/dist/instantsearch.production.min.js deferintegrity=sha384-aagKMe8nkqaP2DYQc8kkYOL5l+M5Q2WH/Uhr4teOh0Ybp0RZj0kUSDm45qPikMjK crossorigin=anonymous></script><script src=/js/algolia_search.js integrity crossorigin=anonymous></script><script src=https://npm.webcache.cn/mouse-firework@0.1.1/dist/index.umd.js integrity=sha384-8LyaidD9GPxQQgLJO/WRw/O2h3BoNq/ApI/ecpvM6RsrCz2qP2ppBXUKihP4V/2d crossorigin=anonymous></script><script>if((!!1||!window.matchMedia("(max-width: 768px)").matches)&&window.firework){const e=JSON.parse('{"excludeelements":["a","button"],"particles":[{"colors":["var(--red-1)","var(--red-2)","var(--red-3)","var(--red-4)"],"duration":[1200,1800],"easing":"easeOutExpo","move":["emit"],"number":20,"shape":"circle","shapeOptions":{"alpha":[0.3,0.5],"radius":[16,32]}},{"colors":["var(--red-0)"],"duration":[1200,1800],"easing":"easeOutExpo","move":["diffuse"],"number":1,"shape":"circle","shapeOptions":{"alpha":[0.2,0.5],"lineWidth":6,"radius":20}}]}');e.excludeElements=e.excludeelements,delete e.excludeelements,window.firework(e)}</script><div id=lazy-script><div><script data-pjax>window.REIMU_POST={author:"r1muru",title:"picoCTF 2025",url:"https://r1muru2006.github.io/post/picoctf2025/",description:"Blog đầu nên mình sẽ lấy giải lần đầu mình chơi cùng team aespaFanClub :3",cover:"https://r1muru2006.github.io/images/picoCTF.png"}</script><script src=/js/insert_highlight.js integrity crossorigin=anonymous data-pjax></script><script src=/js/tabs.js integrity crossorigin=anonymous data-pjax></script><script type=module data-pjax>const PhotoSwipeLightbox = (await safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe-lightbox.esm.min.js", "sha384-DiL6M\/gG\u002bwmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF\/N6lrZi\/")).default;const initPswp = (gallery, children) => {
          if (_$$(`${gallery} ${children}`).length > 0) {
            new PhotoSwipeLightbox({
              gallery,
              children,pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")}).init();
          }
        }
        const pswp = () => {
          initPswp('.article-entry', 'a.article-gallery-item');
          initPswp('.article-gallery', 'a.article-gallery-item');
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script><script src=https://npm.webcache.cn/katex@0.16.24/dist/katex.min.js data-pjaxintegrity=sha384-MWNUH0WmtsYGhn2cbH6ELRCbf9LG3QDqCC+gqPB3IBNO35xjZK3Ejb6oONRpDbPg crossorigin=anonymous></script><script src=https://npm.webcache.cn/katex@0.16.24/dist/contrib/auto-render.min.js data-pjaxintegrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous></script><script data-pjax>var renderMath=()=>{if(!window.renderMathInElement)return;window.renderMathInElement(_$("article"),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",renderMath,{once:!0}):renderMath()</script></div></div><script src=https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js asyncintegrity=sha384-0M75wtSkhjIInv4coYlaJU83+OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id+S crossorigin=anonymous></script><script>"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(e=>{for(let t of e)t.unregister()})</script><script>const reimuCopyright=String.raw`
   ______     ______     __     __    __     __  __    
  /\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
  \ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
   \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
    \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                    
  `;console.log(String.raw`%c ${reimuCopyright}`,"color: #ff5252;"),console.log("%c Theme.Reimu %c https://github.com/D-Sketon/hugo-theme-reimu ","color: white; background: #ff5252; padding:5px 0;","padding:4px;border:1px solid #ff5252;")</script></body></html>